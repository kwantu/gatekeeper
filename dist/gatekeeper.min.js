(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.GK = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";function GK(){}require("./lib/config"),require("./lib/library"),require("./lib/betterdata.dao");var getResponse=function(e,o,t,n,s,d,r){var a={status:e,name:o,message:t,error:n,model:s};return a};GK.prototype.instantiate=function(e,o,t,n,s){var d=new $.Deferred;if(o==INSTANCE_TYPE_NEW_INS)dao.get(e).done(function(e){var o=getResponse(CONFLICT_CODE,CONFLICT_NAME,"Document with same id already exists",!0,null),t=[o];d.reject(t)}).fail(function(o){library.saveEntries(t,n,e,s).done(function(o){t==PROFILE_SET_ID?service.createProfileDocuments(LOCAL_SETTINGS.COMMUNITY_communityId,e):service.addToLocalRegistry({uuid:e,setId:t,applicationId:app.SCOPE.applicationId,profileId:app.SCOPE.profileId}),d.resolve(o)}).fail(function(e){var o=getResponse(e.status,e.name,e.message,!0,e),t=[o];d.reject(t)})});else if(o==INSTANCE_TYPE_NEW_SEQ)dao.get(e).done(function(o){if(o.model.pending.status==ENTRY_STATUS_AUTHORISED||o.model.pending.status==ENTRY_STATUS_REJECTED){var t=function(e){console.log("newSeq=="+e),o.model.pending.seq=e,o.model.pending.data={},o.model.pending.status=ENTRY_STATUS_INITIALISED,o.model.pending.validDate=s,o.model.pending.revision="";var t={name:LOCAL_SETTINGS.SESSION.firstName+" "+LOCAL_SETTINGS.SESSION.lastName,userId:LOCAL_SETTINGS.SUBSCRIPTIONS.userId,username:LOCAL_SETTINGS.SUBSCRIPTIONS.username};o.model.pending.user=t},n=e+":approved";dao.get(n).done(function(e){var n=JSON.xpath("max(//approved/seq)",ko.toJS(e),{})[0],s=n+1;t(s);var r=getResponse(CREATED_CODE,CREATED_NAME,"Sequence created",!1,o),a=[r];d.resolve(a)}).fail(function(e){var o=getResponse(e.status,e.name,"Approved doc not found to create a new sequence",!0,null),t=[o];d.reject(t)})}else{var r=getResponse(SERVER_ERROR_CODE,SERVER_ERROR_NAME,"Cannot create sequence. Current status should be "+ENTRY_STATUS_AUTHORISED+" or "+ENTRY_STATUS_REJECTED,!0,null),a=[r];d.reject(a)}}).fail(function(o){library.saveEntries(t,n,e,s).done(function(e){d.resolve(e)}).fail(function(e){var o=getResponse(e.status,e.name,e.message,!0,null),t=[o];d.reject(t)})});else{var r=getResponse(SERVER_ERROR_CODE,SERVER_ERROR_NAME,"Instance parameter not passed",!0,null),a=[r];d.reject(a)}return d},GK.prototype.instantiateData=function(documentId,instantiateFrom,indicatorModel,seqNo){var self=this,def=new $.Deferred,getResponse=function(e,o,t,n,s){var d={status:e,name:o,message:t,error:n,model:s};return d};return dao.get(documentId).done(function(data){if(data.model.pending.status==ENTRY_STATUS_INITIALISED)if(data.model.pending.seq==seqNo)instantiateFrom==FROM_REQUEST?dao.get(documentId).done(function(data){data.model.pending.data[indicatorModel.defaultModel.setId()]=JSON.parse(ko.toJSON(eval("indicatorModel.customModel."+indicatorModel.defaultModel.setId()),function(e,o){return"__ko_mapping__"===e?void 0:void 0==o?"":o})),data.model.pending.status=ENTRY_STATUS_DATA_INITIALISED;var response=getResponse(UPDATED_CODE,UPDATED_NAME,"Document initialised.",!1,data),responseArray=[response];def.resolve(responseArray)}).fail(function(e){var o=getResponse(e.status,e.name,"Cannot find document "+documentId,!0,null),t=[o];def.reject(t)}):instantiateFrom==FROM_DEFINITION?dao.get(documentId).done(function(data){var setId=indicatorModel.defaultModel.setId(),version=JSON.xpath("/indicators[setId eq '"+setId+"']/version",app.SCOPE.APP_CONFIG,{}),setModelId=setId+"_"+version+"_ENTRY";dao.get(setModelId).done(function(setModel){var definitionModel=eval("setModel.model.pending.data."+setId);data.model.pending.data[setId]=definitionModel,data.model.pending.status=ENTRY_STATUS_DATA_INITIALISED;var response=getResponse(UPDATED_CODE,UPDATED_NAME,"Document initialised.",!1,data),responseArray=[response];def.resolve(responseArray)}).fail(function(e){var o=getResponse(e.status,e.name,"Cannot find default model "+setModelId,!0,null),t=[o];def.reject(t)})}).fail(function(e){var o=getResponse(e.status,e.name,"Cannot find document "+documentId,!0,null),t=[o];def.reject(t)}):instantiateFrom==FROM_AUTHORISED&&dao.get(documentId).done(function(data){var setId=indicatorModel.defaultModel.setId(),version=JSON.xpath("/indicators[setId eq '"+setId+"']/version",app.SCOPE.APP_CONFIG,{}),approvedModelId=documentId+":approved";dao.get(approvedModelId).done(function(approvedModel){var max_seq=JSON.xpath("max(/model/approved/seq)",approvedModel,{})[0],lastApprovedModel=JSON.xpath("/model/approved[./seq = "+max_seq+"]",approvedModel,{})[0],newModel=eval("lastApprovedModel.data."+setId);data.model.pending.data[setId]=newModel,data.model.pending.status=ENTRY_STATUS_DATA_INITIALISED;var response=getResponse(UPDATED_CODE,UPDATED_NAME,"Document initialised.",!1,data),responseArray=[response];def.resolve(responseArray)}).fail(function(e){var o=getResponse(e.status,e.name,"Cannot find approved model "+approvedModelId,!0,null),t=[o];def.reject(t)})}).fail(function(e){var o=getResponse(e.status,e.name,"Cannot find document "+documentId,!0,null),t=[o];def.reject(t)});else{var response=getResponse(SERVER_ERROR_CODE,SERVER_ERROR_NAME,"Input sequence should be equal to pending sequence.",!0,null),responseArray=[response];def.reject(responseArray)}else{var response=getResponse(SERVER_ERROR_CODE,SERVER_ERROR_NAME,"Status is not in "+ENTRY_STATUS_INITIALISED+" state.",!0,null),responseArray=[response];def.reject(responseArray)}}).fail(function(e){var o=getResponse(e.status,e.name,e.message,!0,null),t=[o];def.reject(t)}),def},GK.prototype.update=function(documentId,indicatorModel){var self=this,def=new $.Deferred,processAllRules=function(index,object,indicatorModel,configDoc,ruleResponse,def_processRules){var ruleObj=configDoc.rules[index],executeAt=ruleObj.executeAt,id=ruleObj.id,seq=ruleObj.seq,type=ruleObj.executeRule.ruleType;if("local"==executeAt)switch(type){case"update":for(var source=ruleObj.executeRule.params.source,str="",ol=0;ol<ruleObj.executeRule.params.target.length;ol++){var targetItem=ruleObj.executeRule.params.target[ol],targetType=targetItem.type,targetName=targetItem.name;str="variable"==targetType?str+eval("indicatorModel.customModel."+indicatorModel.defaultModel.setId()+"."+targetName+"()")+" ":str+targetName+" "}"doc:"==source.substring(0,4)?eval("object."+source.substring(source.length,4)+"= str;"):eval("object.model.pending.data."+indicatorModel.defaultModel.setId()+"."+source+"= str;"),ruleResponse.ruleStatus="RULE_COMPLETE",index==configDoc.rules.length-1?def_processRules.resolve(ruleResponse):processAllRules(index+1,object,indicatorModel,configDoc,ruleResponse,def_processRules);break;case"initialise":break;case"unique":}else object.model.pending.processingStatus.seq=seq,object.model.pending.processingStatus.ruleStatus=PROCESSING_STATUS_SERVER_RULES,ruleResponse.ruleStatus="RULE_SERVER",def_processRules.resolve(ruleResponse);return def_processRules};return dao.get(documentId).done(function(doc){if(indicatorModel.modelErrors().length>0){var response=getResponse(PRECONDITION_FAILED_CODE,PRECONDITION_FAILED_NAME,"There are "+indicatorModel.modelErrors().length+" errors on form. Please resolve first.",!0,null),responseArray=[response];def.reject(responseArray)}else if(doc.model.pending.status==ENTRY_STATUS_DATA_INITIALISED||doc.model.pending.status==ENTRY_STATUS_UPDATED){var model=JSON.parse(ko.toJSON(eval("indicatorModel.customModel."+indicatorModel.defaultModel.setId()),function(e,o){return"__ko_mapping__"===e?void 0:void 0==o?"":o})),version="";version=indicatorModel.customModel.setId()==PROFILE_SET_ID?"V1.0":JSON.xpath("/indicators[setId eq '"+indicatorModel.customModel.setId()+"']/version",app.SCOPE.APP_CONFIG,{}),dao.get(indicatorModel.customModel.setId()+"_"+version+"_config").done(function(e){if(doc.model.pending.data[indicatorModel.customModel.setId()]=model,void 0!=e.moderation&&1==e.moderation.required&&(doc.control.draft=!0),doc.updated=moment().format(),doc.contributors.push({name:LOCAL_SETTINGS.SESSION.firstName+" "+LOCAL_SETTINGS.SESSION.lastName,userId:LOCAL_SETTINGS.SUBSCRIPTIONS.userId,username:LOCAL_SETTINGS.SUBSCRIPTIONS.username}),doc.model.pending.user={name:LOCAL_SETTINGS.SESSION.firstName+" "+LOCAL_SETTINGS.SESSION.lastName,userId:LOCAL_SETTINGS.SUBSCRIPTIONS.userId,username:LOCAL_SETTINGS.SUBSCRIPTIONS.username},doc.source="remote",void 0!=e.rules&&e.rules.length>0){doc.model.pending.status=ENTRY_STATUS_PENDING_RULES;var o=new $.Deferred;processAllRules(0,doc,indicatorModel,e,{ruleStatus:""},o).done(function(e){if("RULE_COMPLETE"==e.ruleStatus){if(doc.model.pending.processingStatus.seq="",doc.model.pending.processingStatus.ruleStatus="",doc.model.pending.status=ENTRY_STATUS_UPDATED,void 0!=app.processId){var o=JSON.xpath("/processes[subProcessId eq '"+app.processId+"']",doc,{});o.length>0&&(o[0].status=ENTRY_STATUS_READY_TO_SUBMIT)}indicatorModel.defaultModel.atomId(documentId);var t=getResponse(UPDATED_CODE,UPDATED_NAME,"Document updated",!1,doc),n=[t];def.resolve(n)}else if("RULE_SERVER"==e.ruleStatus){console.log("dependent onserver rule");var t=getResponse(UPDATED_CODE,UPDATED_NAME,"dependent onserver rule",!1,doc),n=[t];def.resolve(n)}else"RULE_ERROR"==e.ruleStatus&&console.log("rule error from somewhere")}).fail(function(e){def.reject("processAllRules fail promise case failed")})}else{doc.model.pending.status=ENTRY_STATUS_UPDATED,indicatorModel.defaultModel.atomId(documentId);var t=getResponse(UPDATED_CODE,UPDATED_NAME,"Document updated",!1,doc),n=[t];def.resolve(n)}}).fail(function(e){var o=getResponse(e.status,e.name,"config file not found.",!0,null),t=[o];def.reject(t)})}else{var response=getResponse(SERVER_ERROR_CODE,SERVER_ERROR_NAME,"Status is not in "+ENTRY_STATUS_DATA_INITIALISED+" or "+ENTRY_STATUS_UPDATED+" state.",!0,null),responseArray=[response];def.reject(responseArray)}}).fail(function(e){var o=getResponse(e.status,e.name,e.message,!0,null),t=[o];def.reject(t)}),def},GK.prototype.authorise=function(documentId){var self=this,def=new $.Deferred;if(null!=documentId&&void 0!=documentId&&""!=documentId)dao.get(documentId).done(function(data){if(data.model.pending.status==ENTRY_STATUS_UPDATED){var setId=data.category.term,path=data.model.pending,item=eval(path);data.model.pending.status=ENTRY_STATUS_AUTHORISED;var approve_doc_id=documentId+":approved";dao.get(approve_doc_id).done(function(e){e.model.approved.push(item);var o=getResponse(UPDATED_CODE,UPDATED_NAME,"Document Model approved",!1,data),t=getResponse(UPDATED_CODE,UPDATED_NAME,"Approved model incremented",!1,e),n=[o,t];def.resolve(n)}).fail(function(e){console.log(e)})}else{var response=getResponse(BAD_REQUEST_CODE,BAD_REQUEST_NAME,"Status not in updated state",!0,null),responseArray=[response];def.reject(responseArray)}}).fail(function(e){var o=getResponse(e.status,e.name,e.message,!0,null),t=[o];def.reject(t)});else{var response=getResponse(BAD_REQUEST_CODE,BAD_REQUEST_NAME,"Document ID is blank",!0,null),responseArray=[response];def.reject(responseArray)}return def},GK.prototype.reject=function(documentId){var self=this,def=new $.Deferred;if(null!=documentId&&void 0!=documentId&&""!=documentId)dao.get(documentId).done(function(data){if(data.model.pending.status==ENTRY_STATUS_UPDATED){var setId=data.category.term,item=eval("data.model.pending.data"+setId);data.model.pending.status=ENTRY_STATUS_REJECTED;var rejected_doc_id=documentId+":rejected";dao.get(rejected_doc_id).done(function(e){e.model.rejected.push(item);var o=getResponse(UPDATED_CODE,UPDATED_NAME,"Document Model approved",!1,data),t=getResponse(UPDATED_CODE,UPDATED_NAME,"Rejetced model incremented",!1,e),n=[o,t];def.resolve(n)}).fail(function(e){console.log(e)})}else{var response=getResponse(BAD_REQUEST_CODE,BAD_REQUEST_NAME,"Status not in updated state",!0,null),responseArray=[response];def.reject(responseArray)}}).fail(function(e){var o=getResponse(e.status,e.name,e.message,!0,null),t=[o];def.reject(t)});else{var response=getResponse(BAD_REQUEST_CODE,BAD_REQUEST_NAME,"Document ID is blank",!0,null),responseArray=[response];def.reject(responseArray)}return def};var processInitialiseRule=function(e,o,t){},processUniqueRule=function(e,o,t){};GK.prototype.unlock=function(e){return new Promise(function(e,o){})},GK.prototype.persist=function(e){for(var o=new $.Deferred,t=0;t<e.length;t++)dao.save(e[t].model).done(function(e){console.log(e),o.resolve(e)}).fail(function(e){console.log(e),o.reject(e)})},module.exports=GK;

},{"./lib/betterdata.dao":2,"./lib/config":3,"./lib/library":4}],2:[function(require,module,exports){
var globalurl="",masterDB,localDB,taxonomyDB,authenticatedToSyncGateway=!1,dao=function(){return{authenticateToSyncGateway:function(e,t){var n=new $.Deferred,o="http://"+COUCHBASE_SERVER+"/"+TAXONOMY_BUCKET+"/_session",r="POST",a=JSON.stringify({name:e,password:t}),c=!0,i=new XMLHttpRequest;i.withCredentials=!0,i.onload=function(){i.status,i.responseText},i.open(r,o,c),i.setRequestHeader("Content-Type","application/json;charset=UTF-8"),i.send(a);var o="http://"+COUCHBASE_SERVER+"/"+COUCHBASE_BUCKET+"/_session",r="POST",a=JSON.stringify({name:e,password:t}),c=!0,i=new XMLHttpRequest;return i.withCredentials=!0,i.onload=function(){var e=i.status,t=i.responseText;200==e?(authenticatedToSyncGateway=!0,n.resolve(t)):n.reject(t)},i.open(r,o,c),i.setRequestHeader("Content-Type","application/json;charset=UTF-8"),i.send(a),n.promise()},get:function(e){var t=new $.Deferred;try{head.mobile&&isCordovaApp?cordova.exec(function(e){t.resolve(e)},function(e){t.reject(e)},"CBLite","getDocument",[{dbname:DBNAME+DB_IDENTIFIER,docId:e}]):localDB.get(e).then(function(e){t.resolve(e)}).catch(function(n){return console.log("Desktop - error in getting document with id: "+e+". Error stacktrace: "+n),t.reject(n),n})}catch(e){t.reject(e)}return t.promise()},getTaxonomy:function(e){var t=new $.Deferred;return head.mobile&&isCordovaApp?cordova.exec(function(e){t.resolve(e)},function(e){t.reject(e)},"CBLite","getDocument",[{dbname:TAXONOMY_DBNAME+DB_IDENTIFIER,docId:e}]):taxonomyDB.get(e).then(function(e){t.resolve(e)}).catch(function(n){return console.log("Desktop - error in getting taxonomy with id: "+e+". Error stacktrace: "+n),t.reject(n),n}),t.promise()},save:function(e){var t=new $.Deferred;if(head.mobile&&isCordovaApp)if(0!=e._id.indexOf("_design"))cordova.exec(function(e){t.resolve(e)},function(e){t.reject(e)},"CBLite","saveDocument",[{dbname:DBNAME+DB_IDENTIFIER,docId:e._id,doc:e}]);else{var n={url:globalurl+DBNAME+DB_IDENTIFIER+"/"+e._id,type:"PUT",data:JSON.stringify(e),dataType:"json",contentType:"application/json"};$.ajax(n).done(function(e,n,o){t.resolve(e)}).fail(function(n,o,r){console.log("Mobile - error in saving document with id: "+e._id+". URL: "+globalurl+DBNAME+DB_IDENTIFIER+" Error stacktrace: "+JSON.stringify(n)),t.reject(n.responseText)})}else localDB.put(e).then(function(e){t.resolve(e)}).catch(function(n){console.log("Desktop - error in saving document with id: "+e._id+". Error stacktrace: "+n),t.reject(n)});return t.promise()},saveAttachment:function(e,t,n,o,r){var a=new $.Deferred;return head.mobile&&isCordovaApp?blobUtil.base64StringToBlob(n,o).then(function(n){var o=new XMLHttpRequest;o.open("PUT",globalurl+DBNAME+DB_IDENTIFIER+"/"+e+"/"+r+"?rev="+t,!0),o.onload=function(e){a.resolve(JSON.parse(o.responseText))},o.send(n)}).catch(function(e){console.log(e),a.reject(xhr.responseText)}):localDB.putAttachment(e,r,t,n,o).then(function(e){a.resolve(e)}).catch(function(t){console.log("Desktop -error in saving attachment to the document with id: "+e+". Error stacktrace: "+t),a.reject(t)}),a.promise()},getAttachment:function(e,t,n){var o=new $.Deferred;if(head.mobile&&isCordovaApp){var r=new XMLHttpRequest;r.open("GET",globalurl+DBNAME+DB_IDENTIFIER+"/"+e+"/"+n,!0),r.responseType="blob",r.onload=function(t){if(200==this.status){var n=r.response;blobUtil.blobToBase64String(n).then(function(e){o.resolve(e)}).catch(function(t){console.log("Mobile - error in getting attachment to the document with id: "+e+". Error stacktrace: "+t),o.reject(r)})}else console.log("Mobile - error in getting attachment to the document with id: "+e),o.reject(r)},r.send()}else localDB.getAttachment(e,n).then(function(e){blobUtil.blobToBase64String(e).then(function(e){o.resolve(e)}).catch(function(e){o.reject(e)})}).catch(function(t){console.log("Desktop -error in getting attachment to the document with id: "+e+". Error stacktrace: "+t),o.reject(t)});return o.promise()},deleteAttachment:function(e,t,n){var o=new $.Deferred;if(head.mobile&&isCordovaApp){var r={url:globalurl+DBNAME+DB_IDENTIFIER+"/"+e+"/"+n+"?rev="+t,type:"DELETE",dataType:"json"};$.ajax(r).done(function(e,t,n){o.resolve(e)}).fail(function(t,n,r){console.log("Mobile - error in deleting attachment to the document with id: "+e+". Error stacktrace: "+JSON.stringify(t)),o.reject(t.responseText)})}else localDB.removeAttachment(e,n,t).then(function(e){o.resolve(e)}).catch(function(t){console.log("Desktop - error in deleting attachment to the document with id: "+e+". Error stacktrace: "+JSON.stringify(xhr)),o.reject(t)});return o.promise()},upsert:function(e){var t=new $.Deferred,n=function(n){e._rev=n._rev,dao.save(e).done(function(e){t.resolve(e)}).fail(function(e){t.reject(e)})},o=function(n){dao.save(e).done(function(e){console.log(e),t.resolve(e)}).fail(function(e){t.reject(e)})};return dao.get(e._id).done(n).fail(o),t.promise()},startPull:function(){var e=new $.Deferred,t=LOCAL_SETTINGS.SUBSCRIPTIONS.syncUsername,n=LOCAL_SETTINGS.SUBSCRIPTIONS.syncPassword;return head.mobile&&isCordovaApp?cordova.exec(function(t){SYNC_SEQ=t,e.resolve(t)},function(t){e.reject(t)},"CBLite","pull",[{dbname:DBNAME+DB_IDENTIFIER,url:"http://"+t+":"+n+"@"+COUCHBASE_SERVER+"/"+COUCHBASE_BUCKET}]):0==authenticatedToSyncGateway?dao.authenticateToSyncGateway(t,n).done(function(t){localDB.replicate.from(new PouchDB("http://"+COUCHBASE_SERVER+"/"+COUCHBASE_BUCKET,{ajax:{timeout:6e4}}),{live:!1,retry:!0,timeout:6e4}).then(function(t){e.resolve("")}).catch(function(t){e.reject(t)})}).fail(function(t){e.reject(t)}):localDB.replicate.from(new PouchDB("http://"+COUCHBASE_SERVER+"/"+COUCHBASE_BUCKET,{ajax:{timeout:6e4}}),{live:!1,retry:!0,timeout:6e4}).then(function(t){e.resolve("")}).catch(function(t){e.reject(t)}),e.promise()},pullTaxonomies:function(){var e=new $.Deferred,t=LOCAL_SETTINGS.SUBSCRIPTIONS.syncUsername,n=LOCAL_SETTINGS.SUBSCRIPTIONS.syncPassword;return head.mobile&&isCordovaApp?cordova.exec(function(t){e.resolve(t)},function(t){e.reject(t)},"CBLite","pull",[{dbname:TAXONOMY_DBNAME+DB_IDENTIFIER,url:"http://"+t+":"+n+"@"+COUCHBASE_SERVER+"/"+TAXONOMY_BUCKET}]):0==authenticatedToSyncGateway?dao.authenticateToSyncGateway(t,n).done(function(t){taxonomyDB.replicate.from(new PouchDB("http://"+COUCHBASE_SERVER+"/"+TAXONOMY_BUCKET,{ajax:{timeout:6e4}}),{live:!1,retry:!0,timeout:6e4}).then(function(t){e.resolve("")}).catch(function(t){e.reject(t)})}).fail(function(t){e.reject(t)}):taxonomyDB.replicate.from(new PouchDB("http://"+COUCHBASE_SERVER+"/"+TAXONOMY_BUCKET,{ajax:{timeout:6e4}}),{live:!1,retry:!0,timeout:6e4}).then(function(t){e.resolve("")}).catch(function(t){e.reject(t)}),e.promise()},startSync:function(){var e=new $.Deferred;return dao.get("_local/LOCAL_SETTINGS").then(function(t){var n=LOCAL_SETTINGS.SUBSCRIPTIONS.syncUsername,o=LOCAL_SETTINGS.SUBSCRIPTIONS.syncPassword;head.mobile&&isCordovaApp?cordova.exec(function(t){SYNC_SEQ=t,e.resolve(t)},function(t){e.reject(t)},"CBLite","sync",[{dbname:DBNAME+DB_IDENTIFIER,url:"http://"+n+":"+o+"@"+COUCHBASE_SERVER+"/"+COUCHBASE_BUCKET}]):0==authenticatedToSyncGateway?dao.authenticateToSyncGateway(n,o).done(function(t){localDB.sync(new PouchDB("http://"+COUCHBASE_SERVER+"/"+COUCHBASE_BUCKET,{ajax:{timeout:6e4}}),{live:!0,retry:!0,timeout:6e4}).on("change",function(n){SYNC_SEQ=""+n.change.last_seq,e.resolve(t)}).on("active",function(){}).on("complete",function(e){}).on("error",function(t){e.reject(t)})}).fail(function(t){e.reject(t)}):localDB.sync(new PouchDB("http://"+COUCHBASE_SERVER+"/"+COUCHBASE_BUCKET,{ajax:{timeout:6e4}}),{live:!0,retry:!0,timeout:6e4}).on("change",function(n){SYNC_SEQ=""+n.change.last_seq,e.resolve(t)}).on("active",function(){}).on("complete",function(e){}).on("error",function(t){e.reject(t)})}).fail(function(t){e.reject(t)}),e.promise()},startSyncTaxonomies:function(){return dao.pullTaxonomies()},changes:function(){var e=new $.Deferred;return head.mobile&&isCordovaApp?$.ajax({url:globalurl+DBNAME+DB_IDENTIFIER+"/_changes?since="+LOCAL_SETTINGS.SYNC_SEQ,type:"GET",dataType:"json",success:function(t,n,o){e.resolve(t)},error:function(t,n,o){console.log("Error = "+JSON.stringify(t)),e.reject(t.responseText)}}):localDB.changes({since:parseInt(LOCAL_SETTINGS.SYNC_SEQ)}).then(function(t){e.resolve(t)}).catch(function(t){e.reject(t)}),e.promise()},createDatabase:function(){var e=new $.Deferred;return head.mobile&&isCordovaApp?window.cblite?window.cblite.getURL(function(t,n){if(t)alert("error launching Couchbase Lite: "+t);else{globalurl=n;try{var o=new XMLHttpRequest;o.open("GET",globalurl,!1),o.send(null)}catch(e){}$.ajax({url:globalurl+DBNAME+"master",type:"PUT",data:"",dataType:"json",contentType:"application/json",success:function(t,n,o){201==o.status||412==o.status?dao.getIdentifier().done(function(t){DB_IDENTIFIER=t,dao.createDatabaseImpl(e)}).fail(function(t){DB_IDENTIFIER=generateUUID().substring(0,8),dao.saveIdentifier().done(function(t){dao.createDatabaseImpl(e)})}):e.reject(o.responseText)},error:function(t,n,o){201==t.status||412==t.status?dao.getIdentifier().done(function(t){DB_IDENTIFIER=t,dao.createDatabaseImpl(e)}).fail(function(t){DB_IDENTIFIER=generateUUID().substring(0,8),dao.saveIdentifier().done(function(t){dao.createDatabaseImpl(e)})}):e.reject(t.responseText)}})}}):alert("error, Couchbase Lite plugin not found."):new PouchDB(DBNAME+"master").then(function(t){masterDB=t,dao.getIdentifier().done(function(t){DB_IDENTIFIER=t,dao.createDatabaseImpl(e)}).fail(function(t){DB_IDENTIFIER=generateUUID().substring(0,8),dao.saveIdentifier().done(function(t){dao.createDatabaseImpl(e)})})}),e.promise()},createDatabaseImpl:function(e){head.mobile&&isCordovaApp?($.ajax({url:globalurl+TAXONOMY_DBNAME+DB_IDENTIFIER,type:"PUT",data:"",dataType:"json",contentType:"application/json",success:function(e,t,n){},error:function(e,t,n){}}),$.ajax({url:globalurl+DBNAME+DB_IDENTIFIER,type:"PUT",data:"",dataType:"json",contentType:"application/json",success:function(t,n,o){201==o.status||412==o.status?e.resolve(t):e.reject(o.responseText)},error:function(t,n,o){201==t.status||412==t.status?e.resolve(t.responseText):e.reject(t.responseText)}})):new PouchDB(TAXONOMY_DBNAME+DB_IDENTIFIER).then(function(t){taxonomyDB=t,new PouchDB(DBNAME+DB_IDENTIFIER).then(function(t){localDB=t,e.resolve("Database created")})})},deleteDocument:function(e){var t=new $.Deferred;if(head.mobile&&isCordovaApp){var n=function(e){$.ajax({url:globalurl+DBNAME+DB_IDENTIFIER+"/"+e._id+"?rev="+e._rev,type:"DELETE",data:JSON.stringify(e),dataType:"json",contentType:"application/json",success:function(e,n,o){t.resolve(e)},error:function(e,n,o){t.reject(e.responseText)}})};dao.get(e).done(n).fail(function(e){t.reject(e)})}else localDB.get(e).then(function(e){return localDB.remove(e)}).then(function(e){t.resolve(e)}).catch(function(e){t.reject(e)});return t.promise()},resetDatabase:function(){var e=new $.Deferred,t=DB_IDENTIFIER;return DB_IDENTIFIER=generateUUID().substring(0,8),dao.saveIdentifier().done(function(n){head.mobile&&isCordovaApp?$.ajax({url:globalurl+TAXONOMY_DBNAME+t,type:"DELETE",success:function(n,o,r){$.ajax({url:globalurl+DBNAME+t,type:"DELETE",success:function(t,n,o){dao.createDatabase().done(new function(n){e.resolve(t)}).fail(function(t){e.resolve(t)})},error:function(t,n,o){e.resolve(t.responseText)}})},error:function(t,n,o){e.resolve(t.responseText)}}):taxonomyDB.destroy().then(function(t){localDB.destroy().then(function(t){dao.createDatabase().done(new function(t){e.resolve(t)}).fail(function(t){e.reject(t)})}).catch(function(t){e.reject(t)})}).catch(function(t){e.reject(t)})}),e.promise()},createDocView:function(e,t){var n=new $.Deferred;return t._id="_design/"+e,dao.upsert(t).done(function(e){n.resolve(e)}).fail(function(e){n.reject(e)}),n.promise()},getIdentifier:function(){var e=new $.Deferred;try{if(head.mobile&&isCordovaApp){var t={url:globalurl+DBNAME+"master/_local/SETTINGS",type:"GET",dataType:"json"};$.ajax(t).done(function(t,n,o){e.resolve(t.DB_IDENTIFIER)}).fail(function(t,n,o){e.reject(t)})}else masterDB.get("_local/SETTINGS").then(function(t){e.resolve(t.DB_IDENTIFIER)}).catch(function(t){return e.reject(t),t})}catch(t){e.reject(t)}return e.promise()},saveIdentifier:function(){var e={DB_IDENTIFIER:DB_IDENTIFIER,_id:"_local/SETTINGS"},t=new $.Deferred,n=function(e){if(head.mobile&&isCordovaApp){var n={url:globalurl+DBNAME+"master/_local/SETTINGS",type:"PUT",data:JSON.stringify(e),dataType:"json",contentType:"application/json"};$.ajax(n).done(function(e,n,o){t.resolve(e)}).fail(function(e,n,o){t.reject(e.responseText)})}else masterDB.put(e).then(function(e){t.resolve(e)}).catch(function(e){t.reject(e)})},o=function(t){e._rev=t._rev,n(e)},r=function(t){n(e)};if(head.mobile&&isCordovaApp){var a={url:globalurl+DBNAME+"master/_local/SETTINGS",type:"GET",dataType:"json"};$.ajax(a).done(o).fail(r)}else masterDB.get("_local/SETTINGS").then(o).catch(r);return t.promise()},getDocView:function(e,t,n){var o=new $.Deferred;try{var r=!1;if(void 0!=n&&void 0!=n.descending&&(r=n.descending),head.mobile&&isCordovaApp){var a="?include_docs=true&key="+n.key+"&limit="+n.pageSizeVal+"&size="+n.pageIndexVal*n.pageSizeVal+"&descending="+r;$.ajax({url:globalurl+DBNAME+DB_IDENTIFIER+"/_design/"+e+"/_view/"+t+a,type:"GET",dataType:"json",success:function(e,t,n){o.resolve(e)},error:function(e,t,n){console.log("error occured while getting doc view "+JSON.stringify(e)),o.reject(e.responseText)}})}else localDB.query(e+"/"+t,{include_docs:!0,key:n.key,limit:n.pageSizeVal,skip:n.pageIndexVal*n.pageSizeVal,descending:r}).then(function(e){o.resolve(e)}).catch(function(e){console.log(e),o.reject(e)})}catch(e){o.reject(e)}return o.promise()},search:function(e,t){var n=new $.Deferred,o="view_searchData",r=generateUUID(),a={language:"javascript",views:{view_searchData:{map:"function(doc) {var searchableCategories = JSON.parse('"+JSON.stringify(e)+"');if(typeof (doc.title) != 'undefined' && typeof (doc.category) != 'undefined' && typeof (doc.category.term) != 'undefined'){if(searchableCategories.indexOf(doc.category.term) > -1){var docTitle = doc.title.toLowerCase();if( (doc.category.term == 'participant' && doc._id.toLowerCase().indexOf('"+t.toLowerCase()+"') > -1) || docTitle.indexOf('"+t.toLowerCase()+"') > -1) {  var jsonObj = {}; jsonObj.isProfile = doc.category.term == '"+PROFILE_SET_ID+"'; emit(doc.title.toUpperCase(),  jsonObj ); }}}}"}}},c=function(e){setTimeout(function(){var e={pageSizeVal:50,pageIndexVal:0,include_docs:!0};dao.getDocView(r,o,e).done(function(e){n.resolve(e)}).fail(function(e){n.reject(e)})},1e3)};return dao.createDocView(r,a).done(c).fail(function(e){n.reject(e)}),n.promise()},profileData:function(e,t){var n=new $.Deferred,o="view_searchData",r="Search"+e+t,a={pageSizeVal:500,pageIndexVal:0,include_docs:!0};return dao.getDocView(r,o,a).done(function(e){n.resolve(e)}).fail(function(a){var c={language:"javascript",views:{view_searchData:{map:"function(doc) {if(typeof (doc.title) != 'undefined' && typeof (doc.category) != 'undefined' && typeof (doc.category.term) != 'undefined'){if( doc.category.term == '"+e+"' && doc.channels.indexOf('"+t+'\') > -1) {  var jsonObj = {"doc": {  "updated": doc.updated, "_id": doc._id, "title": doc.title, "category": { "term": doc.category.term } }}; emit(doc.title.toUpperCase(),  jsonObj ); }}}'}}},i=function(e){setTimeout(function(){var e={pageSizeVal:500,pageIndexVal:0,include_docs:!0};dao.getDocView(r,o,e).done(function(e){n.resolve(e)}).fail(function(e){n.reject(e)})},2e3)};dao.createDocView(r,c).done(i).fail(function(e){n.reject(e)})}),n}}}();

},{}],3:[function(require,module,exports){
var COUCHBASE_SERVER="kwantu10.kwantu.net:8000",COUCHBASE_BUCKET="kwantu_apps",TAXONOMY_BUCKET="kwantu_taxonomies",SYNC_SEQ="0",DBNAME="kwantu_apps",TAXONOMY_DBNAME="kwantu_taxonomies",DB_IDENTIFIER="",DOMAIN="http://kwantu9data.kwantu.net:8080",USER_AUTH=DOMAIN+"/exist/rest/db/kwantu-resource/api/authenticate1.8.xq",BIOMETRIC_SERVICE=DOMAIN+"/exist/rest/db/kwantu-resource/api/biometric/biometric.xql",ONLINE_VALIDATION_URL=DOMAIN+"/exist/rest/db/kwantu-resource/mobileServices/validateRule.xql",PROFILE_SET_ID="appProfile",INSTANCE_TYPE_NEW_INS="newInstance",INSTANCE_TYPE_NEW_SEQ="newSequence",CONFLICT_CODE=409,CONFLICT_NAME="Document Conflict",CREATED_CODE=210,CREATED_NAME="Document Created",UPDATED_CODE=200,UPDATED_NAME="Document Updated",SERVER_ERROR_CODE=500,SERVER_ERROR_NAME="Server Error",BAD_REQUEST_CODE=400,BAD_REQUEST_NAME="Bad Request",PRECONDITION_FAILED_CODE=412,PRECONDITION_FAILED_NAME="PreConditions Failed.",FROM_REQUEST="fromRequest",FROM_DEFINITION="fromDefinition",FROM_AUTHORISED="fromAuthorised",LOCAL_SETTINGS={_id:"_local/LOCAL_SETTINGS",SYNC_SEQ:"0",SESSION:{},SUBSCRIPTIONS:{},LANG:"en"},COMMUNITY_CONFIG={},PROCESS_STATUS_NOT_STARTED="NotStarted",PROCESS_STATUS_NOT_CREATED="Created",PROCESS_STATUS_IN_PROGRESS="InProgress",PROCESS_STATUS_IN_AWAITING="awaitingAuthorisation",PROCESS_STATUS_COMPLETE="Complete",PROCESS_INITIATE_USER="user",ENTRY_STATUS_NOT_STARTED="NotStarted",ENTRY_STATUS_IN_PROGRESS="InProgress",ENTRY_STATUS_READY_TO_SUBMIT="Ready To Submit",ENTRY_STATUS_COMPLETE="Complete",ENTRY_STATUS_SUBMITTED="Submitted",ENTRY_STATUS_INITIALISED="Instantiated",ENTRY_STATUS_DATA_INITIALISED="DataInitialised",ENTRY_STATUS_PENDING="Pending",ENTRY_STATUS_PENDING_RULES="PendingRules",ENTRY_STATUS_UPDATED="Updated",ENTRY_STATUS_AUTHORISED="Authorised",ENTRY_STATUS_REJECTED="Rejected",PROCESSING_STATUS_SERVER_RULES="ProcessingServerRules",appConfig={content:{data:{community:{design_docs:[{docId:"category",view:{language:"javascript",views:{notificationCount:{map:"function(doc) { if(typeof (doc.type) != 'undefined'){if(doc.type=='notification' && doc.read == false){ emit(doc.createdDateTime,  {} ); }}}"},notification:{map:"function(doc) { if(typeof (doc.type) != 'undefined'){if(doc.type=='notification'){ emit((!doc.read).toString() + doc.createdDateTime,  doc ); }}}"}}}}]}}}};

},{}],4:[function(require,module,exports){
"use strict";var library=function(){return{entryWrapper:function(setId,profileId,documentId,validDate){var dfd=new $.Deferred,version=JSON.xpath("/indicators[setId eq '"+setId+"']/version",app.SCOPE.APP_CONFIG,{}),entryId=setId+"_"+version+"_ENTRY";return dao.get(setId+"_"+version+"_config").done(function(setConfig){dao.get(entryId).done(function(wrapper){wrapper._id=documentId,delete wrapper._rev,eval("delete wrapper.model.pending.data."+setId),wrapper.type="indicator",void 0!=setConfig.moderation&&1==setConfig.moderation.required&&(wrapper.control.draft=!0),wrapper.channels=[],void 0!=LOCAL_SETTINGS.COMMUNITY_CONFIG.communityChannel&&1==LOCAL_SETTINGS.COMMUNITY_CONFIG.communityChannel&&wrapper.channels.push("community_"+LOCAL_SETTINGS.COMMUNITY_CONFIG.communityId),void 0!=LOCAL_SETTINGS.COMMUNITY_CONFIG.profileChannel&&1==LOCAL_SETTINGS.COMMUNITY_CONFIG.profileChannel&&setId!=PROFILE_SET_ID&&wrapper.channels.push("profile_"+profileId),wrapper["meta-data"].profileId=profileId,wrapper["meta-data"].setId=setId,wrapper["meta-data"].applicationId=app.SCOPE.applicationId,wrapper["meta-data"].communityId=LOCAL_SETTINGS.COMMUNITY_CONFIG.communityId,wrapper.updated=moment().format(),wrapper.model.pending.user={name:LOCAL_SETTINGS.SESSION.firstName+" "+LOCAL_SETTINGS.SESSION.lastName,userId:LOCAL_SETTINGS.SUBSCRIPTIONS.userId,username:LOCAL_SETTINGS.SUBSCRIPTIONS.username},wrapper.author={name:LOCAL_SETTINGS.SESSION.firstName+" "+LOCAL_SETTINGS.SESSION.lastName,userId:LOCAL_SETTINGS.SUBSCRIPTIONS.userId,username:LOCAL_SETTINGS.SUBSCRIPTIONS.username},wrapper.contributors.push({name:LOCAL_SETTINGS.SESSION.firstName+" "+LOCAL_SETTINGS.SESSION.lastName,userId:LOCAL_SETTINGS.SUBSCRIPTIONS.userId,username:LOCAL_SETTINGS.SUBSCRIPTIONS.username}),wrapper.category.term=setId,wrapper.source="remote",wrapper.created=moment().format(),wrapper.model.pending.status=ENTRY_STATUS_INITIALISED,wrapper.model.pending.seq=1,wrapper.model.pending.validDate=validDate,service.getGPS().done(function(e){wrapper.gps=e,dfd.resolve(wrapper)}).fail(function(e){wrapper.gps={},dfd.resolve(wrapper)})}).fail(function(e){dfd.reject(e)})}).fail(function(e){dfd.reject(e)}),dfd.promise()},approvedWrapper:function(e,r,t){var a=new $.Deferred,n=JSON.xpath("/indicators[setId eq '"+e+"']/version",app.SCOPE.APP_CONFIG,{}),o=e+"_"+n+"_APPROVED";return dao.get(e+"_"+n+"_config").done(function(n){dao.get(o).done(function(o){o._id=t,delete o._rev,o.type="indicator",void 0!=n.moderation&&1==n.moderation.required&&(o.control.draft=!0),o.title=t+"_APPROVED",o.channels=[],void 0!=LOCAL_SETTINGS.COMMUNITY_CONFIG.communityChannel&&1==LOCAL_SETTINGS.COMMUNITY_CONFIG.communityChannel&&o.channels.push("community_"+LOCAL_SETTINGS.COMMUNITY_CONFIG.communityId),void 0!=LOCAL_SETTINGS.COMMUNITY_CONFIG.profileChannel&&1==LOCAL_SETTINGS.COMMUNITY_CONFIG.profileChannel&&e!=PROFILE_SET_ID&&o.channels.push("profile_"+r),o["meta-data"].profileId=r,o["meta-data"].setId=e,o["meta-data"].applicationId=app.SCOPE.applicationId,o["meta-data"].communityId=LOCAL_SETTINGS.COMMUNITY_CONFIG.communityId,o.updated=moment().format(),o.author={name:LOCAL_SETTINGS.SESSION.firstName+" "+LOCAL_SETTINGS.SESSION.lastName,userId:LOCAL_SETTINGS.SUBSCRIPTIONS.userId,username:LOCAL_SETTINGS.SUBSCRIPTIONS.username},o.contributors.push({name:LOCAL_SETTINGS.SESSION.firstName+" "+LOCAL_SETTINGS.SESSION.lastName,userId:LOCAL_SETTINGS.SUBSCRIPTIONS.userId,username:LOCAL_SETTINGS.SUBSCRIPTIONS.username}),o.category.term=e,o.source="remote",o.created=moment().format(),service.getGPS().done(function(e){o.gps=e,a.resolve(o)}).fail(function(e){o.gps={},a.reject(e)})}).fail(function(e){a.reject(e)})}).fail(function(e){a.reject(e)}),a.promise()},rejectedWrapper:function(e,r,t){var a=new $.Deferred,n=JSON.xpath("/indicators[setId eq '"+e+"']/version",app.SCOPE.APP_CONFIG,{}),o=e+"_"+n+"_REJECTED";return dao.get(e+"_"+n+"_config").done(function(n){dao.get(o).done(function(o){o._id=t,delete o._rev,o.type="indicator",void 0!=n.moderation&&1==n.moderation.required&&(o.control.draft=!0),o.title=t+"_REJECTED",o.channels=[],void 0!=LOCAL_SETTINGS.COMMUNITY_CONFIG.communityChannel&&1==LOCAL_SETTINGS.COMMUNITY_CONFIG.communityChannel&&o.channels.push("community_"+LOCAL_SETTINGS.COMMUNITY_CONFIG.communityId),void 0!=LOCAL_SETTINGS.COMMUNITY_CONFIG.profileChannel&&1==LOCAL_SETTINGS.COMMUNITY_CONFIG.profileChannel&&e!=PROFILE_SET_ID&&o.channels.push("profile_"+r),o["meta-data"].profileId=r,o["meta-data"].setId=e,o["meta-data"].applicationId=app.SCOPE.applicationId,o["meta-data"].communityId=LOCAL_SETTINGS.COMMUNITY_CONFIG.communityId,o.updated=moment().format(),o.author={name:LOCAL_SETTINGS.SESSION.firstName+" "+LOCAL_SETTINGS.SESSION.lastName,userId:LOCAL_SETTINGS.SUBSCRIPTIONS.userId,username:LOCAL_SETTINGS.SUBSCRIPTIONS.username},o.contributors.push({name:LOCAL_SETTINGS.SESSION.firstName+" "+LOCAL_SETTINGS.SESSION.lastName,userId:LOCAL_SETTINGS.SUBSCRIPTIONS.userId,username:LOCAL_SETTINGS.SUBSCRIPTIONS.username}),o.category.term=e,o.source="remote",o.created=moment().format(),service.getGPS().done(function(e){o.gps=e,a.resolve(o)}).fail(function(e){o.gps={},a.reject(e)})}).fail(function(e){a.reject(e)})}).fail(function(e){a.reject(e)}),a.promise()},saveEntries:function(e,r,t,a){var n=new $.Deferred;library.entryWrapper(e,r,t,a).done(function(a){var o=function(){var a=new $.Deferred,n=t+":approved";return library.approvedWrapper(e,r,n).done(function(e){a.resolve(e)}).fail(function(e){a.reject(e)}),a},d=function(){var a=new $.Deferred,n=t+":rejected";library.rejectedWrapper(e,r,n).done(function(e){a.resolve(e)}).fail(function(e){a.reject(e)});return a},S=function(e,r,t,a,n){var o={status:e,name:r,message:t,error:a,model:n};return o};o().done(function(e){d().done(function(r){var t=S(CREATED_CODE,CREATED_NAME,"Model created",!1,a),o=S(CREATED_CODE,CREATED_NAME,"Approved created",!1,e),d=S(CREATED_CODE,CREATED_NAME,"Rejected created",!1,r),I=[t,o,d];n.resolve(I)}).fail(function(r){var t=S(CREATED_CODE,CREATED_NAME,"Model created",!1,a),o=S(CREATED_CODE,CREATED_NAME,"Approved created",!1,e),d=S(err.status,err.name,"Rejected object not created with error message "+err.message,!0,null),I=[t,o,d];n.reject(I)})}).fail(function(e){var r=S(CREATED_CODE,CREATED_NAME,"Model created",!1,a),t=S(err.status,err.name,"Approved object not created "+err.message,!0,null),o=S(err.status,err.name,"Rejected object creation skipped due to approve creation failure"+err.message,!0,null),d=[r,t,o];n.reject(d)})}).fail(function(e){var r=getResponse(e.status,e.name,"Model object not created "+e.message,!0,null),t=getResponse(e.status,e.name,"Approved object not created skipped due to model creation failure "+e.message,!0,null),a=getResponse(e.status,e.name,"Rejected object creation skipped due to model creation failure"+e.message,!0,null),o=[r,t,a];n.reject(o)});return n},createProfileInstance:function(){}}}();

},{}]},{},[1])(1)
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL1VzZXJzL0hhc2FuL0FwcERhdGEvUm9hbWluZy9ucG0vbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsImluZGV4LmpzIiwibGliXFxiZXR0ZXJkYXRhLmRhby5qcyIsImxpYlxcY29uZmlnLmpzIiwibGliXFxsaWJyYXJ5LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUEsWUFzQkEsU0FBUyxPQXBCVCxRQUFRLGdCQUNSLFFBQVEsaUJBQ1IsUUFBUSx1QkF1QlIsSUFBSSxhQUFjLFNBQVMsRUFBUSxFQUFNLEVBQVMsRUFBTyxFQUFNLEVBQWUsR0FFdEUsR0FBSSxJQUNnQixPQUFRLEVBQ1IsS0FBTSxFQUNOLFFBQVMsRUFDVCxNQUFPLEVBQ1AsTUFBTyxFQUUzQixPQUFRLEdBMEJoQixJQUFHLFVBQVUsWUFBYyxTQUFTLEVBQVksRUFBYyxFQUFPLEVBQVcsR0FFNUUsR0FDSSxHQUFNLEdBQUksR0FBRSxRQUVoQixJQUFHLEdBQWdCLHNCQUVmLElBQUksSUFBSSxHQUFZLEtBQ2hCLFNBQVMsR0FFTCxHQUFJLEdBQVcsWUFBWSxjQUFlLGNBQWMsd0NBQXVDLEVBQUssTUFFaEcsR0FBaUIsRUFFckIsR0FBSSxPQUFPLEtBRVosS0FBSyxTQUFTLEdBRWIsUUFBUSxZQUFZLEVBQU8sRUFBVyxFQUFZLEdBQVcsS0FBSyxTQUFTLEdBR3BFLEdBQVMsZUFFUixRQUFRLHVCQUF1QixlQUFlLHNCQUF1QixHQUdyRSxRQUFRLG9CQUFvQixLQUFPLEVBQVcsTUFBUSxFQUFNLGNBQWdCLElBQUksTUFBTSxjQUFlLFVBQVksSUFBSSxNQUFNLFlBRy9ILEVBQUksUUFBUSxLQUViLEtBQUssU0FBUyxHQUViLEdBQUksR0FBVyxZQUFZLEVBQUksT0FBUSxFQUFJLEtBQU0sRUFBSSxTQUFTLEVBQU0sR0FFaEUsR0FBaUIsRUFFckIsR0FBSSxPQUFPLFdBT3BCLElBQUcsR0FBZ0Isc0JB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LE1BRTNFLEdBQWlCLEVBQVMsRUFBWSxFQUU3QyxHQUFJLE9BQU8sT0FLUCxLQUNDLFNBQVMsR0FFTCxHQUFJLEdBQVUsRUFBWSxhQUFjLGFBQ2pDLGlCQUFpQixFQUFPLEdBRWpDLEVBQWMsRUFBWSxJQUFJLE9BQVEsSUFBSSxLQUNwQywrQkFBK0IsSUFBSSxTQUFTLEVBQU0sTUFFMUUsRUFBYyxFQUFZLElBQUksT0FBUSxJQUFJLEtBQ2xCLG1FQUFvRSxJQUFJLFNBQVMsRUFBTSxNQUU3RixHQUFpQixFQUFTLEVBQVksRUFFN0MsR0FBSSxPQUFPLE9BS25CLEtBQUssU0FBUyxHQUViLEdBQUksR0FBVSxZQUFZLEVBQUksT0FBUSxFQUFJLEtBQ3RDLDRCQUE0QixFQUFJLFNBQVMsRUFBTSxNQUVsRCxFQUFjLFlBQVksRUFBSSxPQUFRLEVBQUksS0FDdkMscUVBQXFFLEVBQUksU0FBUyxFQUFNLE1BRXBHLEVBQWMsWUFBWSxFQUFJLE9BQVEsRUFBSSxLQUM5QixpRUFBa0UsRUFBSSxTQUFTLEVBQU0sTUFFeEYsR0FBaUIsRUFBUyxFQUFZLEVBRTdDLEdBQUksT0FBTyxJQUtULE9BQU8sSUFLZixzQkFBdUIiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxucmVxdWlyZSgnLi9saWIvY29uZmlnJyk7XHJcbnJlcXVpcmUoJy4vbGliL2xpYnJhcnknKTtcclxucmVxdWlyZSgnLi9saWIvYmV0dGVyZGF0YS5kYW8nKTtcclxuXHJcblxyXG4vKiogXHJcbiAqIFJlcHJlc2VudHMgdGhlIGdhdGVrZWVwZXIgbW9kdWxlLlxyXG4gKiBUaGlzIG1vZHVsZSB3aWxsIGhvbGQgYWxsIGZ1bmN0aW9ucyB0byBhY2Nlc3MgZ2F0ZWtlZXBlciB2aSBHSygpIG9iamVjdFxyXG4gKlxyXG4gKiBAY2xhc3NcclxuICogUmV0dXJucyBHSygpIG9iamVjdCBcclxuICogQGF1dGhvciBIYXNhbiBBYmJhc1xyXG4gKiBAdmVyc2lvbiAxLjAuMFxyXG4gKlxyXG4gKiBAZXhhbXBsZSBcclxuICogdmFyIGdhdGVrZWVwZXIgPSBuZXcgR0soKTtcclxuICpcclxuICogQHJldHVybiB7T2JqZWN0fSBuZXcgR0sgY29uc3RydWN0b3IgLyBjbGFzcyBvYmplY3RcclxuICpcclxuICovXHJcbmZ1bmN0aW9uIEdLKCl7XHJcbiAgICAvL1xyXG4gICAgdmFyIF90aGlzID0gdGhpcztcclxufVxyXG5cclxudmFyIGdldFJlc3BvbnNlID0gZnVuY3Rpb24oc3RhdHVzLCBuYW1lLCBtZXNzYWdlLCBlcnJvciwgbW9kZWwsYXBwcm92ZWRNb2RlbCwgcmVqZWN0ZWRNb2RlbCl7XHJcblxyXG4gICAgICAgIHZhciByZXNwb25zZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogc3RhdHVzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogbmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbDogbW9kZWxcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuICByZXNwb25zZVxyXG4gICAgXHJcbn1cclxuXHJcbi8qKiBcclxuICogUmVwcmVzZW50cyB0aGUgaW5zdGFudGlhdGUgZnVuY3Rpb24uXHJcbiAqIENyZWF0ZXMgbmV3IGRvY3VtZW50IGluIGNhc2Ugb2YgbmV3SW5zdGFuY2UsIGFsc28gY3JlYXRlcyBhcHByb3ZlZCBhbmQgcmVqZWN0ZWQgZG9jdW1lbnRzLlxyXG4gKiBDcmVhdGVzIG5ldyBzdWVuY2UgaW4gY2FzZSBvZiBuZXdTZXF1ZW5jZS5cclxuICogQG1ldGhvZFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gZG9jdW1lbnRJZCAtIGRvY3VtZW50IGlkIHdoaWNoIG5lZWRzIHRvIGJlIGluaXRpYWxpc2VkXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBpbnN0YW5jZVR5cGUgLSB2YWx1ZWQgY2FuIGJlIChuZXdJbnN0YW5jZS9uZXdTZXF1ZW5jZSlcclxuICogQHBhcmFtIHtzdHJpbmd9IHNldElkIC0gc2V0SWRcclxuICogQHBhcmFtIHtzdHJpbmd9IHByb2ZpbGVJZCAtIHByb2ZpbGVJZFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gdmFsaWREYXRlIC0gdmFsaWREYXRlXHJcbiBcclxuICogQGF1dGhvciBIYXNhbiBBYmJhc1xyXG4gKiBAdmVyc2lvbiAxLjAuMFxyXG4gKlxyXG4gKiBAZXhhbXBsZSBcclxuICogdmFyIGdhdGVrZWVwZXIgPSBuZXcgR0soKTtcclxuICogZ2F0ZWtlZWVyLmluc3RhbnRpYXRlKCdhYmMxNjEnLCduZXdTZXF1ZW5jZScsJ2RldmVsb3BlckRldGFpbCcsMjIsJzIyLzA0LzIwMTYnKTtcclxuICpcclxuICogQHJldHVybiB7T2JqZWN0fSBQcm9taXNlIE9iamVjdCB3aXRoIHJlc3Bvc2UgT2JqZWN0XHJcbiAqXHJcbiAqL1xyXG5cclxuR0sucHJvdG90eXBlLmluc3RhbnRpYXRlID0gZnVuY3Rpb24oZG9jdW1lbnRJZCwgaW5zdGFuY2VUeXBlLCBzZXRJZCwgcHJvZmlsZUlkLCB2YWxpZERhdGUpe1xyXG4gICAgXHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgZGVmID0gbmV3ICQuRGVmZXJyZWQoKTtcclxuXHJcbiAgICBpZihpbnN0YW5jZVR5cGUgPT0gSU5TVEFOQ0VfVFlQRV9ORVdfSU5TKXtcclxuXHJcbiAgICAgICAgZGFvLmdldChkb2N1bWVudElkKS5kb25lKFxyXG4gICAgICAgICAgICBmdW5jdGlvbihkYXRhKXsgXHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIHZhciByZXNwb25zZSA9IGdldFJlc3BvbnNlKENPTkZMSUNUX0NPREUsIENPTkZMSUNUX05BTUUsJ0RvY3VtZW50IHdpdGggc2FtZSBpZCBhbHJlYWR5IGV4aXN0cycsdHJ1ZSxudWxsKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlQXJyYXkgPSBbcmVzcG9uc2VdO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBkZWYucmVqZWN0KHJlc3BvbnNlQXJyYXkpO1xyXG5cclxuICAgICAgICAgICAgfSkuZmFpbChmdW5jdGlvbihlcnIpe1xyXG5cclxuICAgICAgICAgICAgICAgIGxpYnJhcnkuc2F2ZUVudHJpZXMoc2V0SWQsIHByb2ZpbGVJZCwgZG9jdW1lbnRJZCwgdmFsaWREYXRlKS5kb25lKGZ1bmN0aW9uKGRhdGEpe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAvLyBUYWtlbiBmcm9tIG9sZCBzZXJ2aWNlSW1wbCA6IFRPRE86IHJldmlld1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKHNldElkID09IFBST0ZJTEVfU0VUX0lEKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2VydmljZS5jcmVhdGVQcm9maWxlRG9jdW1lbnRzKExPQ0FMX1NFVFRJTkdTLkNPTU1VTklUWV9jb21tdW5pdHlJZCwgZG9jdW1lbnRJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGVsc2V7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2UuYWRkVG9Mb2NhbFJlZ2lzdHJ5KHtcInV1aWRcIjpkb2N1bWVudElkLFwic2V0SWRcIjpzZXRJZCxcImFwcGxpY2F0aW9uSWRcIjphcHAuU0NPUEUuYXBwbGljYXRpb25JZCwgXCJwcm9maWxlSWRcIjphcHAuU0NPUEUucHJvZmlsZUlkfSk7IFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xyXG5cclxuICAgICAgICAgICAgICAgIH0pLmZhaWwoZnVuY3Rpb24oZXJyKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlID0gZ2V0UmVzcG9uc2UoZXJyLnN0YXR1cywgZXJyLm5hbWUsIGVyci5tZXNzYWdlLCB0cnVlLCBlcnIpO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlQXJyYXkgPSBbcmVzcG9uc2VdO1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QocmVzcG9uc2VBcnJheSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICB9IGVsc2UgaWYoaW5zdGFuY2VUeXBlID09IElOU1RBTkNFX1RZUEVfTkVXX1NFUSkge1xyXG5cclxuICAgICAgICAgZGFvLmdldChkb2N1bWVudElkKS5kb25lKFxyXG4gICAgICAgICAgICBmdW5jdGlvbihkYXRhKXtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICBpZihkYXRhLm1vZGVsLnBlbmRpbmcuc3RhdHVzID09IEVOVFJZX1NUQVRVU19BVVRIT1JJU0VEIHx8IGRhdGEubW9kZWwucGVuZGluZy5zdGF0dXMgPT0gRU5UUllfU1RBVFVTX1JFSkVDVEVEKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBzYXZlTmV3U2VxID0gZnVuY3Rpb24obmV3U2VxKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ25ld1NlcT09JytuZXdTZXEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgIGRhdGEubW9kZWwucGVuZGluZy5zZXEgPSBuZXdTZXE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5tb2RlbC5wZW5kaW5nLmRhdGEgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICAgICBkYXRhLm1vZGVsLnBlbmRpbmcuc3RhdHVzID0gRU5UUllfU1RBVFVTX0lOSVRJQUxJU0VEO1xyXG4gICAgICAgICAgICAgICAgICAgICAgIGRhdGEubW9kZWwucGVuZGluZy52YWxpZERhdGUgPSB2YWxpZERhdGU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5tb2RlbC5wZW5kaW5nLnJldmlzaW9uID0gJyc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgdmFyIHVzZXI9IHtcIm5hbWVcIjogTE9DQUxfU0VUVElOR1MuU0VTU0lPTi5maXJzdE5hbWUgKyBcIiBcIiArIExPQ0FMX1NFVFRJTkdTLlNFU1NJT04ubGFzdE5hbWUsXCJ1c2VySWRcIjogTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQsIFwidXNlcm5hbWVcIjogTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VybmFtZX07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5tb2RlbC5wZW5kaW5nLnVzZXIgPSB1c2VyO1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG5cclxuICAgICAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBhcHByb3ZlX2RvY19pZCA9IGRvY3VtZW50SWQrJzphcHByb3ZlZCdcclxuICAgICAgICAgICAgICAgICAgICBkYW8uZ2V0KGFwcHJvdmVfZG9jX2lkKS5kb25lKGZ1bmN0aW9uKGFwcHJvdmVkRGF0YSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZXEgPSBKU09OLnhwYXRoKFwibWF4KC8vYXBwcm92ZWQvc2VxKVwiLGtvLnRvSlMoYXBwcm92ZWREYXRhKSx7fSlbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXdfc2VxID0gc2VxICsgMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgc2F2ZU5ld1NlcShuZXdfc2VxKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtYWluUmVzID0gZ2V0UmVzcG9uc2UoQ1JFQVRFRF9DT0RFLCBDUkVBVEVEX05BTUUsICdTZXF1ZW5jZSBjcmVhdGVkJywgZmFsc2UsIGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcG9uc2VBcnJheSA9IFttYWluUmVzXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUocmVzcG9uc2VBcnJheSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH0pLmZhaWwoZnVuY3Rpb24oZXJyKXtcclxuICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtYWluUmVzID0gZ2V0UmVzcG9uc2UoZXJyLnN0YXR1cywgZXJyLm5hbWUsICdBcHByb3ZlZCBkb2Mgbm90IGZvdW5kIHRvIGNyZWF0ZSBhIG5ldyBzZXF1ZW5jZScsIHRydWUsIG51bGwpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlQXJyYXkgPSBbbWFpblJlc107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KHJlc3BvbnNlQXJyYXkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXNwb25zZSA9IGdldFJlc3BvbnNlKFNFUlZFUl9FUlJPUl9DT0RFLCBTRVJWRVJfRVJST1JfTkFNRSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdDYW5ub3QgY3JlYXRlIHNlcXVlbmNlLiBDdXJyZW50IHN0YXR1cyBzaG91bGQgYmUgJysgRU5UUllfU1RBVFVTX0FVVEhPUklTRUQgKyAnIG9yICcrIEVOVFJZX1NUQVRVU19SRUpFQ1RFRCwgdHJ1ZSwgbnVsbCApO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXNwb25zZUFycmF5ID0gW3Jlc3BvbnNlXTtcclxuICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KHJlc3BvbnNlQXJyYXkpO1xyXG4gICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9KS5mYWlsKGZ1bmN0aW9uKGVycil7XHJcbiAgICAgICAgICAgICAgICAvL2NyZWF0ZSBkb2N1bWVudCByZWxhdGluZyB0byBuZXcgc2VxXHJcbiAgICAgICAgICAgICAgICBsaWJyYXJ5LnNhdmVFbnRyaWVzKHNldElkLCBwcm9maWxlSWQsIGRvY3VtZW50SWQsIHZhbGlkRGF0ZSkuZG9uZShmdW5jdGlvbihkYXRhKXtcclxuICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgICAgIH0pLmZhaWwoZnVuY3Rpb24oZXJyKXtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcG9uc2UgPSBnZXRSZXNwb25zZShlcnIuc3RhdHVzLCBlcnIubmFtZSwgZXJyLm1lc3NhZ2UsIHRydWUsIG51bGwpOyBcclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcG9uc2VBcnJheSA9IFtyZXNwb25zZV07XHJcbiAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChyZXNwb25zZUFycmF5KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciByZXNwb25zZSA9IGdldFJlc3BvbnNlKFNFUlZFUl9FUlJPUl9DT0RFLCBTRVJWRVJfRVJST1JfTkFNRSwgJ0luc3RhbmNlIHBhcmFtZXRlciBub3QgcGFzc2VkJywgdHJ1ZSwgbnVsbCk7IFxyXG4gICAgICAgIHZhciByZXNwb25zZUFycmF5ID0gW3Jlc3BvbnNlXTtcclxuICAgICAgICBkZWYucmVqZWN0KHJlc3BvbnNlQXJyYXkpO1xyXG5cclxuICAgIFxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBkZWY7XHJcbn07XHJcblxyXG4vKiogXHJcbiAqIFJlcHJlc2VudHMgdGhlIGluc3RhbnRpYXRlRGF0YSBmdW5jdGlvbi5cclxuICpcclxuICogQG1ldGhvZFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gZG9jdW1lbnRJZCAtIGRvY3VtZW50IGlkIHdoaWNoIG5lZWRzIHRvIGJlIGluaXRpYWxpc2VkXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBpbnN0YW5jZVR5cGUgLSB2YWx1ZWQgY2FuIGJlIChuZXdJbnN0YW5jZS9uZXdTZXF1ZW5jZSlcclxuICogQHBhcmFtIHtzdHJpbmd9IGluc3RhbnRpYXRlRnJvbSAtIHZhbHVlZCBjYW4gYmUgKGZyb21SZXF1ZXN0L2Zyb21EZWZpbml0aW9uL2Zyb21BdXRob3Jpc2VkKVxyXG4gKiBAcGFyYW0ge29iamVjdH0gaW5kaWNhdG9yTW9kZWwgLSB2aWV3TW9kZWwgb2YgaW5kaWNhdG9yXHJcbiAqIEBwYXJhbSB7bnVtYmVyfSBzZXFObyAtIFNlcXVlbmNlIG51bWJlciB0aGF0IG5lZWRzIHRvIGJlIGluaXRpYWxpc2VkLlxyXG4gXHJcbiBcclxuICogQGF1dGhvciBIYXNhbiBBYmJhc1xyXG4gKiBAdmVyc2lvbiAxLjAuMFxyXG4gKlxyXG4gKiBAZXhhbXBsZSBcclxuICogdmFyIGdhdGVrZWVwZXIgPSBuZXcgR0soKTtcclxuICogZ2F0ZWtlZWVyLmluc3RhbnRpYXRlRGF0YSgnYWJjMTYxJywnbmV3U2VxdWVuY2UnLCdmcm9tQXV0aG9yaXNlZCcsdmlld01vZGVsLDEpXHJcbiAqXHJcbiAqIEByZXR1cm4ge09iamVjdH0gUHJvbWlzZSBPYmplY3Qgd2l0aCByZXNwb3NlIE9iamVjdFxyXG4gKlxyXG4gKi9cclxuR0sucHJvdG90eXBlLmluc3RhbnRpYXRlRGF0YSA9IGZ1bmN0aW9uKGRvY3VtZW50SWQsIGluc3RhbnRpYXRlRnJvbSwgaW5kaWNhdG9yTW9kZWwsIHNlcU5vKXtcclxuXHJcbiAgICAvL2Zyb20gOiAxIC0gaW5wdXRcclxuICAgIC8vZnJvbSA6IDIgLSBkZWZpbml0aW9uXHJcbiAgICAvL2Zyb20gOiAzIC0gYXV0aG9yaXNlZFxyXG5cclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBkZWYgPSBuZXcgJC5EZWZlcnJlZCgpO1xyXG5cclxuICAgIHZhciBnZXRSZXNwb25zZSA9IGZ1bmN0aW9uKHN0YXR1cywgbmFtZSwgbWVzc2FnZSwgZXJyb3IsIG1vZGVsKXtcclxuXHJcbiAgICAgICAgdmFyIHJlc3BvbnNlID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiBzdGF0dXMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvcixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsOiBtb2RlbFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICByZXR1cm4gIHJlc3BvbnNlXHJcbiAgICB9XHJcblxyXG4gICAgZGFvLmdldChkb2N1bWVudElkKS5kb25lKFxyXG4gICAgICAgICAgICBmdW5jdGlvbihkYXRhKXtcclxuXHJcbiAgICAgICAgICAgICAgICBpZihkYXRhLm1vZGVsLnBlbmRpbmcuc3RhdHVzID09IEVOVFJZX1NUQVRVU19JTklUSUFMSVNFRCl7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmKGRhdGEubW9kZWwucGVuZGluZy5zZXEgPT0gc2VxTm8pe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoaW5zdGFudGlhdGVGcm9tID09IEZST01fUkVRVUVTVCl7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFvLmdldChkb2N1bWVudElkKS5kb25lKGZ1bmN0aW9uKGRhdGEpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEubW9kZWwucGVuZGluZy5kYXRhW2luZGljYXRvck1vZGVsLmRlZmF1bHRNb2RlbC5zZXRJZCgpXSA9IEpTT04ucGFyc2Uoa28udG9KU09OKGV2YWwoJ2luZGljYXRvck1vZGVsLmN1c3RvbU1vZGVsLicraW5kaWNhdG9yTW9kZWwuZGVmYXVsdE1vZGVsLnNldElkKCkpLCBmdW5jdGlvbihrZXksIHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGtleSA9PT0gJ19fa29fbWFwcGluZ19fJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHZhbHVlID09IHVuZGVmaW5lZCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLm1vZGVsLnBlbmRpbmcuc3RhdHVzID0gRU5UUllfU1RBVFVTX0RBVEFfSU5JVElBTElTRUQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlID0gZ2V0UmVzcG9uc2UoVVBEQVRFRF9DT0RFLCBVUERBVEVEX05BTUUsICdEb2N1bWVudCBpbml0aWFsaXNlZC4nLCBmYWxzZSwgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlQXJyYXkgPSBbcmVzcG9uc2VdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKHJlc3BvbnNlQXJyYXkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmZhaWwoZnVuY3Rpb24oZXJyKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlID0gZ2V0UmVzcG9uc2UoZXJyLnN0YXR1cywgZXJyLm5hbWUsICdDYW5ub3QgZmluZCBkb2N1bWVudCAnK2RvY3VtZW50SWQsIHRydWUsIG51bGwpOyBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcG9uc2VBcnJheSA9IFtyZXNwb25zZV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChyZXNwb25zZUFycmF5KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZihpbnN0YW50aWF0ZUZyb20gPT0gRlJPTV9ERUZJTklUSU9OKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW8uZ2V0KGRvY3VtZW50SWQpLmRvbmUoZnVuY3Rpb24oZGF0YSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNldElkID0gaW5kaWNhdG9yTW9kZWwuZGVmYXVsdE1vZGVsLnNldElkKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZlcnNpb24gPSAgSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW3NldElkIGVxICdcIisgc2V0SWQgK1wiJ10vdmVyc2lvblwiLGFwcC5TQ09QRS5BUFBfQ09ORklHLHt9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2V0TW9kZWxJZD0gc2V0SWQrJ18nK3ZlcnNpb24rJ19FTlRSWSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFvLmdldChzZXRNb2RlbElkKS5kb25lKGZ1bmN0aW9uKHNldE1vZGVsKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkZWZpbml0aW9uTW9kZWwgPSBldmFsKCdzZXRNb2RlbC5tb2RlbC5wZW5kaW5nLmRhdGEuJytzZXRJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEubW9kZWwucGVuZGluZy5kYXRhW3NldElkXSA9IGRlZmluaXRpb25Nb2RlbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5tb2RlbC5wZW5kaW5nLnN0YXR1cyA9IEVOVFJZX1NUQVRVU19EQVRBX0lOSVRJQUxJU0VEO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlID0gZ2V0UmVzcG9uc2UoVVBEQVRFRF9DT0RFLCBVUERBVEVEX05BTUUsICdEb2N1bWVudCBpbml0aWFsaXNlZC4nLCBmYWxzZSwgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNwb25zZUFycmF5ID0gW3Jlc3BvbnNlXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUocmVzcG9uc2VBcnJheSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5mYWlsKGZ1bmN0aW9uKGVycil7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcG9uc2UgPSBnZXRSZXNwb25zZShlcnIuc3RhdHVzLCBlcnIubmFtZSwgJ0Nhbm5vdCBmaW5kIGRlZmF1bHQgbW9kZWwgJytzZXRNb2RlbElkLCB0cnVlLCBudWxsKTsgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNwb25zZUFycmF5ID0gW3Jlc3BvbnNlXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChyZXNwb25zZUFycmF5KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuZmFpbChmdW5jdGlvbihlcnIpe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcG9uc2UgPSBnZXRSZXNwb25zZShlcnIuc3RhdHVzLCBlcnIubmFtZSwgJ0Nhbm5vdCBmaW5kIGRvY3VtZW50ICcrZG9jdW1lbnRJZCwgdHJ1ZSwgbnVsbCk7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNwb25zZUFycmF5ID0gW3Jlc3BvbnNlXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KHJlc3BvbnNlQXJyYXkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmKGluc3RhbnRpYXRlRnJvbSA9PSBGUk9NX0FVVEhPUklTRUQpe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhby5nZXQoZG9jdW1lbnRJZCkuZG9uZShmdW5jdGlvbihkYXRhKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2V0SWQgPSBpbmRpY2F0b3JNb2RlbC5kZWZhdWx0TW9kZWwuc2V0SWQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmVyc2lvbiA9ICBKU09OLnhwYXRoKFwiL2luZGljYXRvcnNbc2V0SWQgZXEgJ1wiKyBzZXRJZCArXCInXS92ZXJzaW9uXCIsYXBwLlNDT1BFLkFQUF9DT05GSUcse30pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhcHByb3ZlZE1vZGVsSWQ9IGRvY3VtZW50SWQrJzphcHByb3ZlZCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFvLmdldChhcHByb3ZlZE1vZGVsSWQpLmRvbmUoZnVuY3Rpb24oYXBwcm92ZWRNb2RlbCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtYXhfc2VxID0gIEpTT04ueHBhdGgoJ21heCgvbW9kZWwvYXBwcm92ZWQvc2VxKScsYXBwcm92ZWRNb2RlbCx7fSlbMF07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsYXN0QXBwcm92ZWRNb2RlbCA9IEpTT04ueHBhdGgoJy9tb2RlbC9hcHByb3ZlZFsuL3NlcSA9ICcrIG1heF9zZXEgKyddJyxhcHByb3ZlZE1vZGVsLHt9KVswXSAgICA7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXdNb2RlbCA9ICBldmFsKCdsYXN0QXBwcm92ZWRNb2RlbC5kYXRhLicrc2V0SWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLm1vZGVsLnBlbmRpbmcuZGF0YVtzZXRJZF0gPSBuZXdNb2RlbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YS5tb2RlbC5wZW5kaW5nLnN0YXR1cyA9IEVOVFJZX1NUQVRVU19EQVRBX0lOSVRJQUxJU0VEO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlID0gZ2V0UmVzcG9uc2UoVVBEQVRFRF9DT0RFLCBVUERBVEVEX05BTUUsICdEb2N1bWVudCBpbml0aWFsaXNlZC4nLCBmYWxzZSwgZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNwb25zZUFycmF5ID0gW3Jlc3BvbnNlXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUocmVzcG9uc2VBcnJheSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmZhaWwoZnVuY3Rpb24oZXJyKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNwb25zZSA9IGdldFJlc3BvbnNlKGVyci5zdGF0dXMsIGVyci5uYW1lLCAnQ2Fubm90IGZpbmQgYXBwcm92ZWQgbW9kZWwgJythcHByb3ZlZE1vZGVsSWQsIHRydWUsIG51bGwpOyBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlQXJyYXkgPSBbcmVzcG9uc2VdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KHJlc3BvbnNlQXJyYXkpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5mYWlsKGZ1bmN0aW9uKGVycil7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNwb25zZSA9IGdldFJlc3BvbnNlKGVyci5zdGF0dXMsIGVyci5uYW1lLCAnQ2Fubm90IGZpbmQgZG9jdW1lbnQgJytkb2N1bWVudElkLCB0cnVlLCBudWxsKTsgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlQXJyYXkgPSBbcmVzcG9uc2VdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QocmVzcG9uc2VBcnJheSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlID0gZ2V0UmVzcG9uc2UoU0VSVkVSX0VSUk9SX0NPREUsIFNFUlZFUl9FUlJPUl9OQU1FLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0lucHV0IHNlcXVlbmNlIHNob3VsZCBiZSBlcXVhbCB0byBwZW5kaW5nIHNlcXVlbmNlLicsIHRydWUsIG51bGwgKTsgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNwb25zZUFycmF5ID0gW3Jlc3BvbnNlXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdChyZXNwb25zZUFycmF5KTtcclxuXHJcblxyXG5cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlID0gZ2V0UmVzcG9uc2UoU0VSVkVSX0VSUk9SX0NPREUsIFNFUlZFUl9FUlJPUl9OQU1FLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1N0YXR1cyBpcyBub3QgaW4gJysgRU5UUllfU1RBVFVTX0lOSVRJQUxJU0VEKyAnIHN0YXRlLicsIHRydWUsIG51bGwgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlQXJyYXkgPSBbcmVzcG9uc2VdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KHJlc3BvbnNlQXJyYXkpO1xyXG5cclxuXHJcblxyXG5cclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIH0pLmZhaWwoZnVuY3Rpb24oZXJyKXtcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgcmVzcG9uc2UgPSBnZXRSZXNwb25zZShlcnIuc3RhdHVzLCBlcnIubmFtZSwgZXJyLm1lc3NhZ2UsIHRydWUsIG51bGwpOyBcclxuICAgICAgICAgICAgICAgIHZhciByZXNwb25zZUFycmF5ID0gW3Jlc3BvbnNlXTtcclxuICAgICAgICAgICAgICAgIGRlZi5yZWplY3QocmVzcG9uc2VBcnJheSk7XHJcblxyXG4gICAgICAgICAgICB9KTtcclxuXHJcblxyXG5cclxuICAgIHJldHVybiBkZWY7XHJcblxyXG59O1xyXG5cclxuLyoqIFxyXG4gKiBSZXByZXNlbnRzIHRoZSB1cGRhdGUgZnVuY3Rpb24gZnVuY3Rpb24uXHJcbiAqIFVwZHRhdGVzIHRoZSBjdXJyZW50IGRvY3VtZW50IHBlbmRpbmcgd2l0aCBpbnB1dCBjdXN0b21Nb2RlbCBvYmplY3QuXHJcbiAqIFByb2Nlc3MgYWxsIHJ1bGVzLCBhdHRhY2htZW50cyBldGMuXHJcbiAqIFVwZGF0ZWQgc3RhdHVzIHRvIFVQREFURUQgb3IgUGVuZGluZ1J1bGVzIGlmIHRoZXJlIGFyZSBhbnkgc2VydmVyIHJ1bGVzXHJcbiAqIEBtZXRob2RcclxuICogQHBhcmFtIHtzdHJpbmd9IGRvY3VtZW50SWQgLSBkb2N1bWVudCBpZCB3aGljaCBuZWVkcyB0byBiZSBpbml0aWFsaXNlZFxyXG4gKiBAcGFyYW0ge29iamVjdH0gaW5kaWNhdG9yTW9kZWwgLSB2aWV3TW9kZWwgb2YgaW5kaWNhdG9yXHJcblxyXG4gXHJcbiAqIEBhdXRob3IgSGFzYW4gQWJiYXNcclxuICogQHZlcnNpb24gMS4wLjBcclxuICpcclxuICogQGV4YW1wbGUgXHJcbiAqIHZhciBnYXRla2VlcGVyID0gbmV3IEdLKCk7XHJcbiAqIGdhdGVrZWVlci51cGRhdGUoJ2FiYzE2MScsdmlld01vZGVsKVxyXG4gKlxyXG4gKiBAcmV0dXJuIHtPYmplY3R9IFByb21pc2UgT2JqZWN0IHdpdGggcmVzcG9zZSBPYmplY3RcclxuICpcclxuICovXHJcblxyXG5HSy5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24oZG9jdW1lbnRJZCxpbmRpY2F0b3JNb2RlbCl7XHJcbiAgICBcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBkZWYgPSBuZXcgJC5EZWZlcnJlZCgpO1xyXG5cclxuICAgIHZhciBwcm9jZXNzQWxsUnVsZXMgPSBcclxuICAgICAgICBmdW5jdGlvbihpbmRleCwgb2JqZWN0LCBpbmRpY2F0b3JNb2RlbCwgY29uZmlnRG9jLCBydWxlUmVzcG9uc2UsIGRlZl9wcm9jZXNzUnVsZXMpe1xyXG5cclxuICAgICAgICAgICAgdmFyIHJ1bGVPYmogPSBjb25maWdEb2MucnVsZXNbaW5kZXhdOyAgIFxyXG4gICAgICAgICAgICB2YXIgZXhlY3V0ZUF0ID0gcnVsZU9iai5leGVjdXRlQXQ7XHJcbiAgICAgICAgICAgIHZhciBpZCA9IHJ1bGVPYmouaWQ7XHJcbiAgICAgICAgICAgIHZhciBzZXEgPSBydWxlT2JqLnNlcTtcclxuICAgICAgICAgICAgdmFyIHR5cGUgPSBydWxlT2JqLmV4ZWN1dGVSdWxlLnJ1bGVUeXBlO1xyXG5cclxuICAgICAgICAgICAgaWYoZXhlY3V0ZUF0ID09ICdsb2NhbCcpe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKHR5cGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAndXBkYXRlJzogXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc291cmNlID0gcnVsZU9iai5leGVjdXRlUnVsZS5wYXJhbXMuc291cmNlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0ciA9ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBvbD0wOyBvbDxydWxlT2JqLmV4ZWN1dGVSdWxlLnBhcmFtcy50YXJnZXQubGVuZ3RoOyBvbCsrKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldEl0ZW0gPSBydWxlT2JqLmV4ZWN1dGVSdWxlLnBhcmFtcy50YXJnZXRbb2xdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXRUeXBlID0gdGFyZ2V0SXRlbS50eXBlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXROYW1lID0gdGFyZ2V0SXRlbS5uYW1lO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHRhcmdldFR5cGUgPT0gJ3ZhcmlhYmxlJyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ciAgPSBzdHIgKyBldmFsKFwiaW5kaWNhdG9yTW9kZWwuY3VzdG9tTW9kZWwuXCIraW5kaWNhdG9yTW9kZWwuZGVmYXVsdE1vZGVsLnNldElkKCkrJy4nKyB0YXJnZXROYW1lKycoKScpKyAnICc7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHIgID0gc3RyICsgdGFyZ2V0TmFtZSArICcgJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihzb3VyY2Uuc3Vic3RyaW5nKDAsIDQpID09ICdkb2M6Jyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZhbCgnb2JqZWN0LicrIHNvdXJjZS5zdWJzdHJpbmcoc291cmNlLmxlbmd0aCwgNCkgKyc9IHN0cjsnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZhbCgnb2JqZWN0Lm1vZGVsLnBlbmRpbmcuZGF0YS4nK2luZGljYXRvck1vZGVsLmRlZmF1bHRNb2RlbC5zZXRJZCgpKycuJytzb3VyY2UrJz0gc3RyOycpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcnVsZVJlc3BvbnNlLnJ1bGVTdGF0dXMgPSAnUlVMRV9DT01QTEVURSc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihpbmRleCA9PSBjb25maWdEb2MucnVsZXMubGVuZ3RoIC0gMSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZl9wcm9jZXNzUnVsZXMucmVzb2x2ZShydWxlUmVzcG9uc2UpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzQWxsUnVsZXMoaW5kZXgrMSwgb2JqZWN0LCBpbmRpY2F0b3JNb2RlbCwgY29uZmlnRG9jLCBydWxlUmVzcG9uc2UsIGRlZl9wcm9jZXNzUnVsZXMpOyAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICdpbml0aWFsaXNlJzpcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlICd1bmlxdWUnOlxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgIC8vVE9ETzogaW1wbGVtZW50IHNlcnZlciBzaWRlIHBvc3QgYWN0aW9ucyAgIFxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgb2JqZWN0Lm1vZGVsLnBlbmRpbmcucHJvY2Vzc2luZ1N0YXR1cy5zZXEgPSBzZXE7XHJcbiAgICAgICAgICAgICAgICAgICAgb2JqZWN0Lm1vZGVsLnBlbmRpbmcucHJvY2Vzc2luZ1N0YXR1cy5ydWxlU3RhdHVzID0gUFJPQ0VTU0lOR19TVEFUVVNfU0VSVkVSX1JVTEVTO1xyXG4gICAgICAgICAgICAgICAgICAgIHJ1bGVSZXNwb25zZS5ydWxlU3RhdHVzID0gJ1JVTEVfU0VSVkVSJztcclxuICAgICAgICAgICAgICAgICAgICBkZWZfcHJvY2Vzc1J1bGVzLnJlc29sdmUocnVsZVJlc3BvbnNlKTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGRlZl9wcm9jZXNzUnVsZXM7XHJcbiAgICB9XHJcblxyXG4gICAgZGFvLmdldChkb2N1bWVudElkKS5kb25lKGZ1bmN0aW9uKGRvYyl7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICBpZihpbmRpY2F0b3JNb2RlbC5tb2RlbEVycm9ycygpLmxlbmd0aCA+IDApe1xyXG5cclxuICAgICAgICAgICAgdmFyIHJlc3BvbnNlID0gZ2V0UmVzcG9uc2UoUFJFQ09ORElUSU9OX0ZBSUxFRF9DT0RFLCBQUkVDT05ESVRJT05fRkFJTEVEX05BTUUsXHJcbiAgICAgICAgICAgICAgICAgICAgJ1RoZXJlIGFyZSAnK2luZGljYXRvck1vZGVsLm1vZGVsRXJyb3JzKCkubGVuZ3RoKyAnIGVycm9ycyBvbiBmb3JtLiBQbGVhc2UgcmVzb2x2ZSBmaXJzdC4nLCB0cnVlLCBudWxsKTtcclxuICAgICAgICAgICAgdmFyIHJlc3BvbnNlQXJyYXkgPSBbcmVzcG9uc2VdO1xyXG4gICAgICAgICAgICBkZWYucmVqZWN0KHJlc3BvbnNlQXJyYXkpO1xyXG5cclxuXHJcbiAgICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgICAgIGlmKGRvYy5tb2RlbC5wZW5kaW5nLnN0YXR1cyA9PSBFTlRSWV9TVEFUVVNfREFUQV9JTklUSUFMSVNFRCB8fCBkb2MubW9kZWwucGVuZGluZy5zdGF0dXMgPT0gRU5UUllfU1RBVFVTX1VQREFURUQpe1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgbW9kZWwgPSBKU09OLnBhcnNlKGtvLnRvSlNPTihldmFsKCdpbmRpY2F0b3JNb2RlbC5jdXN0b21Nb2RlbC4nK2luZGljYXRvck1vZGVsLmRlZmF1bHRNb2RlbC5zZXRJZCgpKSwgZnVuY3Rpb24oa2V5LCB2YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmKGtleSA9PT0gJ19fa29fbWFwcGluZ19fJykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh2YWx1ZSA9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICcnO1xyXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICB9IFxyXG4gICAgICAgICAgICAgICAgfSkpO1xyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICB2YXIgdmVyc2lvbj0nJztcclxuXHJcbiAgICAgICAgICAgICAgICBpZihpbmRpY2F0b3JNb2RlbC5jdXN0b21Nb2RlbC5zZXRJZCgpID09IFBST0ZJTEVfU0VUX0lEKVxyXG4gICAgICAgICAgICAgICAgeyBcclxuICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uID0gJ1YxLjAnO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgeyBcclxuICAgICAgICAgICAgICAgICAgICB2ZXJzaW9uID0gIEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tzZXRJZCBlcSAnXCIraW5kaWNhdG9yTW9kZWwuY3VzdG9tTW9kZWwuc2V0SWQoKStcIiddL3ZlcnNpb25cIixhcHAuU0NPUEUuQVBQX0NPTkZJRyx7fSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gUHJvY2VzcyBhbGwgYXR0YWNobWVudHNcclxuICAgICAgICAgICAgICAgIC8qdmFyIGZpbGVzID0gSlNPTi54cGF0aChcIi8vKltmaWxlRGF0YSBhbmQgaXNDaGFuZ2VkIGVxICd0cnVlJ11cIixtb2RlbCx7fSk7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIHZhciBhdHRhY2hlbWVudHNUb1Byb2Nlc3MgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICBmb3IodmFyIG9sPTA7b2w8ZmlsZXMubGVuZ3RoO29sKyspe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmlsZXNPYmo9ZmlsZXNbb2xdOyAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZihmaWxlc09iai5taW1lID09ICdpbWFnZS9qcGVnJyB8fCBmaWxlc09iai5taW1lID09ICdpbWFnZS9wbmcnKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dGFjaGVtZW50c1RvUHJvY2Vzcy5wdXNoKHsgXCJkYXRhXCI6IGZpbGVzT2JqLmZpbGVEYXRhLnN1YnN0cmluZyhmaWxlc09iai5maWxlRGF0YS5pbmRleE9mKCdiYXNlNjQnKSs3KSwgXCJpZFwiOiBmaWxlc09iai51dWlkICwgXCJtaW1lXCI6IGZpbGVzT2JqLm1pbWUgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF0dGFjaGVtZW50c1RvUHJvY2Vzcy5wdXNoKHsgXCJkYXRhXCI6IGZpbGVzT2JqLmZpbGVEYXRhLCBcImlkXCI6IGZpbGVzT2JqLnV1aWQgLCBcIm1pbWVcIjogZmlsZXNPYmoubWltZSB9KTsgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmaWxlc09iai5maWxlRGF0YSA9IFwiXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVzT2JqLmlzQ2hhbmdlZCA9ICdmYWxzZSc7XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIGFsbEZpbGVzID0gSlNPTi54cGF0aChcIi8vKltmaWxlRGF0YSBuZSAnJyBhbmQgdXVpZCBuZSAnJ11cIixtb2RlbCx7fSk7XHJcbiAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBvbD0wO29sPGFsbEZpbGVzLmxlbmd0aDtvbCsrKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYWxsRmlsZXNbb2xdLmZpbGVEYXRhID0gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICB9ICAgXHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHNhdmVBdHRhY2htZW50cyA9IGZ1bmN0aW9uKGRhdGEsIGxvb3ApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIGRhby5zYXZlQXR0YWNobWVudChkYXRhLmlkLCBkYXRhLnJldiwgYXR0YWNoZW1lbnRzVG9Qcm9jZXNzW2xvb3BdLmRhdGEsIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhdHRhY2hlbWVudHNUb1Byb2Nlc3NbbG9vcF0ubWltZSwgYXR0YWNoZW1lbnRzVG9Qcm9jZXNzW2xvb3BdLmlkKVxyXG4gICAgICAgICAgICAgICAgICAgIC5kb25lKGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhdHRhY2hlbWVudHNUb1Byb2Nlc3MubGVuZ3RoID4gKGxvb3AgKyAxKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2F2ZUF0dGFjaG1lbnRzKGUsIGxvb3AgKyAxKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH0pLmZhaWwoZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJjYW4gbm90IHNhdmVkIGF0dGFjaGVtbnQgXCIgKyBlKTtcclxuICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIH07Ki9cclxuXHJcbiAgICAgICAgICAgICAgIFxyXG5cclxuICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICBkYW8uZ2V0KGluZGljYXRvck1vZGVsLmN1c3RvbU1vZGVsLnNldElkKCkrICdfJyt2ZXJzaW9uK1wiX2NvbmZpZ1wiKS5kb25lKGZ1bmN0aW9uKGNvbmZpZ0RvYyl7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGRvYy5tb2RlbC5wZW5kaW5nLmRhdGFbaW5kaWNhdG9yTW9kZWwuY3VzdG9tTW9kZWwuc2V0SWQoKV0gPSBtb2RlbDtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgLy9kb2MubW9kZWwucGVuZGluZy5zdGF0dXMgPSBFTlRSWV9TVEFUVVNfUEVORElORztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaWYoY29uZmlnRG9jLm1vZGVyYXRpb24gIT0gdW5kZWZpbmVkICYmIGNvbmZpZ0RvYy5tb2RlcmF0aW9uLnJlcXVpcmVkID09IHRydWUpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkb2MuY29udHJvbC5kcmFmdCA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgdXBkYXRlZCBkYXRlIGZpZWxkXHJcbiAgICAgICAgICAgICAgICAgICAgZG9jLnVwZGF0ZWQgPSBtb21lbnQoKS5mb3JtYXQoKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgdGhlIGNvbnRyaWJ1dG9ycyBsaXN0XHJcbiAgICAgICAgICAgICAgICAgICAgZG9jLmNvbnRyaWJ1dG9ycy5wdXNoKHtcIm5hbWVcIjogTE9DQUxfU0VUVElOR1MuU0VTU0lPTi5maXJzdE5hbWUgKyBcIiBcIiArIExPQ0FMX1NFVFRJTkdTLlNFU1NJT04ubGFzdE5hbWUsXCJ1c2VySWRcIjogTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQsIFwidXNlcm5hbWVcIjogTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VybmFtZX0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBkb2MubW9kZWwucGVuZGluZy51c2VyID0ge1wibmFtZVwiOiBMT0NBTF9TRVRUSU5HUy5TRVNTSU9OLmZpcnN0TmFtZSArIFwiIFwiICsgTE9DQUxfU0VUVElOR1MuU0VTU0lPTi5sYXN0TmFtZSxcInVzZXJJZFwiOiBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZCwgXCJ1c2VybmFtZVwiOiBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJuYW1lfTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgLy8gU2F2ZSB0aGUgZG9jdW1lbnQgaW4gdGhlIGRhdGFiYXNlIGkuZS4gbG9jYWwgUG91Y2hEQiBvciBDb3VjaGJhc2UgTGl0ZVxyXG4gICAgICAgICAgICAgICAgICAgIGRvYy5zb3VyY2UgPSBcInJlbW90ZVwiO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZihjb25maWdEb2MucnVsZXMgIT0gdW5kZWZpbmVkICYmIGNvbmZpZ0RvYy5ydWxlcy5sZW5ndGggPiAwKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2MubW9kZWwucGVuZGluZy5zdGF0dXMgPSBFTlRSWV9TVEFUVVNfUEVORElOR19SVUxFUztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vU3RhcnQgcnVsZSBwcm9jZXNzaW5nIGhlcmUgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkZWZfcHJvY2Vzc1J1bGVzID0gbmV3ICQuRGVmZXJyZWQoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByb2Nlc3NBbGxSdWxlcygwLCBkb2MsIGluZGljYXRvck1vZGVsLCBjb25maWdEb2Mse1wicnVsZVN0YXR1c1wiOlwiXCJ9LGRlZl9wcm9jZXNzUnVsZXMpLmRvbmUoZnVuY3Rpb24oaW5Nb2RlbCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaW5Nb2RlbC5ydWxlU3RhdHVzID09ICdSVUxFX0NPTVBMRVRFJyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2MubW9kZWwucGVuZGluZy5wcm9jZXNzaW5nU3RhdHVzLnNlcSA9ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2MubW9kZWwucGVuZGluZy5wcm9jZXNzaW5nU3RhdHVzLnJ1bGVTdGF0dXMgPSAnJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZG9jLm1vZGVsLnBlbmRpbmcuc3RhdHVzID0gRU5UUllfU1RBVFVTX1VQREFURUQ7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL1RPRE86IEZpeCBFTlRSWV9TVEFUVVNfUkVBRFlfVE9fU1VCTUlUIGluIGRvY3VtZW50LiBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoYXBwLnByb2Nlc3NJZCAhPSB1bmRlZmluZWQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwcm9jZXNzID0gSlNPTi54cGF0aChcIi9wcm9jZXNzZXNbc3ViUHJvY2Vzc0lkIGVxICdcIithcHAucHJvY2Vzc0lkK1wiJ11cIixkb2Mse30pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihwcm9jZXNzLmxlbmd0aCA+IDApXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc1swXS5zdGF0dXMgPSBFTlRSWV9TVEFUVVNfUkVBRFlfVE9fU1VCTUlUOy8vIGNoZWNrIGhlcmUgdGhlIGluZGV4XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9ICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZGljYXRvck1vZGVsLmRlZmF1bHRNb2RlbC5hdG9tSWQoZG9jdW1lbnRJZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNwb25zZSA9IGdldFJlc3BvbnNlKFVQREFURURfQ09ERSwgVVBEQVRFRF9OQU1FLCdEb2N1bWVudCB1cGRhdGVkJywgZmFsc2UsIGRvYyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNwb25zZUFycmF5ID0gW3Jlc3BvbnNlXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUocmVzcG9uc2VBcnJheSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZihpbk1vZGVsLnJ1bGVTdGF0dXMgPT0gJ1JVTEVfU0VSVkVSJyl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnZGVwZW5kZW50IG9uc2VydmVyIHJ1bGUnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXNwb25zZSA9IGdldFJlc3BvbnNlKFVQREFURURfQ09ERSwgVVBEQVRFRF9OQU1FLCdkZXBlbmRlbnQgb25zZXJ2ZXIgcnVsZScsIGZhbHNlLCBkb2MpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcG9uc2VBcnJheSA9IFtyZXNwb25zZV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKHJlc3BvbnNlQXJyYXkpO1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmKGluTW9kZWwucnVsZVN0YXR1cyA9PSAnUlVMRV9FUlJPUicpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3J1bGUgZXJyb3IgZnJvbSBzb21ld2hlcmUnKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pLmZhaWwoZnVuY3Rpb24oZXJyb3Ipe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlamVjdCgncHJvY2Vzc0FsbFJ1bGVzIGZhaWwgcHJvbWlzZSBjYXNlIGZhaWxlZCcpO1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRvYy5tb2RlbC5wZW5kaW5nLnN0YXR1cyA9IEVOVFJZX1NUQVRVU19VUERBVEVEO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbmRpY2F0b3JNb2RlbC5kZWZhdWx0TW9kZWwuYXRvbUlkKGRvY3VtZW50SWQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcG9uc2UgPSBnZXRSZXNwb25zZShVUERBVEVEX0NPREUsIFVQREFURURfTkFNRSwnRG9jdW1lbnQgdXBkYXRlZCcsIGZhbHNlLCBkb2MpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcG9uc2VBcnJheSA9IFtyZXNwb25zZV07XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKHJlc3BvbnNlQXJyYXkpO1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgIH0pLmZhaWwoZnVuY3Rpb24oZXJyKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlID0gZ2V0UmVzcG9uc2UoZXJyLnN0YXR1cywgZXJyLm5hbWUsICdjb25maWcgZmlsZSBub3QgZm91bmQuJywgdHJ1ZSwgbnVsbCk7IFxyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZXNwb25zZUFycmF5ID0gW3Jlc3BvbnNlXTtcclxuICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KHJlc3BvbnNlQXJyYXkpO1xyXG5cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgXHJcblxyXG4gICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciByZXNwb25zZSA9IGdldFJlc3BvbnNlKFNFUlZFUl9FUlJPUl9DT0RFLCBTRVJWRVJfRVJST1JfTkFNRSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICdTdGF0dXMgaXMgbm90IGluICcrIEVOVFJZX1NUQVRVU19EQVRBX0lOSVRJQUxJU0VEICsnIG9yICcrIEVOVFJZX1NUQVRVU19VUERBVEVEICsgJyBzdGF0ZS4nLCB0cnVlLCBudWxsICk7XHJcbiAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIHZhciByZXNwb25zZUFycmF5ID0gW3Jlc3BvbnNlXTtcclxuICAgICAgICAgICAgICAgIGRlZi5yZWplY3QocmVzcG9uc2VBcnJheSk7XHJcblxyXG5cclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgfSkuZmFpbChmdW5jdGlvbihlcnIpe1xyXG5cclxuICAgICAgICAgICAgdmFyIHJlc3BvbnNlID0gZ2V0UmVzcG9uc2UoZXJyLnN0YXR1cywgZXJyLm5hbWUsIGVyci5tZXNzYWdlLCB0cnVlLCBudWxsKTsgXHJcbiAgICAgICAgICAgIHZhciByZXNwb25zZUFycmF5ID0gW3Jlc3BvbnNlXTtcclxuICAgICAgICAgICAgZGVmLnJlamVjdChyZXNwb25zZUFycmF5KTtcclxuXHJcblxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIGRlZjtcclxuICAgIH07XHJcblxyXG4vKiogXHJcbiAqIFJlcHJlc2VudHMgdGhlIGF1dGhvcmlzZSAgZnVuY3Rpb24uXHJcbiAqIFVwZHRhdGVzIHRoZSBjdXJyZW50IGRvY3VtZW50IHBlbmRpbmcgd2l0aCBzdGF0dXMgQXV0aG9yaXNlZC5cclxuICogQ29waWVkIHRoZSBkYXRhIHRvIGF1dGhvcmlzZWQgYXJyYXkgb2YgYXV0aG9yaXNlZCBkb2N1bWVudC5cclxuICogQG1ldGhvZFxyXG4gKiBAcGFyYW0ge3N0cmluZ30gZG9jdW1lbnRJZCAtIGRvY3VtZW50IGlkIHdoaWNoIG5lZWRzIHRvIGJlIGluaXRpYWxpc2VkXHJcbiBcclxuICogQGF1dGhvciBIYXNhbiBBYmJhc1xyXG4gKiBAdmVyc2lvbiAxLjAuMFxyXG4gKlxyXG4gKiBAZXhhbXBsZSBcclxuICogdmFyIGdhdGVrZWVwZXIgPSBuZXcgR0soKTtcclxuICogZ2F0ZWtlZWVyLmF1dGhvcmlzZSgnYWJjMTYxJylcclxuICpcclxuICogQHJldHVybiB7T2JqZWN0fSBQcm9taXNlIE9iamVjdCB3aXRoIHJlc3Bvc2UgT2JqZWN0XHJcbiAqXHJcbiAqL1xyXG5cclxuR0sucHJvdG90eXBlLmF1dGhvcmlzZSA9IGZ1bmN0aW9uKGRvY3VtZW50SWQpe1xyXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gICAgdmFyIGRlZiA9IG5ldyAkLkRlZmVycmVkKCk7XHJcbiAgICBpZihkb2N1bWVudElkICE9IG51bGwgJiYgIGRvY3VtZW50SWQgIT0gdW5kZWZpbmVkICYmIGRvY3VtZW50SWQgIT0gJycpe1xyXG5cclxuICAgICAgICBkYW8uZ2V0KGRvY3VtZW50SWQpLmRvbmUoZnVuY3Rpb24oZGF0YSl7XHJcblxyXG5cclxuICAgICAgICAgICAgaWYoZGF0YS5tb2RlbC5wZW5kaW5nLnN0YXR1cyA9PSBFTlRSWV9TVEFUVVNfVVBEQVRFRCl7XHJcblxyXG4gICAgICAgICAgICAgICBcclxuXHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHNldElkID0gZGF0YS5jYXRlZ29yeS50ZXJtO1xyXG4gICAgICAgICAgICAgICAgdmFyIHBhdGggPSBkYXRhLm1vZGVsLnBlbmRpbmc7XHJcbiAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IGV2YWwocGF0aCk7XHJcbiAgICAgICAgICAgICAgICBkYXRhLm1vZGVsLnBlbmRpbmcuc3RhdHVzID0gRU5UUllfU1RBVFVTX0FVVEhPUklTRUQ7XHJcbiAgICAgICAgICAgICAgICBcclxuXHJcbiAgICAgICAgICAgICAgICB2YXIgYXBwcm92ZV9kb2NfaWQgPSBkb2N1bWVudElkKyc6YXBwcm92ZWQnO1xyXG5cclxuICAgICAgICAgICAgICAgIGRhby5nZXQoYXBwcm92ZV9kb2NfaWQpLmRvbmUoZnVuY3Rpb24oYXBwcm92ZURhdGEpe1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIGFwcHJvdmVEYXRhLm1vZGVsLmFwcHJvdmVkLnB1c2goaXRlbSk7XHJcbiAgICAgICAgICAgICAgICAgIFxyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgbWFpblJlcyA9IGdldFJlc3BvbnNlKFVQREFURURfQ09ERSwgVVBEQVRFRF9OQU1FLCdEb2N1bWVudCBNb2RlbCBhcHByb3ZlZCcsIGZhbHNlLCBkYXRhKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFwcHJvdmVSZXMgPSBnZXRSZXNwb25zZShVUERBVEVEX0NPREUsIFVQREFURURfTkFNRSwgJ0FwcHJvdmVkIG1vZGVsIGluY3JlbWVudGVkJywgZmFsc2UsIGFwcHJvdmVEYXRhKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlQXJyYXkgPSBbbWFpblJlcywgYXBwcm92ZVJlc107XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKHJlc3BvbnNlQXJyYXkpOyAgICBcclxuICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIH0pLmZhaWwoZnVuY3Rpb24oZXJyKXtcclxuICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcblxyXG4gICAgICAgICAgICAgXHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlID0gZ2V0UmVzcG9uc2UoQkFEX1JFUVVFU1RfQ09ERSwgQkFEX1JFUVVFU1RfTkFNRSwnU3RhdHVzIG5vdCBpbiB1cGRhdGVkIHN0YXRlJywgdHJ1ZSwgbnVsbCk7IFxyXG4gICAgICAgICAgICAgICAgdmFyIHJlc3BvbnNlQXJyYXkgPSBbcmVzcG9uc2VdO1xyXG4gICAgICAgICAgICAgICAgZGVmLnJlamVjdChyZXNwb25zZUFycmF5KTtcclxuXHJcblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBcclxuXHJcbiAgICAgICAgfSkuZmFpbChmdW5jdGlvbihlcnIpe1xyXG5cclxuICAgICAgICAgICB2YXIgcmVzcG9uc2UgPSBnZXRSZXNwb25zZShlcnIuc3RhdHVzLCBlcnIubmFtZSwgZXJyLm1lc3NhZ2UsIHRydWUsIG51bGwpOyBcclxuICAgICAgICAgICB2YXIgcmVzcG9uc2VBcnJheSA9IFtyZXNwb25zZV07XHJcbiAgICAgICAgICAgZGVmLnJlamVjdChyZXNwb25zZUFycmF5KTtcclxuXHJcblxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH1lbHNle1xyXG5cclxuICAgICAgICB2YXIgcmVzcG9uc2UgPSBnZXRSZXNwb25zZShCQURfUkVRVUVTVF9DT0RFLCBCQURfUkVRVUVTVF9OQU1FLCdEb2N1bWVudCBJRCBpcyBibGFuaycsIHRydWUsIG51bGwpOyBcclxuICAgICAgICB2YXIgcmVzcG9uc2VBcnJheSA9IFtyZXNwb25zZV07XHJcbiAgICAgICAgZGVmLnJlamVjdChyZXNwb25zZUFycmF5KTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGRlZjtcclxuICAgXHJcbn07XHJcblxyXG4vKiogXHJcbiAqIFJlcHJlc2VudHMgdGhlIHJlamVjdCAgZnVuY3Rpb24uXHJcbiAqIFVwZHRhdGVzIHRoZSBjdXJyZW50IGRvY3VtZW50IHBlbmRpbmcgd2l0aCBzdGF0dXMgUmVqZXRjZWQuXHJcbiAqIENvcGllZCB0aGUgZGF0YSB0byBhdXRob3Jpc2VkIGFycmF5IG9mIHJlamVjdGVkIGRvY3VtZW50LlxyXG4gKiBAbWV0aG9kXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBkb2N1bWVudElkIC0gZG9jdW1lbnQgaWQgd2hpY2ggbmVlZHMgdG8gYmUgaW5pdGlhbGlzZWRcclxuIFxyXG4gKiBAYXV0aG9yIEhhc2FuIEFiYmFzXHJcbiAqIEB2ZXJzaW9uIDEuMC4wXHJcbiAqXHJcbiAqIEBleGFtcGxlIFxyXG4gKiB2YXIgZ2F0ZWtlZXBlciA9IG5ldyBHSygpO1xyXG4gKiBnYXRla2VlZXIucmVqZWN0KCdhYmMxNjEnKVxyXG4gKlxyXG4gKiBAcmV0dXJuIHtPYmplY3R9IFByb21pc2UgT2JqZWN0IHdpdGggcmVzcG9zZSBPYmplY3RcclxuICpcclxuICovXHJcblxyXG5HSy5wcm90b3R5cGUucmVqZWN0ID0gZnVuY3Rpb24oZG9jdW1lbnRJZCl7XHJcbiAgICBcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIHZhciBkZWYgPSBuZXcgJC5EZWZlcnJlZCgpO1xyXG4gICAgaWYoZG9jdW1lbnRJZCAhPSBudWxsICYmICBkb2N1bWVudElkICE9IHVuZGVmaW5lZCAmJiBkb2N1bWVudElkICE9ICcnKXtcclxuXHJcbiAgICAgICAgXHJcblxyXG4gICAgICAgIGRhby5nZXQoZG9jdW1lbnRJZCkuZG9uZShmdW5jdGlvbihkYXRhKXtcclxuXHJcbiAgICAgICAgICAgIGlmKGRhdGEubW9kZWwucGVuZGluZy5zdGF0dXMgPT0gRU5UUllfU1RBVFVTX1VQREFURUQpe1xyXG5cclxuICAgICAgICAgICAgICAgXHJcblxyXG5cclxuICAgICAgICAgICAgICAgIHZhciBzZXRJZCA9IGRhdGEuY2F0ZWdvcnkudGVybTtcclxuICAgICAgICAgICAgICAgIHZhciBpdGVtID0gZXZhbCgnZGF0YS5tb2RlbC5wZW5kaW5nLmRhdGEnK3NldElkKTtcclxuXHJcbiAgICAgICAgICAgICAgICBkYXRhLm1vZGVsLnBlbmRpbmcuc3RhdHVzID0gRU5UUllfU1RBVFVTX1JFSkVDVEVEO1xyXG4gICAgICAgICAgICAgICAgXHJcblxyXG4gICAgICAgICAgICAgICAgdmFyIHJlamVjdGVkX2RvY19pZCA9IGRvY3VtZW50SWQrJzpyZWplY3RlZCc7XHJcblxyXG4gICAgICAgICAgICAgICAgZGFvLmdldChyZWplY3RlZF9kb2NfaWQpLmRvbmUoZnVuY3Rpb24ocmVqZWN0ZWREYXRhKXtcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICByZWplY3RlZERhdGEubW9kZWwucmVqZWN0ZWQucHVzaChpdGVtKTtcclxuICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIHZhciBtYWluUmVzID0gZ2V0UmVzcG9uc2UoVVBEQVRFRF9DT0RFLCBVUERBVEVEX05BTUUsJ0RvY3VtZW50IE1vZGVsIGFwcHJvdmVkJywgZmFsc2UsIGRhdGEpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVqUmVzID0gZ2V0UmVzcG9uc2UoVVBEQVRFRF9DT0RFLCBVUERBVEVEX05BTUUsICdSZWpldGNlZCBtb2RlbCBpbmNyZW1lbnRlZCcsIGZhbHNlLCByZWplY3RlZERhdGEpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICB2YXIgcmVzcG9uc2VBcnJheSA9IFttYWluUmVzLCByZWpSZXNdO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBkZWYucmVzb2x2ZShyZXNwb25zZUFycmF5KTsgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICB9KS5mYWlsKGZ1bmN0aW9uKGVycil7XHJcbiAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG5cclxuICAgICAgICAgICAgICAgIHZhciByZXNwb25zZSA9IGdldFJlc3BvbnNlKEJBRF9SRVFVRVNUX0NPREUsIEJBRF9SRVFVRVNUX05BTUUsJ1N0YXR1cyBub3QgaW4gdXBkYXRlZCBzdGF0ZScsIHRydWUsIG51bGwpOyBcclxuICAgICAgICAgICAgICAgIHZhciByZXNwb25zZUFycmF5ID0gW3Jlc3BvbnNlXTtcclxuICAgICAgICAgICAgICAgIGRlZi5yZWplY3QocmVzcG9uc2VBcnJheSk7XHJcblxyXG5cclxuXHJcblxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBcclxuXHJcbiAgICAgICAgfSkuZmFpbChmdW5jdGlvbihlcnIpe1xyXG5cclxuICAgICAgICAgICAgIHZhciByZXNwb25zZSA9IGdldFJlc3BvbnNlKGVyci5zdGF0dXMsIGVyci5uYW1lLCBlcnIubWVzc2FnZSwgdHJ1ZSwgbnVsbCk7IFxyXG4gICAgICAgICAgIHZhciByZXNwb25zZUFycmF5ID0gW3Jlc3BvbnNlXTtcclxuICAgICAgICAgICBkZWYucmVqZWN0KHJlc3BvbnNlQXJyYXkpO1xyXG5cclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9ZWxzZXtcclxuXHJcbiAgICAgICB2YXIgcmVzcG9uc2UgPSBnZXRSZXNwb25zZShCQURfUkVRVUVTVF9DT0RFLCBCQURfUkVRVUVTVF9OQU1FLCdEb2N1bWVudCBJRCBpcyBibGFuaycsdHJ1ZSxudWxsICkgXHJcbiAgICAgICB2YXIgcmVzcG9uc2VBcnJheSA9IFtyZXNwb25zZV07XHJcbiAgICAgICBkZWYucmVqZWN0KHJlc3BvbnNlQXJyYXkpO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4gZGVmO1xyXG5cclxufTtcclxuXHJcbnZhciBwcm9jZXNzSW5pdGlhbGlzZVJ1bGUgPSBmdW5jdGlvbihkb2N1bWVudElkLCBydWxlT2JqLCBpbmRpY2F0b3JNb2RlbCl7XHJcbiAgICBcclxufTtcclxuXHJcbnZhciBwcm9jZXNzVW5pcXVlUnVsZSA9IGZ1bmN0aW9uKGRvY3VtZW50SWQsIHJ1bGVPYmosIGluZGljYXRvck1vZGVsKXtcclxuXHJcbn07XHJcblxyXG5HSy5wcm90b3R5cGUudW5sb2NrID0gZnVuY3Rpb24odmFsKXtcclxuICAgIHZhciBzZWxmID0gdGhpcztcclxuICAgIC8vIFVzZSB0aGUgbmF0aXZlIFByb21pc2UgY29uc3RydWN0b3JcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcclxuICAgIFxyXG4gICAgICBcclxuXHJcbiAgICB9KTtcclxufTtcclxuXHJcbkdLLnByb3RvdHlwZS5wZXJzaXN0ID0gZnVuY3Rpb24obW9kZWxBcnJheSl7XHJcbiAgICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgICB2YXIgZGVmID0gbmV3ICQuRGVmZXJyZWQoKTtcclxuXHJcbiAgICBmb3IgKHZhciBpPTA7IGkgPCBtb2RlbEFycmF5Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgZGFvLnNhdmUobW9kZWxBcnJheVtpXS5tb2RlbCkuZG9uZShmdW5jdGlvbihkYXRhKXtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgfSkuZmFpbChmdW5jdGlvbihlcnIpe1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9ICAgXHJcbn07XHJcblxyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBHSzsiLCJcclxudmFyIGdsb2JhbHVybCA9ICcnO1xyXG52YXIgbWFzdGVyREI7XHJcbnZhciBsb2NhbERCO1xyXG52YXIgdGF4b25vbXlEQjtcclxudmFyIGF1dGhlbnRpY2F0ZWRUb1N5bmNHYXRld2F5ID0gZmFsc2U7XHJcblxyXG5cclxuLy8gRGF0YSBBY2Nlc3MgT2JqZWN0IC8gTW9kdWxlXHJcbnZhciBkYW8gPSAoZnVuY3Rpb24oKXtcclxuICBcclxuXHJcbiAgLy9EQk5BTUUgKyBEQl9JREVOVElGSUVSIGlzIGxvY2FsIGRhdGFiYXNlIG5hbWUsIGRvIG5vdCBnZXQgY29uZnVzZWQgd2l0aCBCVUNLRVRcclxuICBcclxuICByZXR1cm4ge1xyXG5cclxuICAgIC8vIEdldCBhIGRvY3VtZW50IGZyb20gdGhlIGRhdGFiYXNlc1xyXG4gICAgYXV0aGVudGljYXRlVG9TeW5jR2F0ZXdheTogZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKXtcclxuICAgICAgLy9hbGVydCgnVGVzdCcrdXNlcm5hbWUgKyBwYXNzd29yZCk7XHJcbiAgICAgIHZhciBkZmQgPSBuZXcgJC5EZWZlcnJlZCgpO1xyXG5cclxuXHJcbiAgICAgIHZhciB1cmwgPSAnaHR0cDovLycgKyBDT1VDSEJBU0VfU0VSVkVSICsgJy8nICsgVEFYT05PTVlfQlVDS0VUICsgXCIvX3Nlc3Npb25cIjtcclxuICAgICAgdmFyIG1ldGhvZCA9IFwiUE9TVFwiO1xyXG4gICAgICB2YXIgcG9zdERhdGEgPSBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgXCJuYW1lXCI6IHVzZXJuYW1lLCBcInBhc3N3b3JkXCI6IHBhc3N3b3JkXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgdmFyIGFzeW5jID0gdHJ1ZTtcclxuXHJcbiAgICAgIHZhciByZXF1ZXN0ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XHJcbiAgICAgIHJlcXVlc3Qud2l0aENyZWRlbnRpYWxzID0gdHJ1ZTtcclxuXHJcbiAgICAgIHJlcXVlc3Qub25sb2FkID0gZnVuY3Rpb24gKCkge1xyXG5cclxuICAgICAgIHZhciBzdGF0dXMgPSByZXF1ZXN0LnN0YXR1czsgXHJcbiAgICAgICB2YXIgZGF0YSA9IHJlcXVlc3QucmVzcG9uc2VUZXh0OyBcclxuICAgICAgIFxyXG4gICAgIH1cclxuXHJcbiAgICAgcmVxdWVzdC5vcGVuKG1ldGhvZCwgdXJsLCBhc3luYyk7XHJcblxyXG4gICAgIHJlcXVlc3Quc2V0UmVxdWVzdEhlYWRlcihcIkNvbnRlbnQtVHlwZVwiLCBcImFwcGxpY2F0aW9uL2pzb247Y2hhcnNldD1VVEYtOFwiKTtcclxuXHJcbiAgICAgcmVxdWVzdC5zZW5kKHBvc3REYXRhKTtcclxuXHJcblxyXG5cclxuXHJcbiAgICAgdmFyIHVybCA9ICdodHRwOi8vJyArIENPVUNIQkFTRV9TRVJWRVIgKyAnLycgKyBDT1VDSEJBU0VfQlVDS0VUICsgXCIvX3Nlc3Npb25cIjtcclxuICAgICB2YXIgbWV0aG9kID0gXCJQT1NUXCI7XHJcbiAgICAgdmFyIHBvc3REYXRhID0gSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICBcIm5hbWVcIjogdXNlcm5hbWUsIFwicGFzc3dvcmRcIjogcGFzc3dvcmRcclxuICAgIH0pO1xyXG5cclxuICAgICB2YXIgYXN5bmMgPSB0cnVlO1xyXG5cclxuICAgICB2YXIgcmVxdWVzdCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xyXG4gICAgIHJlcXVlc3Qud2l0aENyZWRlbnRpYWxzID0gdHJ1ZTtcclxuXHJcbiAgICAgcmVxdWVzdC5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XHJcblxyXG4gICAgICAgdmFyIHN0YXR1cyA9IHJlcXVlc3Quc3RhdHVzOyBcclxuICAgICAgIHZhciBkYXRhID0gcmVxdWVzdC5yZXNwb25zZVRleHQ7IFxyXG4gICAgICAgaWYoc3RhdHVzID09IDIwMClcclxuICAgICAgIHtcclxuICAgICAgICBhdXRoZW50aWNhdGVkVG9TeW5jR2F0ZXdheSA9IHRydWU7XHJcbiAgICAgICAgZGZkLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZVxyXG4gICAgICB7XHJcbiAgICAgICAgZGZkLnJlamVjdChkYXRhKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHJlcXVlc3Qub3BlbihtZXRob2QsIHVybCwgYXN5bmMpO1xyXG5cclxuICAgIHJlcXVlc3Quc2V0UmVxdWVzdEhlYWRlcihcIkNvbnRlbnQtVHlwZVwiLCBcImFwcGxpY2F0aW9uL2pzb247Y2hhcnNldD1VVEYtOFwiKTtcclxuXHJcbiAgICByZXF1ZXN0LnNlbmQocG9zdERhdGEpO1xyXG5cclxuICAgIHJldHVybiBkZmQucHJvbWlzZSgpO1xyXG5cclxuICB9LFxyXG5cclxuICBnZXQ6IGZ1bmN0aW9uKGRvY0lkKXtcclxuICAgIFxyXG4gICAgdmFyIGRmZCA9IG5ldyAkLkRlZmVycmVkKCk7XHJcbiAgICB0cnl7XHJcbiAgICAgICAvL2NvbnNvbGUubG9nKFwiRmV0Y2hpbmcgb2JqZWN0ID09IFwiK2RvY0lkKTtcclxuICAgICAgIFxyXG4gICAgICAgaWYgKGhlYWQubW9iaWxlICYmIGlzQ29yZG92YUFwcCkge1xyXG5cclxuXHJcbiAgICAgICAgY29yZG92YS5leGVjKGZ1bmN0aW9uKGRhdGEpe1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBkZmQucmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgIFxyXG4gICAgICAgIH0sIGZ1bmN0aW9uKGUpe1xyXG4gICAgICAgICAgZGZkLnJlamVjdChlKVxyXG4gICAgICAgIH0sICdDQkxpdGUnLCAnZ2V0RG9jdW1lbnQnLFxyXG4gICAgICAgIFt7XCJkYm5hbWVcIjogREJOQU1FICsgREJfSURFTlRJRklFUiwgXCJkb2NJZFwiOiBkb2NJZH1dXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgXHJcbiAgICAgICBsb2NhbERCLmdldChkb2NJZClcclxuICAgICAgIC50aGVuKGZ1bmN0aW9uKGRhdGEpe1xyXG4gICAgICAgIGRmZC5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpeyBcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkRlc2t0b3AgLSBlcnJvciBpbiBnZXR0aW5nIGRvY3VtZW50IHdpdGggaWQ6IFwiICsgZG9jSWQgKyBcIi4gRXJyb3Igc3RhY2t0cmFjZTogXCIgKyBlcnIpO1xyXG4gICAgICAgIGRmZC5yZWplY3QoZXJyKTtcclxuICAgICAgICByZXR1cm4gZXJyO1xyXG4gICAgICB9KTtcclxuICAgICAgXHJcbiAgICB9XHJcbiAgfWNhdGNoKGUpXHJcbiAge1xyXG4gICAgZGZkLnJlamVjdChlKTtcclxuICB9XHJcbiAgcmV0dXJuIGRmZC5wcm9taXNlKCk7XHJcbn0sXHJcblxyXG5nZXRUYXhvbm9teTogZnVuY3Rpb24oZG9jSWQpe1xyXG4gIFxyXG4gIHZhciBkZmQgPSBuZXcgJC5EZWZlcnJlZCgpO1xyXG4gIFxyXG4gICAgICAgLy9jb25zb2xlLmxvZyhcIkZldGNoaW5nIG9iamVjdCA9PSBcIitkb2NJZCk7XHJcbiAgICAgICBcclxuICAgICAgIGlmIChoZWFkLm1vYmlsZSAmJiBpc0NvcmRvdmFBcHApIHtcclxuXHJcbiAgICAgICAgY29yZG92YS5leGVjKGZ1bmN0aW9uKGRhdGEpe1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBkZmQucmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgIFxyXG4gICAgICAgIH0sIGZ1bmN0aW9uKGUpe1xyXG4gICAgICAgICAgZGZkLnJlamVjdChlKVxyXG4gICAgICAgIH0sICdDQkxpdGUnLCAnZ2V0RG9jdW1lbnQnLFxyXG4gICAgICAgIFt7XCJkYm5hbWVcIjogVEFYT05PTVlfREJOQU1FICsgREJfSURFTlRJRklFUiwgXCJkb2NJZFwiOiBkb2NJZH1dXHJcbiAgICAgICAgKTtcclxuICAgICAgICBcclxuICAgICAgICBcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBcclxuICAgICAgIHRheG9ub215REIuZ2V0KGRvY0lkKVxyXG4gICAgICAgLnRoZW4oZnVuY3Rpb24oZGF0YSl7XHJcbiAgICAgICAgZGZkLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycil7IFxyXG4gICAgICAgIGNvbnNvbGUubG9nKFwiRGVza3RvcCAtIGVycm9yIGluIGdldHRpbmcgdGF4b25vbXkgd2l0aCBpZDogXCIgKyBkb2NJZCArIFwiLiBFcnJvciBzdGFja3RyYWNlOiBcIiArIGVycik7XHJcbiAgICAgICAgZGZkLnJlamVjdChlcnIpO1xyXG4gICAgICAgIHJldHVybiBlcnI7XHJcbiAgICAgIH0pO1xyXG4gICAgICBcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIGRmZC5wcm9taXNlKCk7XHJcbiAgfSxcclxuICBcclxuICAgIC8vU2F2ZSB0aGUgZG9jdW1lbnQgaW50byB0aGUgZGF0YWJhc2VcclxuICAgIHNhdmU6IGZ1bmN0aW9uKGRvYyl7XHJcbiAgICAgIC8vIGNvbnNvbGUubG9nKFwiU2F2aW5nID09IFwiK2RvYy5faWQpO1xyXG4gICAgICB2YXIgZGZkID0gbmV3ICQuRGVmZXJyZWQoKTtcclxuICAgICAgXHJcbiAgICAgIGlmIChoZWFkLm1vYmlsZSAmJiBpc0NvcmRvdmFBcHApIHtcclxuXHJcbiAgICAgICAgaWYoZG9jLl9pZC5pbmRleE9mKCdfZGVzaWduJykgIT0gMClcclxuICAgICAgICB7XHJcbiAgICAgICAgICBjb3Jkb3ZhLmV4ZWMoZnVuY3Rpb24oZGF0YSl7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBkZmQucmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICB9LCBmdW5jdGlvbihlKXtcclxuICAgICAgICAgICAgZGZkLnJlamVjdChlKVxyXG4gICAgICAgICAgfSwgJ0NCTGl0ZScsICdzYXZlRG9jdW1lbnQnLFxyXG4gICAgICAgICAgW3tcImRibmFtZVwiOiBEQk5BTUUgKyBEQl9JREVOVElGSUVSLCBcImRvY0lkXCI6IGRvYy5faWQsIFwiZG9jXCI6ZG9jfV1cclxuICAgICAgICAgICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2VcclxuICAgICAgICB7XHJcblxyXG4gICAgICAgICAgdmFyIG9wdGlvbnMgPSB7XHJcbiAgICAgICAgICAgIHVybDogZ2xvYmFsdXJsICsgREJOQU1FICsgREJfSURFTlRJRklFUiArIFwiL1wiICsgZG9jLl9pZCxcclxuICAgICAgICAgICAgdHlwZTogXCJQVVRcIixcclxuICAgICAgICAgICAgZGF0YTogIEpTT04uc3RyaW5naWZ5KGRvYyksXHJcbiAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcclxuICAgICAgICAgICAgY29udGVudFR5cGU6IFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAkLmFqYXgob3B0aW9ucylcclxuICAgICAgICAgIC5kb25lKGZ1bmN0aW9uKGRhdGEsIHRleHRTdGF0dXMsIHhocil7XHJcbiAgICAgICAgICAgIGRmZC5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKHhociwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24pe1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIk1vYmlsZSAtIGVycm9yIGluIHNhdmluZyBkb2N1bWVudCB3aXRoIGlkOiBcIiArIGRvYy5faWQgKyBcIi4gVVJMOiBcIiArIGdsb2JhbHVybCArIERCTkFNRSArIERCX0lERU5USUZJRVIgKyBcIiBFcnJvciBzdGFja3RyYWNlOiBcIiArIEpTT04uc3RyaW5naWZ5KHhocikpO1xyXG4gICAgICAgICAgICBkZmQucmVqZWN0KHhoci5yZXNwb25zZVRleHQpO1xyXG4gICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgXHJcbiAgICAgICAgXHJcbiAgICAgICAgXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbG9jYWxEQi5wdXQoZG9jKVxyXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKGRhdGEpe1xyXG4gICAgICAgICAgZGZkLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKXsgXHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIkRlc2t0b3AgLSBlcnJvciBpbiBzYXZpbmcgZG9jdW1lbnQgd2l0aCBpZDogXCIgKyBkb2MuX2lkICsgXCIuIEVycm9yIHN0YWNrdHJhY2U6IFwiICsgZXJyKTtcclxuICAgICAgICAgIGRmZC5yZWplY3QoZXJyKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgcmV0dXJuIGRmZC5wcm9taXNlKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIHNhdmVBdHRhY2htZW50IDpmdW5jdGlvbihkb2NJZCwgcmV2SWQsIGF0dGFjaGVtbnQsIG1pbWVUeXBlLCBhdHRhY2hlbW50TmFtZSl7XHJcbiAgICAgIHZhciBkZmQgPSBuZXcgJC5EZWZlcnJlZCgpO1xyXG4gICAgICBcclxuICAgICAgaWYgKGhlYWQubW9iaWxlICYmIGlzQ29yZG92YUFwcCkge1xyXG5cclxuICAgICAgICBibG9iVXRpbC5iYXNlNjRTdHJpbmdUb0Jsb2IoYXR0YWNoZW1udCwgbWltZVR5cGUpLnRoZW4oZnVuY3Rpb24gKGJsb2IpIHtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgdmFyIG9SZXEgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuXHJcbiAgICAgICAgICBvUmVxLm9wZW4oXCJQVVRcIiwgZ2xvYmFsdXJsICsgREJOQU1FICsgREJfSURFTlRJRklFUiArIFwiL1wiICsgZG9jSWQgKyBcIi9cIiArIGF0dGFjaGVtbnROYW1lICsgXCI/cmV2PVwiICsgcmV2SWQsIHRydWUpO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBvUmVxLm9ubG9hZCA9IGZ1bmN0aW9uIChvRXZlbnQpIHtcclxuXHJcbiAgICAgICAgICAgIGRmZC5yZXNvbHZlKEpTT04ucGFyc2Uob1JlcS5yZXNwb25zZVRleHQpKTtcclxuICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBvUmVxLnNlbmQoYmxvYik7XHJcblxyXG5cclxuICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgZGZkLnJlamVjdCh4aHIucmVzcG9uc2VUZXh0KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICBcclxuXHJcblxyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIFBlcmZvcm0gb3BlcmF0aW9uIG9uIHRoZSBQb3VjaERCIGRhdGFiYXNlXHJcbiAgICAgICAgXHJcbiAgICAgICAgbG9jYWxEQi5wdXRBdHRhY2htZW50KGRvY0lkLCBhdHRhY2hlbW50TmFtZSwgcmV2SWQsIGF0dGFjaGVtbnQsIG1pbWVUeXBlKVxyXG4gICAgICAgIC50aGVuKGZ1bmN0aW9uKGRhdGEpe1xyXG4gICAgICAgICAgZGZkLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKXsgXHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIkRlc2t0b3AgLWVycm9yIGluIHNhdmluZyBhdHRhY2htZW50IHRvIHRoZSBkb2N1bWVudCB3aXRoIGlkOiBcIiArIGRvY0lkICsgXCIuIEVycm9yIHN0YWNrdHJhY2U6IFwiICsgZXJyKTtcclxuICAgICAgICAgIGRmZC5yZWplY3QoZXJyKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICBcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gZGZkLnByb21pc2UoKTtcclxuICAgIH0sXHJcbiAgICBcclxuICAgIGdldEF0dGFjaG1lbnQgOmZ1bmN0aW9uKGRvY0lkLCByZXZJZCwgYXR0YWNoZW1udE5hbWUpe1xyXG5cclxuICAgICAgdmFyIGRmZCA9IG5ldyAkLkRlZmVycmVkKCk7XHJcblxyXG4gICAgICBpZiAoaGVhZC5tb2JpbGUgJiYgaXNDb3Jkb3ZhQXBwKSB7XHJcbiAgICAgICAgLy8gUGVyZm9ybSBvcGVyYXRpb24gb24gdGhlIENvdWNoYmFzZSBMaXRlIGRhdGFiYXNlXHJcblxyXG4gICAgICAgIHZhciB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuICAgICAgICB4aHIub3BlbignR0VUJywgZ2xvYmFsdXJsICsgREJOQU1FICsgREJfSURFTlRJRklFUiArIFwiL1wiICsgZG9jSWQgKyBcIi9cIiArIGF0dGFjaGVtbnROYW1lLCB0cnVlKTtcclxuICAgICAgICB4aHIucmVzcG9uc2VUeXBlID0gJ2Jsb2InO1xyXG5cclxuICAgICAgICB4aHIub25sb2FkID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgaWYgKHRoaXMuc3RhdHVzID09IDIwMCkge1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdmFyIGJsb2IgPSB4aHIucmVzcG9uc2U7XHJcblxyXG4gICAgICAgICAgICBibG9iVXRpbC5ibG9iVG9CYXNlNjRTdHJpbmcoYmxvYikudGhlbihmdW5jdGlvbiAoYmFzZTY0U3RyaW5nKSB7XHJcblxyXG4gICAgICAgICAgICAgIGRmZC5yZXNvbHZlKGJhc2U2NFN0cmluZyk7XHJcblxyXG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XHJcblxyXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiTW9iaWxlIC0gZXJyb3IgaW4gZ2V0dGluZyBhdHRhY2htZW50IHRvIHRoZSBkb2N1bWVudCB3aXRoIGlkOiBcIiArIGRvY0lkICsgXCIuIEVycm9yIHN0YWNrdHJhY2U6IFwiICsgZXJyKTtcclxuICAgICAgICAgICAgICBkZmQucmVqZWN0KHhocik7XHJcblxyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBlbHNle1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIk1vYmlsZSAtIGVycm9yIGluIGdldHRpbmcgYXR0YWNobWVudCB0byB0aGUgZG9jdW1lbnQgd2l0aCBpZDogXCIgKyBkb2NJZCk7XHJcbiAgICAgICAgICAgIGRmZC5yZWplY3QoeGhyKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB4aHIuc2VuZCgpO1xyXG5cclxuICAgICAgICBcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBQZXJmb3JtIG9wZXJhdGlvbiBvbiB0aGUgUG91Y2hEQiBkYXRhYmFzZVxyXG4gICAgICAgIGxvY2FsREIuZ2V0QXR0YWNobWVudChkb2NJZCwgYXR0YWNoZW1udE5hbWUpXHJcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24gKGJsb2JPckJ1ZmZlcikge1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgIGJsb2JVdGlsLmJsb2JUb0Jhc2U2NFN0cmluZyhibG9iT3JCdWZmZXIpLnRoZW4oZnVuY3Rpb24gKGJpbmFyeVN0cmluZykge1xyXG4gICAgICAgICAgZGZkLnJlc29sdmUoYmluYXJ5U3RyaW5nKTtcclxuICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgIGRmZC5yZWplY3QoZXJyKTtcclxuICAgICAgIH0pO1xyXG5cclxuICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgY29uc29sZS5sb2coXCJEZXNrdG9wIC1lcnJvciBpbiBnZXR0aW5nIGF0dGFjaG1lbnQgdG8gdGhlIGRvY3VtZW50IHdpdGggaWQ6IFwiICsgZG9jSWQgKyBcIi4gRXJyb3Igc3RhY2t0cmFjZTogXCIgKyBlcnIpO1xyXG4gICAgICAgZGZkLnJlamVjdChlcnIpO1xyXG4gICAgIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIGRmZC5wcm9taXNlKCk7IFxyXG4gIH0sXHJcbiAgXHJcbiAgZGVsZXRlQXR0YWNobWVudCA6ZnVuY3Rpb24oZG9jSWQsIHJldklkLCBhdHRhY2hlbW50TmFtZSl7XHJcbiAgIHZhciBkZmQgPSBuZXcgJC5EZWZlcnJlZCgpO1xyXG4gICBpZiAoaGVhZC5tb2JpbGUgJiYgaXNDb3Jkb3ZhQXBwKSB7XHJcbiAgICAgICAgLy8gUGVyZm9ybSBvcGVyYXRpb24gb24gdGhlIENvdWNoYmFzZSBMaXRlIGRhdGFiYXNlXHJcbiAgICAgICAgdmFyIG9wdGlvbnMgPSB7XHJcbiAgICAgICAgICB1cmw6IGdsb2JhbHVybCArIERCTkFNRSArIERCX0lERU5USUZJRVIgKyBcIi9cIiArIGRvY0lkICsgXCIvXCIgKyBhdHRhY2hlbW50TmFtZSArIFwiP3Jldj1cIiArIHJldklkLFxyXG4gICAgICAgICAgdHlwZTogXCJERUxFVEVcIixcclxuICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25cIlxyXG4gICAgICAgIH07XHJcbiAgICAgICAgXHJcbiAgICAgICAgJC5hamF4KG9wdGlvbnMpXHJcbiAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSwgdGV4dFN0YXR1cywgeGhyKXtcclxuICAgICAgICAgIGRmZC5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgLmZhaWwoZnVuY3Rpb24oeGhyLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93bil7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhcIk1vYmlsZSAtIGVycm9yIGluIGRlbGV0aW5nIGF0dGFjaG1lbnQgdG8gdGhlIGRvY3VtZW50IHdpdGggaWQ6IFwiICsgZG9jSWQgKyBcIi4gRXJyb3Igc3RhY2t0cmFjZTogXCIgKyBKU09OLnN0cmluZ2lmeSh4aHIpKTtcclxuICAgICAgICAgIGRmZC5yZWplY3QoeGhyLnJlc3BvbnNlVGV4dCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAvLyBDaGVjayBpZiB0aGUgZGF0YSBleGlzdHMgaW4gdGhlIGxvY2FsIFBvdWNoREJcclxuICAgICAgICAgIGxvY2FsREIucmVtb3ZlQXR0YWNobWVudChkb2NJZCwgYXR0YWNoZW1udE5hbWUsIHJldklkKVxyXG4gICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICBkZmQucmVzb2x2ZShyZXN1bHQpO1xyXG4gICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkRlc2t0b3AgLSBlcnJvciBpbiBkZWxldGluZyBhdHRhY2htZW50IHRvIHRoZSBkb2N1bWVudCB3aXRoIGlkOiBcIiArIGRvY0lkICsgXCIuIEVycm9yIHN0YWNrdHJhY2U6IFwiICsgSlNPTi5zdHJpbmdpZnkoeGhyKSk7XHJcbiAgICAgICAgICAgIGRmZC5yZWplY3QoZXJyKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZGZkLnByb21pc2UoKTtcclxuICAgICAgfSxcclxuICAgICAgXHJcbiAgICAgIHVwc2VydDogZnVuY3Rpb24oZG9jdW1lbnQpeyBcclxuXHJcbiAgICAgICAgdmFyIGRmZCA9IG5ldyAkLkRlZmVycmVkKCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdmFyIHNDQiA9IGZ1bmN0aW9uKGRvYyl7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGRvY3VtZW50Ll9yZXYgPSBkb2MuX3JldjtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgZGFvLnNhdmUoZG9jdW1lbnQpXHJcbiAgICAgICAgICAuZG9uZShmdW5jdGlvbihzKXtkZmQucmVzb2x2ZShzKX0pXHJcbiAgICAgICAgICAuZmFpbChmdW5jdGlvbihlKXtkZmQucmVqZWN0KGUpfSk7XHJcbiAgICAgICAgICBcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgdmFyIGVDQiA9IGZ1bmN0aW9uKGVycil7IFxyXG4gICAgICAgICAgZGFvLnNhdmUoZG9jdW1lbnQpXHJcbiAgICAgICAgICAuZG9uZShmdW5jdGlvbihzKXtjb25zb2xlLmxvZyhzKTtkZmQucmVzb2x2ZShzKTt9KVxyXG4gICAgICAgICAgLmZhaWwoZnVuY3Rpb24oZSl7ZGZkLnJlamVjdChlKX0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBkYW8uZ2V0KGRvY3VtZW50Ll9pZClcclxuICAgICAgICAuZG9uZShzQ0IpXHJcbiAgICAgICAgLmZhaWwoZUNCKTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gZGZkLnByb21pc2UoKTsgXHJcbiAgICAgIH0sXHJcbiAgICAgIFxyXG4gICAgICBzdGFydFB1bGw6IGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgIHZhciBkZmQgPSBuZXcgJC5EZWZlcnJlZCgpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciBzeW5jVXNlcm5hbWUgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnN5bmNVc2VybmFtZTtcclxuICAgICAgICB2YXIgc3luY1Bhc3N3b3JkID0gTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy5zeW5jUGFzc3dvcmQ7XHJcblxyXG4gICAgICAgIGlmIChoZWFkLm1vYmlsZSAmJiBpc0NvcmRvdmFBcHApIHtcclxuXHJcbiAgICAgICAgICBjb3Jkb3ZhLmV4ZWMoXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uKHMpe1NZTkNfU0VRID0gczsgZGZkLnJlc29sdmUocyl9LFxyXG4gICAgICAgICAgICBmdW5jdGlvbihlKXtkZmQucmVqZWN0KGUpfSxcclxuICAgICAgICAgICAgJ0NCTGl0ZScsXHJcbiAgICAgICAgICAgICdwdWxsJyxcclxuICAgICAgICAgICAgW3tcImRibmFtZVwiOiBEQk5BTUUgKyBEQl9JREVOVElGSUVSLCBcInVybFwiOidodHRwOi8vJytzeW5jVXNlcm5hbWUrJzonK3N5bmNQYXNzd29yZCsnQCcrQ09VQ0hCQVNFX1NFUlZFUiArICcvJyArIENPVUNIQkFTRV9CVUNLRVR9XVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2V7XHJcblxyXG5cclxuICAgICAgICAgIGlmKGF1dGhlbnRpY2F0ZWRUb1N5bmNHYXRld2F5ID09IGZhbHNlKVxyXG4gICAgICAgICAge1xyXG5cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGRhby5hdXRoZW50aWNhdGVUb1N5bmNHYXRld2F5KHN5bmNVc2VybmFtZSwgc3luY1Bhc3N3b3JkKVxyXG4gICAgICAgICAgICAuZG9uZShcclxuICAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKVxyXG4gICAgICAgICAgICAge1xyXG5cclxuICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgbG9jYWxEQi5yZXBsaWNhdGUuZnJvbShuZXcgUG91Y2hEQignaHR0cDovLycgKyBDT1VDSEJBU0VfU0VSVkVSICsgJy8nICsgQ09VQ0hCQVNFX0JVQ0tFVCwgXHJcbiAgICAgICAgICAgICAgIHsgXHJcbiAgICAgICAgICAgICAgICBhamF4OiB7IFxyXG4gICAgICAgICAgICAgICAgICB0aW1lb3V0OiA2MDAwMFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgIH0pLCBcclxuICAgICAgICAgICAgICAgeyBcclxuICAgICAgICAgICAgICAgIGxpdmU6IGZhbHNlLCBcclxuICAgICAgICAgICAgICAgIHJldHJ5OiB0cnVlLCBcclxuICAgICAgICAgICAgICAgIHRpbWVvdXQ6IDYwMDAwIFxyXG4gICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9TWU5DX1NFUSA9IFwiXCIrcmVzdWx0LmNoYW5nZS5sYXN0X3NlcTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGZkLnJlc29sdmUoXCJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRmZC5yZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICApLmZhaWwoIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGVycil7ZGZkLnJlamVjdChlcnIpO31cclxuICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2V7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxEQi5yZXBsaWNhdGUuZnJvbShuZXcgUG91Y2hEQignaHR0cDovLycgKyBDT1VDSEJBU0VfU0VSVkVSICsgJy8nICsgQ09VQ0hCQVNFX0JVQ0tFVCwgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICB7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGFqYXg6IHsgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lb3V0OiA2MDAwMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSksIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgeyBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBsaXZlOiBmYWxzZSwgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0cnk6IHRydWUsIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVvdXQ6IDYwMDAwIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgICAvL1NZTkNfU0VRID0gXCJcIityZXN1bHQuY2hhbmdlLmxhc3Rfc2VxO1xyXG4gICAgICAgICAgICAgICAgICBkZmQucmVzb2x2ZShcIlwiKTtcclxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgICAgICAgZGZkLnJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcmV0dXJuIGRmZC5wcm9taXNlKCk7IFxyXG4gICAgICAgICAgfSxcclxuXHJcbiAgICAgICAgICBwdWxsVGF4b25vbWllczogZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgICAgICAgIHZhciBkZmQgPSBuZXcgJC5EZWZlcnJlZCgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgdmFyIHN5bmNVc2VybmFtZSA9IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMuc3luY1VzZXJuYW1lO1xyXG4gICAgICAgICAgICB2YXIgc3luY1Bhc3N3b3JkID0gTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy5zeW5jUGFzc3dvcmQ7XHJcblxyXG4gICAgICAgICAgICBpZiAoaGVhZC5tb2JpbGUgJiYgaXNDb3Jkb3ZhQXBwKSB7XHJcblxyXG4gICAgICAgICAgICAgIGNvcmRvdmEuZXhlYyhcclxuICAgICAgICAgICAgICAgZnVuY3Rpb24ocyl7ZGZkLnJlc29sdmUocyl9LFxyXG4gICAgICAgICAgICAgICBmdW5jdGlvbihlKXtkZmQucmVqZWN0KGUpfSxcclxuICAgICAgICAgICAgICAgJ0NCTGl0ZScsXHJcbiAgICAgICAgICAgICAgICdwdWxsJyxcclxuICAgICAgICAgICAgICAgW3tcImRibmFtZVwiOiBUQVhPTk9NWV9EQk5BTUUgKyBEQl9JREVOVElGSUVSLCBcInVybFwiOidodHRwOi8vJytzeW5jVXNlcm5hbWUrJzonK3N5bmNQYXNzd29yZCsnQCcrQ09VQ0hCQVNFX1NFUlZFUiArICcvJyArIFRBWE9OT01ZX0JVQ0tFVH1dXHJcbiAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZXtcclxuXHJcblxyXG4gICAgICAgICAgICAgIGlmKGF1dGhlbnRpY2F0ZWRUb1N5bmNHYXRld2F5ID09IGZhbHNlKVxyXG4gICAgICAgICAgICAgIHtcclxuXHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGRhby5hdXRoZW50aWNhdGVUb1N5bmNHYXRld2F5KHN5bmNVc2VybmFtZSwgc3luY1Bhc3N3b3JkKVxyXG4gICAgICAgICAgICAgICAgLmRvbmUoXHJcbiAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKGRhdGEpXHJcbiAgICAgICAgICAgICAgICAge1xyXG5cclxuICAgICAgICAgICAgICAgICAgdGF4b25vbXlEQi5yZXBsaWNhdGUuZnJvbShuZXcgUG91Y2hEQignaHR0cDovLycgKyBDT1VDSEJBU0VfU0VSVkVSICsgJy8nICsgVEFYT05PTVlfQlVDS0VULCBcclxuICAgICAgICAgICAgICAgICAgeyBcclxuICAgICAgICAgICAgICAgICAgICBhamF4OiB7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgdGltZW91dDogNjAwMDBcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgIH0pLCBcclxuICAgICAgICAgICAgICAgICAgeyBcclxuICAgICAgICAgICAgICAgICAgICBsaXZlOiBmYWxzZSwgXHJcbiAgICAgICAgICAgICAgICAgICAgcmV0cnk6IHRydWUsIFxyXG4gICAgICAgICAgICAgICAgICAgIHRpbWVvdXQ6IDYwMDAwIFxyXG4gICAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vU1lOQ19TRVEgPSBcIlwiK3Jlc3VsdC5jaGFuZ2UubGFzdF9zZXE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRmZC5yZXNvbHZlKFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZmQucmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgKS5mYWlsKCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihlcnIpe2RmZC5yZWplY3QoZXJyKTt9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNle1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICB0YXhvbm9teURCLnJlcGxpY2F0ZS5mcm9tKG5ldyBQb3VjaERCKCdodHRwOi8vJyArIENPVUNIQkFTRV9TRVJWRVIgKyAnLycgKyBUQVhPTk9NWV9CVUNLRVQsIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHsgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhamF4OiB7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lb3V0OiA2MDAwMFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0pLCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGl2ZTogZmFsc2UsIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0cnk6IHRydWUsIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGltZW91dDogNjAwMDAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAgIC8vU1lOQ19TRVEgPSBcIlwiK3Jlc3VsdC5jaGFuZ2UubGFzdF9zZXE7XHJcbiAgICAgICAgICAgICAgICAgIGRmZC5yZXNvbHZlKFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgICBkZmQucmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiBkZmQucHJvbWlzZSgpOyBcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBcclxuICAgICAgICAgIHN0YXJ0U3luYzogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZhciBkZmQgPSBuZXcgJC5EZWZlcnJlZCgpO1xyXG5cclxuICAgICAgICAgICAgZGFvLmdldCgnX2xvY2FsL0xPQ0FMX1NFVFRJTkdTJykudGhlbihmdW5jdGlvbihkYXRhKXsgXHJcblxyXG4gICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgIHZhciBzeW5jVXNlcm5hbWUgPSBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnN5bmNVc2VybmFtZTtcclxuICAgICAgICAgICAgICB2YXIgc3luY1Bhc3N3b3JkID0gTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy5zeW5jUGFzc3dvcmQ7XHJcbiAgICAgICAgICAgIC8vIFN0YXJ0IHJlcGxpY2F0aW9uIHdpdGggYXBwbGljYXRpb25fYXBwbGljYXRpb25VVUlELCB1c2VyIHByb2ZpbGUgY2hhbm5lbCBhbmQgYWxsIHN1YnNjcmliZWQgY2hhbm5lbFxyXG4gICAgICAgICAgICBpZiAoaGVhZC5tb2JpbGUgJiYgaXNDb3Jkb3ZhQXBwKSB7XHJcblxyXG5cclxuICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICBjb3Jkb3ZhLmV4ZWMoZnVuY3Rpb24oc2VxKXtcclxuICAgICAgICAgICAgICAgIFNZTkNfU0VRID0gc2VxO1xyXG4gICAgICAgICAgICAgICAgZGZkLnJlc29sdmUoc2VxKTtcclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKGUpe1xyXG4gICAgICAgICAgICAgICAgZGZkLnJlamVjdChlKVxyXG4gICAgICAgICAgICAgIH0sICdDQkxpdGUnLCAnc3luYycsXHJcbiAgICAgICAgICAgICAgW3tcImRibmFtZVwiOiBEQk5BTUUgKyBEQl9JREVOVElGSUVSLCBcInVybFwiOidodHRwOi8vJytzeW5jVXNlcm5hbWUrJzonK3N5bmNQYXNzd29yZCsnQCcrQ09VQ0hCQVNFX1NFUlZFUiArICcvJyArIENPVUNIQkFTRV9CVUNLRVR9XVxyXG4gICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgaWYoYXV0aGVudGljYXRlZFRvU3luY0dhdGV3YXkgPT0gZmFsc2UpIHtcclxuICAgICAgICAgICAgICAgIGRhby5hdXRoZW50aWNhdGVUb1N5bmNHYXRld2F5KHN5bmNVc2VybmFtZSwgc3luY1Bhc3N3b3JkKS5kb25lKGZ1bmN0aW9uIChkYXRhKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgIGxvY2FsREIuc3luYyhcclxuICAgICAgICAgICAgICAgICAgICBuZXcgUG91Y2hEQignaHR0cDovLycgKyBDT1VDSEJBU0VfU0VSVkVSICsgJy8nICsgQ09VQ0hCQVNFX0JVQ0tFVCwgXHJcbiAgICAgICAgICAgICAgICAgICAgeyBcclxuICAgICAgICAgICAgICAgICAgICAgIGFqYXg6IHsgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpbWVvdXQ6IDYwMDAwXHJcbiAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgfSksIFxyXG4gICAgICAgICAgICAgICAgICAgIHsgXHJcbiAgICAgICAgICAgICAgICAgICAgICBsaXZlOiB0cnVlLCBcclxuICAgICAgICAgICAgICAgICAgICAgIHJldHJ5OiB0cnVlLCBcclxuICAgICAgICAgICAgICAgICAgICAgIHRpbWVvdXQ6IDYwMDAwIFxyXG4gICAgICAgICAgICAgICAgICAgIH0pLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAoaW5mbykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICBTWU5DX1NFUSA9IFwiXCIraW5mby5jaGFuZ2UubGFzdF9zZXE7XHJcbiAgICAgICAgICAgICAgICAgICAgICBkZmQucmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIH0pLm9uKCdhY3RpdmUnLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAvLyBSZXBsaWNhdGUgcmVzdW1lZCAoZS5nLiB1c2VyIHdlbnQgYmFjayBvbmxpbmUpXHJcbiAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICB9KS5vbignY29tcGxldGUnLCBmdW5jdGlvbiAoaW5mbykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgLy8gRXhlY3V0ZWQgd2hlbiB0aGUgc3luYyBoYXMgY29tcGxldGVkLlxyXG4gICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgfSkub24oJ2Vycm9yJywgZnVuY3Rpb24oZSl7XHJcbiAgICAgICAgICAgICAgICAgICAgICBkZmQucmVqZWN0KGUpXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgIH0pLmZhaWwoZnVuY3Rpb24oZXJyKXtcclxuICAgICAgICAgICAgICAgICAgICBkZmQucmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuXHJcbiAgICAgICAgICAgICAgICAgXHJcblxyXG5cclxuICAgICAgICAgICAgICAgICAgbG9jYWxEQi5zeW5jKFxyXG4gICAgICAgICAgICAgICAgICAgIG5ldyBQb3VjaERCKCdodHRwOi8vJyArIENPVUNIQkFTRV9TRVJWRVIgKyAnLycgKyBDT1VDSEJBU0VfQlVDS0VULCBcclxuICAgICAgICAgICAgICAgICAgICB7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgYWpheDogeyBcclxuICAgICAgICAgICAgICAgICAgICAgICAgdGltZW91dDogNjAwMDBcclxuICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9KSwgXHJcbiAgICAgICAgICAgICAgICAgICAgeyBcclxuICAgICAgICAgICAgICAgICAgICAgIGxpdmU6IHRydWUsIFxyXG4gICAgICAgICAgICAgICAgICAgICAgcmV0cnk6IHRydWUsIFxyXG4gICAgICAgICAgICAgICAgICAgICAgdGltZW91dDogNjAwMDAgXHJcbiAgICAgICAgICAgICAgICAgICAgfSkub24oJ2NoYW5nZScsIGZ1bmN0aW9uIChpbmZvKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgIFNZTkNfU0VRID0gXCJcIitpbmZvLmNoYW5nZS5sYXN0X3NlcTtcclxuICAgICAgICAgICAgICAgICAgICAgIGRmZC5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgfSkub24oJ2FjdGl2ZScsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgLy8gUmVwbGljYXRlIHJlc3VtZWQgKGUuZy4gdXNlciB3ZW50IGJhY2sgb25saW5lKVxyXG4gICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIH0pLm9uKCdjb21wbGV0ZScsIGZ1bmN0aW9uIChpbmZvKSB7XHJcbiAgICAgICAgICAgICAgICAgIC8vIEV4ZWN1dGVkIHdoZW4gdGhlIHN5bmMgaGFzIGNvbXBsZXRlZC5cclxuXHJcbiAgICAgICAgICAgICAgICB9KS5vbignZXJyb3InLCBcclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGUpe2RmZC5yZWplY3QoZSlcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgIH0pLmZhaWwoZnVuY3Rpb24oZXJyKXtcclxuICAgICAgICAgICAgZGZkLnJlamVjdChlcnIpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgICByZXR1cm4gZGZkLnByb21pc2UoKTtcclxuICAgICAgICB9LFxyXG5cclxuICAgICAgICBzdGFydFN5bmNUYXhvbm9taWVzOiBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgLy9ObyBsaXZlIHN5bmMgaXMgcmVxdWlyZWQgZm9yIHRheG9ub21pZXMgc28ganVzdCBwdWxsaW5nIGRpZmZlcmVuY2VzIG9uY2Ugb25seVxyXG4gICAgICAgIHJldHVybiBkYW8ucHVsbFRheG9ub21pZXMoKTtcclxuXHJcbiAgICAgICAgXHJcbiAgICAgIH0sXHJcbiAgICAgIFxyXG4gICAgICBjaGFuZ2VzOiBmdW5jdGlvbigpXHJcbiAgICAgIHtcclxuICAgICAgICB2YXIgZGZkID0gbmV3ICQuRGVmZXJyZWQoKTsgXHJcbiAgICAgICAgaWYgKGhlYWQubW9iaWxlICYmIGlzQ29yZG92YUFwcCkge1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6IGdsb2JhbHVybCtEQk5BTUUgKyBEQl9JREVOVElGSUVSK1wiL19jaGFuZ2VzP3NpbmNlPVwiK0xPQ0FMX1NFVFRJTkdTLlNZTkNfU0VRLFxyXG4gICAgICAgICAgICB0eXBlOiBcIkdFVFwiLFxyXG4gICAgICAgICAgICBkYXRhVHlwZTogXCJqc29uXCIsXHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhLCB0ZXh0U3RhdHVzLCB4aHIpIHtcclxuICAgICAgICAgICAgICBkZmQucmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICh4aHIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duKSB7XHJcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJFcnJvciA9IFwiK0pTT04uc3RyaW5naWZ5KHhocikpO1xyXG4gICAgICAgICAgICAgIGRmZC5yZWplY3QoeGhyLnJlc3BvbnNlVGV4dCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2V7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGxvY2FsREIuY2hhbmdlcyh7XHJcbiAgICAgICAgICAgIHNpbmNlOiBwYXJzZUludChMT0NBTF9TRVRUSU5HUy5TWU5DX1NFUSlcclxuICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICBkZmQucmVzb2x2ZShyZXN1bHQpO1xyXG4gICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICBkZmQucmVqZWN0KGVycik7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gZGZkLnByb21pc2UoKTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIGNyZWF0ZURhdGFiYXNlOiBmdW5jdGlvbigpXHJcbiAgICAgIHtcclxuICAgICAgICB2YXIgZGZkID0gbmV3ICQuRGVmZXJyZWQoKTtcclxuICAgICAgICBpZiAoaGVhZC5tb2JpbGUgJiYgaXNDb3Jkb3ZhQXBwKSB7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGlmICh3aW5kb3cuY2JsaXRlKSB7XHJcbiAgICAgICAgICAgIHdpbmRvdy5jYmxpdGUuZ2V0VVJMKGZ1bmN0aW9uKGVyciwgdXJsKSB7XHJcbiAgICAgICAgICAgICAgaWYgKGVycikge1xyXG4gICAgICAgICAgICAgICBhbGVydChcImVycm9yIGxhdW5jaGluZyBDb3VjaGJhc2UgTGl0ZTogXCIgKyBlcnIpXHJcbiAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICBnbG9iYWx1cmw9dXJsO1xyXG4gICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgIC8vdGhpcyBpcyBhIGhhY2sgZm9yIGFuZHJvaWQgdmVyc2lvbiA0LjEgYnVnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICB0cnl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHhtbEh0dHAgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICB4bWxIdHRwLm9wZW4oICdHRVQnLCBnbG9iYWx1cmwsIGZhbHNlICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgeG1sSHR0cC5zZW5kKCBudWxsICk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1jYXRjaChlKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBnbG9iYWx1cmwrREJOQU1FICsgXCJtYXN0ZXJcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJQVVRcIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogIFwiXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFR5cGU6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSwgdGV4dFN0YXR1cywgeGhyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoeGhyLnN0YXR1cyA9PSAyMDEgfHwgeGhyLnN0YXR1cyA9PSA0MTIpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFvLmdldElkZW50aWZpZXIoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZG9uZShmdW5jdGlvbihpZCl7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERCX0lERU5USUZJRVIgPSBpZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYW8uY3JlYXRlRGF0YWJhc2VJbXBsKGRmZCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKGUpe1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBEQl9JREVOVElGSUVSID0gZ2VuZXJhdGVVVUlEKCkuc3Vic3RyaW5nKDAsOCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFvLnNhdmVJZGVudGlmaWVyKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZG9uZShmdW5jdGlvbihzKXtkYW8uY3JlYXRlRGF0YWJhc2VJbXBsKGRmZCk7fSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRmZC5yZWplY3QoeGhyLnJlc3BvbnNlVGV4dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKHhociwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHhoci5zdGF0dXMgPT0gMjAxIHx8IHhoci5zdGF0dXMgPT0gNDEyKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFvLmdldElkZW50aWZpZXIoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5kb25lKGZ1bmN0aW9uKGlkKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERCX0lERU5USUZJRVIgPSBpZDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFvLmNyZWF0ZURhdGFiYXNlSW1wbChkZmQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmFpbChmdW5jdGlvbihlKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERCX0lERU5USUZJRVIgPSBnZW5lcmF0ZVVVSUQoKS5zdWJzdHJpbmcoMCw4KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGFvLnNhdmVJZGVudGlmaWVyKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmRvbmUoZnVuY3Rpb24ocyl7ZGFvLmNyZWF0ZURhdGFiYXNlSW1wbChkZmQpO30pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRmZC5yZWplY3QoeGhyLnJlc3BvbnNlVGV4dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgIGFsZXJ0KFwiZXJyb3IsIENvdWNoYmFzZSBMaXRlIHBsdWdpbiBub3QgZm91bmQuXCIpXHJcbiAgICAgICAgIH1cclxuICAgICAgIH1cclxuICAgICAgIGVsc2V7XHJcbiAgICAgICAgbmV3IFBvdWNoREIoREJOQU1FK1wibWFzdGVyXCIpXHJcbiAgICAgICAgLnRoZW4oZnVuY3Rpb24gKHRtcERiKXtcclxuICAgICAgICAgbWFzdGVyREIgPSB0bXBEYjtcclxuICAgICAgICAgZGFvLmdldElkZW50aWZpZXIoKVxyXG4gICAgICAgICAuZG9uZShmdW5jdGlvbihpZCl7XHJcblxyXG4gICAgICAgICAgREJfSURFTlRJRklFUiA9IGlkO1xyXG4gICAgICAgICAgZGFvLmNyZWF0ZURhdGFiYXNlSW1wbChkZmQpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgIC5mYWlsKGZ1bmN0aW9uKGUpe1xyXG5cclxuICAgICAgICAgIERCX0lERU5USUZJRVIgPSBnZW5lcmF0ZVVVSUQoKS5zdWJzdHJpbmcoMCw4KTtcclxuICAgICAgICAgIGRhby5zYXZlSWRlbnRpZmllcigpXHJcbiAgICAgICAgICAuZG9uZShmdW5jdGlvbihzKXtkYW8uY3JlYXRlRGF0YWJhc2VJbXBsKGRmZCk7fSk7XHJcblxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICBcclxuXHJcbiAgICAgICB9KTtcclxuICAgICAgICBcclxuICAgICAgICBcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgcmV0dXJuIGRmZC5wcm9taXNlKCk7XHJcbiAgICB9LFxyXG5cclxuICAgIGNyZWF0ZURhdGFiYXNlSW1wbDogZnVuY3Rpb24oZGZkKVxyXG4gICAge1xyXG4gICAgICBcclxuICAgICAgaWYgKGhlYWQubW9iaWxlICYmIGlzQ29yZG92YUFwcCkge1xyXG4gICAgICAgIFxyXG4gICAgICAgXHJcbiAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICB1cmw6IGdsb2JhbHVybCtUQVhPTk9NWV9EQk5BTUUgKyBEQl9JREVOVElGSUVSLFxyXG4gICAgICAgICB0eXBlOiBcIlBVVFwiLFxyXG4gICAgICAgICBkYXRhOiAgXCJcIixcclxuICAgICAgICAgZGF0YVR5cGU6IFwianNvblwiLFxyXG4gICAgICAgICBjb250ZW50VHlwZTogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhLCB0ZXh0U3RhdHVzLCB4aHIpIHtcclxuICAgICAgICAgICBcclxuICAgICAgICAgICBcclxuICAgICAgICAgfSxcclxuICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICh4aHIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duKSB7XHJcbiAgICAgICAgICAgXHJcbiAgICAgICAgICAgXHJcbiAgICAgICAgICBcclxuICAgICAgICAgfVxyXG4gICAgICAgfSk7XHJcbiAgICAgICBcclxuICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgIHVybDogZ2xvYmFsdXJsK0RCTkFNRSArIERCX0lERU5USUZJRVIsXHJcbiAgICAgICAgIHR5cGU6IFwiUFVUXCIsXHJcbiAgICAgICAgIGRhdGE6ICBcIlwiLFxyXG4gICAgICAgICBkYXRhVHlwZTogXCJqc29uXCIsXHJcbiAgICAgICAgIGNvbnRlbnRUeXBlOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEsIHRleHRTdGF0dXMsIHhocikge1xyXG4gICAgICAgICAgIFxyXG4gICAgICAgICAgIGlmKHhoci5zdGF0dXMgPT0gMjAxIHx8IHhoci5zdGF0dXMgPT0gNDEyKVxyXG4gICAgICAgICAgIHtcclxuICAgICAgICAgICAgIGRmZC5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgIH1cclxuICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAge1xyXG4gICAgICAgICAgICBkZmQucmVqZWN0KHhoci5yZXNwb25zZVRleHQpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICh4aHIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duKSB7XHJcbiAgICAgICAgIFxyXG4gICAgICAgICBpZih4aHIuc3RhdHVzID09IDIwMSB8fCB4aHIuc3RhdHVzID09IDQxMilcclxuICAgICAgICAge1xyXG4gICAgICAgICAgIGRmZC5yZXNvbHZlKHhoci5yZXNwb25zZVRleHQpO1xyXG4gICAgICAgICB9XHJcbiAgICAgICAgIGVsc2VcclxuICAgICAgICAge1xyXG4gICAgICAgICAgZGZkLnJlamVjdCh4aHIucmVzcG9uc2VUZXh0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgICAgXHJcbiAgICAgfVxyXG4gICAgIGVsc2V7XHJcbiAgICAgIG5ldyBQb3VjaERCKFRBWE9OT01ZX0RCTkFNRSArIERCX0lERU5USUZJRVIpXHJcbiAgICAgIC50aGVuKGZ1bmN0aW9uICh0bXBEYil7XHJcbiAgICAgICB0YXhvbm9teURCID0gdG1wRGI7XHJcbiAgICAgICBcclxuICAgICAgIG5ldyBQb3VjaERCKERCTkFNRSArIERCX0lERU5USUZJRVIpXHJcbiAgICAgICAudGhlbihmdW5jdGlvbiAodG1wRGIpe1xyXG4gICAgICAgICBsb2NhbERCID0gdG1wRGI7XHJcbiAgICAgICAgIGRmZC5yZXNvbHZlKCdEYXRhYmFzZSBjcmVhdGVkJyk7XHJcbiAgICAgICB9KTtcclxuXHJcbiAgICAgfSk7XHJcbiAgICAgIFxyXG4gICAgICBcclxuICAgIH1cclxuICAgIFxyXG4gIH0sXHJcblxyXG4gIGRlbGV0ZURvY3VtZW50IDpmdW5jdGlvbihkb2NJZCl7XHJcbiAgICBcclxuICAgIHZhciBkZmQgPSBuZXcgJC5EZWZlcnJlZCgpO1xyXG4gICAgaWYgKGhlYWQubW9iaWxlICYmIGlzQ29yZG92YUFwcCkge1xyXG5cclxuXHJcbiAgICAgICAgICAvLyBjb3Jkb3ZhLmV4ZWMoZnVuY3Rpb24oZGF0YSl7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgLy8gICBkZmQucmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgLy8gfSwgZnVuY3Rpb24oZSl7XHJcbiAgICAgICAgICAvLyAgIGRmZC5yZWplY3QoZSlcclxuICAgICAgICAgIC8vIH0sICdDQkxpdGUnLCAnZGVsZXRlRG9jdW1lbnQnLFxyXG4gICAgICAgICAgLy8gICBbe1wiZGJuYW1lXCI6IERCTkFNRSArIERCX0lERU5USUZJRVIsIFwiZG9jSWRcIjogZG9jLl9pZCwgXCJyZXZcIjpkb2MuX3Jldn1dXHJcbiAgICAgICAgICAvLyApO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICB2YXIgc0NCPWZ1bmN0aW9uKGRvYyl7XHJcbiAgICAgICAgICAgXHJcbiAgICAgICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgICAgdXJsOiBnbG9iYWx1cmwrREJOQU1FICsgREJfSURFTlRJRklFUitcIi9cIitkb2MuX2lkK1wiP3Jldj1cIitkb2MuX3JldixcclxuICAgICAgICAgICAgICB0eXBlOiBcIkRFTEVURVwiLFxyXG4gICAgICAgICAgICAgIGRhdGE6IEpTT04uc3RyaW5naWZ5KGRvYyksXHJcbiAgICAgICAgICAgICAgZGF0YVR5cGU6IFwianNvblwiLFxyXG4gICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSwgdGV4dFN0YXR1cywgeGhyKSB7XHJcbiAgICAgICAgICAgICAgICBkZmQucmVzb2x2ZShkYXRhKTtcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoeGhyLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93bikge1xyXG4gICAgICAgICAgICAgICAgZGZkLnJlamVjdCh4aHIucmVzcG9uc2VUZXh0KTtcclxuICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBcclxuICAgICAgICAgIGRhby5nZXQoZG9jSWQpXHJcbiAgICAgICAgICAuZG9uZShzQ0IpXHJcbiAgICAgICAgICAuZmFpbChmdW5jdGlvbihlKXtkZmQucmVqZWN0KGUpfSk7XHJcbiAgICAgICAgICBcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZXtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgbG9jYWxEQi5nZXQoZG9jSWQpLnRoZW4oZnVuY3Rpb24oZG9jKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBsb2NhbERCLnJlbW92ZShkb2MpO1xyXG4gICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgIGRmZC5yZXNvbHZlKHJlc3VsdCk7XHJcbiAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgIGRmZC5yZWplY3QoZXJyKTtcclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiBkZmQucHJvbWlzZSgpO1xyXG4gICAgICB9LFxyXG4gICAgICBcclxuICAgICAgcmVzZXREYXRhYmFzZSA6ZnVuY3Rpb24oKXtcclxuICAgICAgICBcclxuXHJcbiAgICAgICAgdmFyIGRmZCA9IG5ldyAkLkRlZmVycmVkKCk7XHJcblxyXG4gICAgICAgIHZhciBfREJfSURFTlRJRklFUiA9IERCX0lERU5USUZJRVI7XHJcbiAgICAgICAgREJfSURFTlRJRklFUiA9IGdlbmVyYXRlVVVJRCgpLnN1YnN0cmluZygwLDgpO1xyXG4gICAgICAgIGRhby5zYXZlSWRlbnRpZmllcigpXHJcbiAgICAgICAgLmRvbmUoZnVuY3Rpb24ocyl7XHJcblxyXG4gICAgICAgICAgaWYgKGhlYWQubW9iaWxlICYmIGlzQ29yZG92YUFwcCkge1xyXG5cclxuICAgICAgICAgICAkLmFqYXgoe1xyXG4gICAgICAgICAgICB1cmw6IGdsb2JhbHVybCtUQVhPTk9NWV9EQk5BTUUgKyBfREJfSURFTlRJRklFUixcclxuICAgICAgICAgICAgdHlwZTogXCJERUxFVEVcIixcclxuICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEsIHRleHRTdGF0dXMsIHhocikge1xyXG5cclxuXHJcbiAgICAgICAgICAgICAgJC5hamF4KHtcclxuICAgICAgICAgICAgICAgIHVybDogZ2xvYmFsdXJsK0RCTkFNRSArIF9EQl9JREVOVElGSUVSLFxyXG4gICAgICAgICAgICAgICAgdHlwZTogXCJERUxFVEVcIixcclxuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhLCB0ZXh0U3RhdHVzLCB4aHIpIHtcclxuICAgICAgICAgICAgICAgICBkYW8uY3JlYXRlRGF0YWJhc2UoKS5kb25lKFxyXG4gICAgICAgICAgICAgICAgICBuZXcgZnVuY3Rpb24ocyl7XHJcbiAgICAgICAgICAgICAgICAgICAgZGZkLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgKS5mYWlsKGZ1bmN0aW9uKGVycil7XHJcbiAgICAgICAgICAgICAgICAgICAgZGZkLnJlc29sdmUoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoeGhyLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93bikge1xyXG4gICAgICAgICAgICAgICAgICBkZmQucmVzb2x2ZSh4aHIucmVzcG9uc2VUZXh0KTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICBcclxuXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoeGhyLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93bikge1xyXG4gICAgICAgICAgICAgIGRmZC5yZXNvbHZlKHhoci5yZXNwb25zZVRleHQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICAgICBcclxuICAgICAgICAgICBcclxuICAgICAgICAgICBcclxuICAgICAgICAgfVxyXG4gICAgICAgICBlbHNle1xyXG5cclxuICAgICAgICAgIFxyXG4gICAgICAgICAgIHRheG9ub215REIuZGVzdHJveSgpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XHJcblxyXG4gICAgICAgICAgICBsb2NhbERCLmRlc3Ryb3koKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xyXG5cclxuICAgICAgICAgICAgIGRhby5jcmVhdGVEYXRhYmFzZSgpLmRvbmUoXHJcbiAgICAgICAgICAgICAgbmV3IGZ1bmN0aW9uKHMpe1xyXG4gICAgICAgICAgICAgICAgZGZkLnJlc29sdmUocyk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICkuZmFpbChmdW5jdGlvbihlcnIpe1xyXG4gICAgICAgICAgICAgICAgZGZkLnJlamVjdChlcnIpO1xyXG4gICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICBkZmQucmVqZWN0KGVycik7XHJcbiAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgIFxyXG4gICAgICAgICAgICBkZmQucmVqZWN0KGVycik7XHJcblxyXG4gICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgfSk7ICAgICBcclxuICAgICAgICBcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gZGZkLnByb21pc2UoKTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIGNyZWF0ZURvY1ZpZXcgOiBmdW5jdGlvbihkb2NWaWV3SWQsIHZpZXdMb2dpYyl7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdmFyIGRmZCA9IG5ldyAkLkRlZmVycmVkKCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdmlld0xvZ2ljW1wiX2lkXCJdPVwiX2Rlc2lnbi9cIitkb2NWaWV3SWQ7XHJcblxyXG4gICAgICAgIGRhby51cHNlcnQodmlld0xvZ2ljKS5kb25lKGZ1bmN0aW9uKGRhdGEpeyBkZmQucmVzb2x2ZShkYXRhKX0pLmZhaWwoZnVuY3Rpb24oZSl7ZGZkLnJlamVjdChlKX0pO1xyXG5cclxuICAgICAgICByZXR1cm4gZGZkLnByb21pc2UoKTtcclxuICAgICAgfSxcclxuICAgICAgXHJcbiAgICAgIGdldElkZW50aWZpZXI6IGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgIHZhciBkZmQgPSBuZXcgJC5EZWZlcnJlZCgpO1xyXG4gICAgICAgIHRyeXtcclxuICAgICAgIC8vY29uc29sZS5sb2coXCJGZXRjaGluZyBvYmplY3QgPT0gXCIrZG9jSWQpO1xyXG4gICAgICAgXHJcbiAgICAgICBpZiAoaGVhZC5tb2JpbGUgJiYgaXNDb3Jkb3ZhQXBwKSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdmFyIG9wdGlvbnMgPSB7XHJcbiAgICAgICAgICB1cmw6IGdsb2JhbHVybCArIERCTkFNRSArIFwibWFzdGVyXCIgKyBcIi9cIiArIFwiX2xvY2FsL1NFVFRJTkdTXCIsXHJcbiAgICAgICAgICB0eXBlOiBcIkdFVFwiLFxyXG4gICAgICAgICAgZGF0YVR5cGU6IFwianNvblwiXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgXHJcbiAgICAgICAgJC5hamF4KG9wdGlvbnMpXHJcbiAgICAgICAgLmRvbmUoZnVuY3Rpb24oZGF0YSwgdGV4dFN0YXR1cywgeGhyKXtcclxuICAgICAgICAgIFxyXG4gICAgICAgICAgZGZkLnJlc29sdmUoZGF0YS5EQl9JREVOVElGSUVSKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5mYWlsKGZ1bmN0aW9uKHhociwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24pe1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICBkZmQucmVqZWN0KHhocik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgXHJcbiAgICAgICBtYXN0ZXJEQi5nZXQoXCJfbG9jYWwvU0VUVElOR1NcIilcclxuICAgICAgIC50aGVuKGZ1bmN0aW9uKGRhdGEpe1xyXG4gICAgICAgIGRmZC5yZXNvbHZlKGRhdGEuREJfSURFTlRJRklFUik7XHJcbiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycil7IFxyXG4gICAgICAgIFxyXG4gICAgICAgIGRmZC5yZWplY3QoZXJyKTtcclxuICAgICAgICByZXR1cm4gZXJyO1xyXG4gICAgICB9KTtcclxuICAgICAgXHJcbiAgICB9XHJcbiAgfWNhdGNoKGUpXHJcbiAge1xyXG4gICAgZGZkLnJlamVjdChlKTtcclxuICB9XHJcbiAgcmV0dXJuIGRmZC5wcm9taXNlKCk7XHJcblxyXG5cclxufSxcclxuc2F2ZUlkZW50aWZpZXI6IGZ1bmN0aW9uKCl7XHJcblxyXG4gIHZhciBkb2N1bWVudCA9IHtcIkRCX0lERU5USUZJRVJcIjogREJfSURFTlRJRklFUiwgXCJfaWRcIjpcIl9sb2NhbC9TRVRUSU5HU1wifTtcclxuXHJcbiAgdmFyIGRmZCA9IG5ldyAkLkRlZmVycmVkKCk7XHJcblxyXG4gIHZhciBzdiA9IGZ1bmN0aW9uKGRvYyl7XHJcblxyXG4gICAgaWYgKGhlYWQubW9iaWxlICYmIGlzQ29yZG92YUFwcCkge1xyXG4gICAgICBcclxuICAgICAgdmFyIG9wdGlvbnMgPSB7XHJcbiAgICAgICAgdXJsOiBnbG9iYWx1cmwgKyBEQk5BTUUgKyBcIm1hc3RlclwiICsgXCIvXCIgKyBcIl9sb2NhbC9TRVRUSU5HU1wiLFxyXG4gICAgICAgIHR5cGU6IFwiUFVUXCIsXHJcbiAgICAgICAgZGF0YTogIEpTT04uc3RyaW5naWZ5KGRvYyksXHJcbiAgICAgICAgZGF0YVR5cGU6IFwianNvblwiLFxyXG4gICAgICAgIGNvbnRlbnRUeXBlOiBcImFwcGxpY2F0aW9uL2pzb25cIlxyXG4gICAgICB9O1xyXG4gICAgICBcclxuICAgICAgJC5hamF4KG9wdGlvbnMpXHJcbiAgICAgIC5kb25lKGZ1bmN0aW9uKGRhdGEsIHRleHRTdGF0dXMsIHhocil7XHJcbiAgICAgICAgZGZkLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5mYWlsKGZ1bmN0aW9uKHhociwgdGV4dFN0YXR1cywgZXJyb3JUaHJvd24pe1xyXG4gICAgICAgIFxyXG4gICAgICAgIGRmZC5yZWplY3QoeGhyLnJlc3BvbnNlVGV4dCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgXHJcbiAgICAgIG1hc3RlckRCLnB1dChkb2MpXHJcbiAgICAgIC50aGVuKGZ1bmN0aW9uKGRhdGEpe1xyXG4gICAgICAgIGRmZC5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpeyBcclxuICAgICAgICBcclxuICAgICAgICBkZmQucmVqZWN0KGVycik7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICB9O1xyXG5cclxuICBcclxuICB2YXIgc0NCID0gZnVuY3Rpb24oZG9jKXtcclxuICAgIFxyXG4gICAgZG9jdW1lbnQuX3JldiA9IGRvYy5fcmV2O1xyXG4gICAgXHJcbiAgICBzdihkb2N1bWVudCk7XHJcbiAgICBcclxuICB9XHJcbiAgXHJcbiAgdmFyIGVDQiA9IGZ1bmN0aW9uKGVycil7IFxyXG4gICAgc3YoZG9jdW1lbnQpO1xyXG4gIH1cclxuXHJcblxyXG4gIFxyXG4gIFxyXG4gIGlmIChoZWFkLm1vYmlsZSAmJiBpc0NvcmRvdmFBcHApIHtcclxuICAgIFxyXG4gICAgdmFyIG9wdGlvbnMgPSB7XHJcbiAgICAgIHVybDogZ2xvYmFsdXJsICsgREJOQU1FICsgXCJtYXN0ZXJcIiArIFwiL1wiICsgXCJfbG9jYWwvU0VUVElOR1NcIixcclxuICAgICAgdHlwZTogXCJHRVRcIixcclxuICAgICAgZGF0YVR5cGU6IFwianNvblwiXHJcbiAgICB9O1xyXG5cclxuICAgIFxyXG4gICAgJC5hamF4KG9wdGlvbnMpXHJcbiAgICAuZG9uZShzQ0IpXHJcbiAgICAuZmFpbChlQ0IpO1xyXG4gICAgXHJcbiAgfSBlbHNlIHtcclxuICAgIFxyXG4gICBtYXN0ZXJEQi5nZXQoXCJfbG9jYWwvU0VUVElOR1NcIilcclxuICAgLnRoZW4oc0NCKS5jYXRjaChlQ0IpO1xyXG4gICBcclxuIH1cclxuIHJldHVybiBkZmQucHJvbWlzZSgpOyBcclxuXHJcblxyXG59LCAgICBcclxuZ2V0RG9jVmlldzogZnVuY3Rpb24oZG9jVmlld0lkcywgdmlld05hbWUsIG9wdHMpe1xyXG4gIHZhciBkZmQgPSBuZXcgJC5EZWZlcnJlZCgpO1xyXG4gIHRyeXtcclxuICAgICAgICAvLyAsbGltaXQsIHNraXAgc2tpcCBhbmQgdG90YWwgbm8gb2YgcmVjb3JkIHNob3VsZCBub3QgYmUgZXF1YWxcclxuICAgICAgICB2YXIgZGVzYyA9IGZhbHNlO1xyXG4gICAgICAgIGlmKG9wdHMgIT0gdW5kZWZpbmVkICYmIG9wdHMuZGVzY2VuZGluZyAhPSB1bmRlZmluZWQpXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgZGVzYyA9IG9wdHMuZGVzY2VuZGluZzsgXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChoZWFkLm1vYmlsZSAmJiBpc0NvcmRvdmFBcHApIHtcclxuICAgICAgICAgIHZhciBwYXJhbXMgPSAnP2luY2x1ZGVfZG9jcz10cnVlJmtleT0nICsgb3B0cy5rZXkgKyAnJmxpbWl0PScgKyBvcHRzLnBhZ2VTaXplVmFsICsgJyZzaXplPScgKyAob3B0cy5wYWdlSW5kZXhWYWwgKiBvcHRzLnBhZ2VTaXplVmFsKSArICcmZGVzY2VuZGluZz0nICsgZGVzYztcclxuICAgICAgICAgICQuYWpheCh7XHJcbiAgICAgICAgICAgIHVybDogZ2xvYmFsdXJsK0RCTkFNRSArIERCX0lERU5USUZJRVIrXCIvX2Rlc2lnbi9cIitkb2NWaWV3SWRzK1wiL192aWV3L1wiK3ZpZXdOYW1lICsgcGFyYW1zLFxyXG4gICAgICAgICAgICB0eXBlOiBcIkdFVFwiLFxyXG4gICAgICAgICAgICBkYXRhVHlwZTogXCJqc29uXCIsXHJcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhLCB0ZXh0U3RhdHVzLCB4aHIpIHtcclxuXHJcbiAgICAgICAgICAgICAgZGZkLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoeGhyLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93bikge1xyXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZXJyb3Igb2NjdXJlZCB3aGlsZSBnZXR0aW5nIGRvYyB2aWV3IFwiK0pTT04uc3RyaW5naWZ5KHhocikpO1xyXG4gICAgICAgICAgICAgIGRmZC5yZWplY3QoeGhyLnJlc3BvbnNlVGV4dCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBsb2NhbERCLnF1ZXJ5KGRvY1ZpZXdJZHMrXCIvXCIrdmlld05hbWUse1xyXG4gICAgICAgICAgICBpbmNsdWRlX2RvY3M6IHRydWUsXHJcbiAgICAgICAgICAgIGtleTogb3B0cy5rZXksXHJcbiAgICAgICAgICAgIGxpbWl0OiBvcHRzLnBhZ2VTaXplVmFsLFxyXG4gICAgICAgICAgICBza2lwOiBvcHRzLnBhZ2VJbmRleFZhbCAqIG9wdHMucGFnZVNpemVWYWwsXHJcbiAgICAgICAgICAgIGRlc2NlbmRpbmc6IGRlc2NcclxuICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlcykge1xyXG4gICAgICAgICAgICBkZmQucmVzb2x2ZShyZXMpO1xyXG4gICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICAgICAgICBkZmQucmVqZWN0KGVycik7XHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH1jYXRjaChlKVxyXG4gICAgICB7XHJcbiAgICAgICAgZGZkLnJlamVjdChlKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gZGZkLnByb21pc2UoKTsgXHJcbiAgICB9LFxyXG5cclxuICAgIHNlYXJjaDogZnVuY3Rpb24oY2F0ZWdvcmllcywgdGV4dClcclxuICAgIHtcclxuXHJcbiAgICAgIHZhciBkZmQgPSBuZXcgJC5EZWZlcnJlZCgpO1xyXG5cclxuICAgICAgdmFyIHZpZXdOYW1lPVwidmlld19zZWFyY2hEYXRhXCI7XHJcbiAgICAgIHZhciBkb2NJZD1nZW5lcmF0ZVVVSUQoKTtcclxuICAgICAgdmFyIFZJRVdfU0VBUkNIPXtcclxuICAgICAgICBcImxhbmd1YWdlXCIgOiBcImphdmFzY3JpcHRcIixcclxuICAgICAgICBcInZpZXdzXCIgOiB7XHJcbiAgICAgICAgICBcInZpZXdfc2VhcmNoRGF0YVwiIDoge1xyXG4gICAgICAgICAgICBcIm1hcFwiIDogXCJmdW5jdGlvbihkb2MpIHtcIiArXHJcbiAgICAgICAgICAgIFwidmFyIHNlYXJjaGFibGVDYXRlZ29yaWVzID0gSlNPTi5wYXJzZSgnXCIgKyBKU09OLnN0cmluZ2lmeShjYXRlZ29yaWVzKSArXCInKTtcIiArXHJcbiAgICAgICAgICAgIFwiaWYodHlwZW9mIChkb2MudGl0bGUpICE9ICd1bmRlZmluZWQnIFwiICtcclxuICAgICAgICAgICAgXCImJiB0eXBlb2YgKGRvYy5jYXRlZ29yeSkgIT0gJ3VuZGVmaW5lZCcgXCIgK1xyXG4gICAgICAgICAgICBcIiYmIHR5cGVvZiAoZG9jLmNhdGVnb3J5LnRlcm0pICE9ICd1bmRlZmluZWQnKXtcIiArXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBcImlmKHNlYXJjaGFibGVDYXRlZ29yaWVzLmluZGV4T2YoZG9jLmNhdGVnb3J5LnRlcm0pID4gLTEpe1wiICtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIFwidmFyIGRvY1RpdGxlID0gZG9jLnRpdGxlLnRvTG93ZXJDYXNlKCk7XCIgK1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgXCJpZiggKGRvYy5jYXRlZ29yeS50ZXJtID09ICdwYXJ0aWNpcGFudCcgJiYgZG9jLl9pZC50b0xvd2VyQ2FzZSgpLmluZGV4T2YoJ1wiK3RleHQudG9Mb3dlckNhc2UoKStcIicpID4gLTEpIHx8IGRvY1RpdGxlLmluZGV4T2YoJ1wiK3RleHQudG9Mb3dlckNhc2UoKStcIicpID4gLTEpIHtcIiArXHJcbiAgICAgICAgICAgIFwiICB2YXIganNvbk9iaiA9IHt9OyBqc29uT2JqLmlzUHJvZmlsZSA9IGRvYy5jYXRlZ29yeS50ZXJtID09ICdcIitQUk9GSUxFX1NFVF9JRCtcIic7IGVtaXQoZG9jLnRpdGxlLnRvVXBwZXJDYXNlKCksICBqc29uT2JqICk7IFwiICtcclxuICAgICAgICAgICAgXCJ9XCIgK1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgXCJ9XCIrXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBcIn1cIiArXHJcbiAgICAgICAgICAgIFwifVwiXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9O1xyXG4gICAgICBcclxuICAgICAgXHJcbiAgICAgIHZhciBzdWNjZXNzU2VhcmNoVmlldz1mdW5jdGlvbihkb2Mpe1xyXG4gICAgICAgIFxyXG4gICAgICAgIFxyXG4gICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpeyBcclxuICAgICAgICAgXHJcbiAgICAgICAgdmFyIG9wdGlvbnMgPSB7XHJcbiAgICAgICAgICBwYWdlU2l6ZVZhbDogNTAsXHJcbiAgICAgICAgICBwYWdlSW5kZXhWYWw6IDAsXHJcbiAgICAgICAgICBpbmNsdWRlX2RvY3M6IHRydWVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGRhby5nZXREb2NWaWV3KGRvY0lkLCB2aWV3TmFtZSwgb3B0aW9ucylcclxuICAgICAgICAuZG9uZShmdW5jdGlvbihkYXRhKXtcclxuICAgICAgICAgIGRmZC5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgIH0pLmZhaWwoZnVuY3Rpb24oZXJyKXtcclxuICAgICAgICAgIGRmZC5yZWplY3QoZXJyKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgIH0sIDEwMDApO1xyXG4gICAgICAgXHJcbiAgICAgfTtcclxuICAgICBcclxuICAgICBcclxuICAgICBkYW8uY3JlYXRlRG9jVmlldyhkb2NJZCxWSUVXX1NFQVJDSClcclxuICAgICAuZG9uZShzdWNjZXNzU2VhcmNoVmlldylcclxuICAgICAuZmFpbChmdW5jdGlvbihlcnIpe2RmZC5yZWplY3QoZXJyKTt9KTtcclxuXHJcblxyXG4gICAgIHJldHVybiBkZmQucHJvbWlzZSgpOyBcclxuICAgfSxcclxuXHJcbiAgIHByb2ZpbGVEYXRhOiBmdW5jdGlvbihjYXRlZ29yeSwgcHJvZmlsZUlkKXtcclxuXHJcblxyXG4gICAgdmFyIGRlZmZlcmVkID0gbmV3ICQuRGVmZXJyZWQoKTtcclxuXHJcbiAgICB2YXIgdmlld05hbWU9XCJ2aWV3X3NlYXJjaERhdGFcIjtcclxuICAgIHZhciBkb2NJZD1cIlNlYXJjaFwiK2NhdGVnb3J5K3Byb2ZpbGVJZDtcclxuXHJcbiAgICB2YXIgb3B0aW9ucyA9IHtcclxuICAgICAgcGFnZVNpemVWYWw6IDUwMCxcclxuICAgICAgcGFnZUluZGV4VmFsOiAwLFxyXG4gICAgICBpbmNsdWRlX2RvY3M6IHRydWVcclxuICAgIH1cclxuXHJcblxyXG4gICAgZGFvLmdldERvY1ZpZXcoZG9jSWQsIHZpZXdOYW1lLCBvcHRpb25zKVxyXG4gICAgLmRvbmUoZnVuY3Rpb24oZGF0YSl7XHJcbiAgICAgIGRlZmZlcmVkLnJlc29sdmUoZGF0YSk7XHJcbiAgICB9KS5mYWlsKGZ1bmN0aW9uKGVycil7XHJcbiAgICAgIFxyXG5cclxuICAgICAgdmFyIFZJRVdfU0VBUkNIPXtcclxuICAgICAgICBcImxhbmd1YWdlXCIgOiBcImphdmFzY3JpcHRcIixcclxuICAgICAgICBcInZpZXdzXCIgOiB7XHJcbiAgICAgICAgICBcInZpZXdfc2VhcmNoRGF0YVwiIDoge1xyXG4gICAgICAgICAgICBcIm1hcFwiIDogXCJmdW5jdGlvbihkb2MpIHtcIiArXHJcbiAgICAgICAgICAgIFwiaWYodHlwZW9mIChkb2MudGl0bGUpICE9ICd1bmRlZmluZWQnIFwiICtcclxuICAgICAgICAgICAgXCImJiB0eXBlb2YgKGRvYy5jYXRlZ29yeSkgIT0gJ3VuZGVmaW5lZCcgXCIgK1xyXG4gICAgICAgICAgICBcIiYmIHR5cGVvZiAoZG9jLmNhdGVnb3J5LnRlcm0pICE9ICd1bmRlZmluZWQnKXtcIiArXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBcImlmKCBkb2MuY2F0ZWdvcnkudGVybSA9PSAnXCIrY2F0ZWdvcnkrXCInICYmIGRvYy5jaGFubmVscy5pbmRleE9mKCdcIitwcm9maWxlSWQrXCInKSA+IC0xKSB7XCIgK1xyXG4gICAgICAgICAgICBcIiAgdmFyIGpzb25PYmogPSB7XFxcImRvY1xcXCI6IHsgIFxcXCJ1cGRhdGVkXFxcIjogZG9jLnVwZGF0ZWQsIFxcXCJfaWRcXFwiOiBkb2MuX2lkLCBcXFwidGl0bGVcXFwiOiBkb2MudGl0bGUsIFxcXCJjYXRlZ29yeVxcXCI6IHsgXFxcInRlcm1cXFwiOiBkb2MuY2F0ZWdvcnkudGVybSB9IH19OyBlbWl0KGRvYy50aXRsZS50b1VwcGVyQ2FzZSgpLCAganNvbk9iaiApOyBcIiArXHJcbiAgICAgICAgICAgIFwifVwiICtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIFwifVwiICtcclxuICAgICAgICAgICAgXCJ9XCJcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH07XHJcbiAgICAgIFxyXG4gICAgICBcclxuICAgICAgdmFyIHN1Y2Nlc3NTZWFyY2hWaWV3PWZ1bmN0aW9uKGRvYyl7XHJcbiAgICAgICAgXHJcbiAgICAgICAgXHJcbiAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7IFxyXG4gICAgICAgICBcclxuICAgICAgICB2YXIgb3B0aW9ucyA9IHtcclxuICAgICAgICAgIHBhZ2VTaXplVmFsOiA1MDAsXHJcbiAgICAgICAgICBwYWdlSW5kZXhWYWw6IDAsXHJcbiAgICAgICAgICBpbmNsdWRlX2RvY3M6IHRydWVcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGRhby5nZXREb2NWaWV3KGRvY0lkLCB2aWV3TmFtZSwgb3B0aW9ucylcclxuICAgICAgICAuZG9uZShmdW5jdGlvbihkYXRhKXtcclxuICAgICAgICAgIGRlZmZlcmVkLnJlc29sdmUoZGF0YSk7XHJcbiAgICAgICAgfSkuZmFpbChmdW5jdGlvbihlcnIpe1xyXG4gICAgICAgICAgZGVmZmVyZWQucmVqZWN0KGVycik7XHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICB9LCAyMDAwKTtcclxuICAgICAgIFxyXG4gICAgIH1cclxuICAgICBcclxuICAgICBcclxuICAgICBkYW8uY3JlYXRlRG9jVmlldyhkb2NJZCxWSUVXX1NFQVJDSClcclxuICAgICAuZG9uZShzdWNjZXNzU2VhcmNoVmlldylcclxuICAgICAuZmFpbChmdW5jdGlvbihlcnIpe2RlZmZlcmVkLnJlamVjdChlcnIpO30pO1xyXG4gICAgIFxyXG5cclxuXHJcbiAgICAgXHJcbiAgIH0pO1xyXG4gICAgXHJcbiAgICBcclxuXHJcbiAgICBcclxuICAgIFxyXG4gICAgXHJcbiAgICByZXR1cm4gZGVmZmVyZWQ7XHJcblxyXG4gICAgXHJcbiAgfVxyXG4gIFxyXG5cclxuXHJcblxyXG59O1xyXG5cclxufSkoKTtcclxuXHJcbiIsIlxyXG4vKiogXHJcbiAqIFJlcHJlc2VudHMgdGhlIGNvbmZpZyAuXHJcbiAqIFRoaXMgY29uZmlnIHdpbGwgaG9sZCBhbGwgY29uc3RhbnRzXHJcbiAqXHJcbiAqIEBjbGFzc1xyXG4gXHJcbiAqIEBhdXRob3IgSGFzYW4gQWJiYXNcclxuICogQHZlcnNpb24gMS4wLjBcclxuICpcclxuICpcclxuICovXHJcblxyXG52YXIgQ09VQ0hCQVNFX1NFUlZFUiA9ICdrd2FudHUxMC5rd2FudHUubmV0OjgwMDAnO1xyXG52YXIgQ09VQ0hCQVNFX0JVQ0tFVCA9ICdrd2FudHVfYXBwcyc7XHJcbnZhciBUQVhPTk9NWV9CVUNLRVQgPSAna3dhbnR1X3RheG9ub21pZXMnO1xyXG52YXIgU1lOQ19TRVEgPSBcIjBcIjtcclxuXHJcbnZhciBEQk5BTUU9J2t3YW50dV9hcHBzJztcclxudmFyIFRBWE9OT01ZX0RCTkFNRT0na3dhbnR1X3RheG9ub21pZXMnO1xyXG52YXIgREJfSURFTlRJRklFUiA9IFwiXCI7XHJcbnZhciBET01BSU4gPSAnaHR0cDovL2t3YW50dTlkYXRhLmt3YW50dS5uZXQ6ODA4MCc7IFxyXG52YXIgVVNFUl9BVVRIID0gRE9NQUlOICsgJy9leGlzdC9yZXN0L2RiL2t3YW50dS1yZXNvdXJjZS9hcGkvYXV0aGVudGljYXRlMS44LnhxJztcclxudmFyIEJJT01FVFJJQ19TRVJWSUNFID0gRE9NQUlOICsgJy9leGlzdC9yZXN0L2RiL2t3YW50dS1yZXNvdXJjZS9hcGkvYmlvbWV0cmljL2Jpb21ldHJpYy54cWwnOyBcclxudmFyIE9OTElORV9WQUxJREFUSU9OX1VSTCA9IERPTUFJTiArICcvZXhpc3QvcmVzdC9kYi9rd2FudHUtcmVzb3VyY2UvbW9iaWxlU2VydmljZXMvdmFsaWRhdGVSdWxlLnhxbCc7XHJcbnZhciBQUk9GSUxFX1NFVF9JRCA9ICdhcHBQcm9maWxlJztcclxuXHJcbnZhciBJTlNUQU5DRV9UWVBFX05FV19JTlMgPSAnbmV3SW5zdGFuY2UnO1xyXG52YXIgSU5TVEFOQ0VfVFlQRV9ORVdfU0VRID0gJ25ld1NlcXVlbmNlJztcclxuXHJcbnZhciBDT05GTElDVF9DT0RFID0gNDA5O1xyXG52YXIgQ09ORkxJQ1RfTkFNRSA9ICdEb2N1bWVudCBDb25mbGljdCc7XHJcbnZhciBDUkVBVEVEX0NPREUgPSAyMTA7XHJcbnZhciBDUkVBVEVEX05BTUUgPSAnRG9jdW1lbnQgQ3JlYXRlZCc7XHJcbnZhciBVUERBVEVEX0NPREUgPSAyMDA7XHJcbnZhciBVUERBVEVEX05BTUUgPSAnRG9jdW1lbnQgVXBkYXRlZCc7XHJcbnZhciBTRVJWRVJfRVJST1JfQ09ERSA9IDUwMDtcclxudmFyIFNFUlZFUl9FUlJPUl9OQU1FID0gJ1NlcnZlciBFcnJvcic7XHJcbnZhciBCQURfUkVRVUVTVF9DT0RFID0gNDAwO1xyXG52YXIgQkFEX1JFUVVFU1RfTkFNRSA9ICdCYWQgUmVxdWVzdCc7XHJcbnZhciBQUkVDT05ESVRJT05fRkFJTEVEX0NPREUgPSA0MTI7XHJcbnZhciBQUkVDT05ESVRJT05fRkFJTEVEX05BTUUgPSAnUHJlQ29uZGl0aW9ucyBGYWlsZWQuJztcclxuXHJcbnZhciBGUk9NX1JFUVVFU1QgPSAnZnJvbVJlcXVlc3QnO1xyXG52YXIgRlJPTV9ERUZJTklUSU9OID0gJ2Zyb21EZWZpbml0aW9uJztcclxudmFyIEZST01fQVVUSE9SSVNFRCA9ICdmcm9tQXV0aG9yaXNlZCc7XHJcblxyXG52YXIgTE9DQUxfU0VUVElOR1MgPSB7J19pZCc6J19sb2NhbC9MT0NBTF9TRVRUSU5HUycsICdTWU5DX1NFUSc6JzAnLCAnU0VTU0lPTic6IHt9LCAnU1VCU0NSSVBUSU9OUyc6e30sIFwiTEFOR1wiOiBcImVuXCIgfTtcclxuXHJcbi8vIHZhciB1c2VyTGFuZyA9IG5hdmlnYXRvci5sYW5ndWFnZSB8fCBuYXZpZ2F0b3IudXNlckxhbmd1YWdlOyBcclxuXHJcbi8vIGlmKHVzZXJMYW5nICE9IHVuZGVmaW5lZCAmJiB1c2VyTGFuZyAhPSAndW5kZWZpbmVkJyAmJiB1c2VyTGFuZyAhPSAnJylcclxuLy8ge1xyXG4vLyBcdExPQ0FMX1NFVFRJTkdTLkxBTkcgPSB1c2VyTGFuZy5zcGxpdChcIi1cIilbMF07XHJcbi8vIH1cclxudmFyIENPTU1VTklUWV9DT05GSUcgPSB7IH07XHJcbnZhciBQUk9DRVNTX1NUQVRVU19OT1RfU1RBUlRFRCA9IFwiTm90U3RhcnRlZFwiO1xyXG52YXIgUFJPQ0VTU19TVEFUVVNfTk9UX0NSRUFURUQgPSBcIkNyZWF0ZWRcIjtcclxudmFyIFBST0NFU1NfU1RBVFVTX0lOX1BST0dSRVNTID0gXCJJblByb2dyZXNzXCI7XHJcbnZhciBQUk9DRVNTX1NUQVRVU19JTl9BV0FJVElORyA9IFwiYXdhaXRpbmdBdXRob3Jpc2F0aW9uXCI7XHJcbnZhciBQUk9DRVNTX1NUQVRVU19DT01QTEVURSA9IFwiQ29tcGxldGVcIjtcclxudmFyIFBST0NFU1NfSU5JVElBVEVfVVNFUiA9ICd1c2VyJztcclxudmFyIEVOVFJZX1NUQVRVU19OT1RfU1RBUlRFRCA9IFwiTm90U3RhcnRlZFwiO1xyXG52YXIgRU5UUllfU1RBVFVTX0lOX1BST0dSRVNTID0gXCJJblByb2dyZXNzXCI7XHJcbnZhciBFTlRSWV9TVEFUVVNfUkVBRFlfVE9fU1VCTUlUID0gXCJSZWFkeSBUbyBTdWJtaXRcIjtcclxudmFyIEVOVFJZX1NUQVRVU19DT01QTEVURSA9IFwiQ29tcGxldGVcIjtcclxudmFyIEVOVFJZX1NUQVRVU19TVUJNSVRURUQgPSBcIlN1Ym1pdHRlZFwiO1xyXG52YXIgRU5UUllfU1RBVFVTX0lOSVRJQUxJU0VEID0gXCJJbnN0YW50aWF0ZWRcIjtcclxudmFyIEVOVFJZX1NUQVRVU19EQVRBX0lOSVRJQUxJU0VEID0gXCJEYXRhSW5pdGlhbGlzZWRcIjtcclxudmFyIEVOVFJZX1NUQVRVU19QRU5ESU5HID0gXCJQZW5kaW5nXCI7XHJcbnZhciBFTlRSWV9TVEFUVVNfUEVORElOR19SVUxFUyA9IFwiUGVuZGluZ1J1bGVzXCI7XHJcbnZhciBFTlRSWV9TVEFUVVNfVVBEQVRFRCA9IFwiVXBkYXRlZFwiO1xyXG52YXIgRU5UUllfU1RBVFVTX0FVVEhPUklTRUQgPSBcIkF1dGhvcmlzZWRcIjtcclxudmFyIEVOVFJZX1NUQVRVU19SRUpFQ1RFRCA9IFwiUmVqZWN0ZWRcIjtcclxudmFyIFBST0NFU1NJTkdfU1RBVFVTX1NFUlZFUl9SVUxFUyA9IFwiUHJvY2Vzc2luZ1NlcnZlclJ1bGVzXCJcclxudmFyIGFwcENvbmZpZyA9IHtcclxuXHRcImNvbnRlbnRcIjoge1xyXG5cdFx0XCJkYXRhXCI6IHtcclxuXHRcdFx0XCJjb21tdW5pdHlcIjoge1xyXG5cdFx0XHRcdFwiZGVzaWduX2RvY3NcIjogW1xyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdFwiZG9jSWRcIjogXCJjYXRlZ29yeVwiLFxyXG5cdFx0XHRcdFx0XCJ2aWV3XCI6IHtcclxuXHRcdFx0XHRcdFx0XCJsYW5ndWFnZVwiOiBcImphdmFzY3JpcHRcIixcclxuXHRcdFx0XHRcdFx0XCJ2aWV3c1wiOiB7XHJcblx0XHRcdFx0XHRcdFx0XCJub3RpZmljYXRpb25Db3VudFwiOiB7XHJcblx0XHRcdFx0XHRcdFx0XHRcIm1hcFwiOiBcImZ1bmN0aW9uKGRvYykgeyBpZih0eXBlb2YgKGRvYy50eXBlKSAhPSAndW5kZWZpbmVkJyl7aWYoZG9jLnR5cGU9PSdub3RpZmljYXRpb24nICYmIGRvYy5yZWFkID09IGZhbHNlKXsgZW1pdChkb2MuY3JlYXRlZERhdGVUaW1lLCAge30gKTsgfX19XCJcclxuXHRcdFx0XHRcdFx0XHR9LFxyXG5cdFx0XHRcdFx0XHRcdFwibm90aWZpY2F0aW9uXCI6IHtcclxuXHRcdFx0XHRcdFx0XHRcdFwibWFwXCI6IFwiZnVuY3Rpb24oZG9jKSB7IGlmKHR5cGVvZiAoZG9jLnR5cGUpICE9ICd1bmRlZmluZWQnKXtpZihkb2MudHlwZT09J25vdGlmaWNhdGlvbicpeyBlbWl0KCghZG9jLnJlYWQpLnRvU3RyaW5nKCkgKyBkb2MuY3JlYXRlZERhdGVUaW1lLCAgZG9jICk7IH19fVwiXHJcblx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdF1cclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdH1cclxufTtcclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuIiwiJ3VzZSBzdHJpY3QnO1xyXG5cclxuLyoqXHJcblxyXG5lbnRyeVdyYXBwZXJcclxuYXBwcm92ZWRXcmFwcGVyXHJcbnJlamVjdGVkV3JhcHBlclxyXG5cclxuQWxsIHRoZXNlIGZ1bmN0aW9ucyBhcmUgdXNpbmcgXHJcbl9FTlRSWVxyXG5fQVBQUk9WRURcclxuX1JFSkVDVEVEXHJcbiBmaWxlcyAuXHJcblxyXG4gQ2hhbmdlIGluIHRyYW5zZm9ybWVyIGlzIHJlcXVpcmVkIGZvciB0aGlzLlxyXG4qL1xyXG5cclxudmFyIGxpYnJhcnkgPSAoZnVuY3Rpb24oKXtcclxuIFxyXG4gIFxyXG4gIHJldHVybiB7XHJcblxyXG4gICAgZW50cnlXcmFwcGVyOiBmdW5jdGlvbihzZXRJZCwgcHJvZmlsZUlkLCBkb2N1bWVudElkLCB2YWxpZERhdGUpe1xyXG5cclxuICAgIFx0dmFyIGRmZCA9IG5ldyAkLkRlZmVycmVkKCk7XHJcbiAgICBcdC8vdmFyIHZlcnNpb24gPSBldmFsKCdhcHAuU0NPUEUuQVBQX0NPTkZJRy5pbmRpY2F0b3IuJytzZXRJZCsnLnZlcnNpb24nKTtcclxuICAgIFx0dmFyIHZlcnNpb24gPSAgSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW3NldElkIGVxICdcIitzZXRJZCtcIiddL3ZlcnNpb25cIixhcHAuU0NPUEUuQVBQX0NPTkZJRyx7fSk7XHJcbiAgICAgICAgdmFyIGVudHJ5SWQgPSBzZXRJZCArICdfJyt2ZXJzaW9uKydfRU5UUlknO1xyXG4gICAgICAgIGRhby5nZXQoc2V0SWQrICdfJyt2ZXJzaW9uK1wiX2NvbmZpZ1wiKVxyXG4gICAgICAgIC5kb25lKGZ1bmN0aW9uKHNldENvbmZpZyl7XHJcblxyXG5cdCAgICAgICAgZGFvLmdldChlbnRyeUlkKVxyXG5cdCAgICAgICAgLmRvbmUoZnVuY3Rpb24od3JhcHBlcil7XHJcblx0ICAgICAgICBcdFxyXG5cdCAgICAgICAgXHR3cmFwcGVyLl9pZCA9IGRvY3VtZW50SWQ7XHJcblx0ICAgICAgICBcdGRlbGV0ZSB3cmFwcGVyLl9yZXY7XHJcblx0ICAgICAgICBcdGV2YWwoJ2RlbGV0ZSB3cmFwcGVyLm1vZGVsLnBlbmRpbmcuZGF0YS4nK3NldElkKTtcclxuXHQgICAgICAgIFx0d3JhcHBlci50eXBlID0gXCJpbmRpY2F0b3JcIjtcclxuXHQgICAgICAgIFx0aWYoc2V0Q29uZmlnLm1vZGVyYXRpb24gIT0gdW5kZWZpbmVkICYmIHNldENvbmZpZy5tb2RlcmF0aW9uLnJlcXVpcmVkID09IHRydWUpXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0d3JhcHBlci5jb250cm9sLmRyYWZ0ID0gdHJ1ZTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Ly93cmFwcGVyLnRpdGxlID0gZG9jdW1lbnRJZDtcclxuXHJcblx0XHRcdFx0d3JhcHBlcltcImNoYW5uZWxzXCJdID0gW107XHJcblx0XHRcdFx0aWYoTE9DQUxfU0VUVElOR1MuQ09NTVVOSVRZX0NPTkZJRy5jb21tdW5pdHlDaGFubmVsICE9IHVuZGVmaW5lZCAmJlxyXG5cdFx0XHRcdFx0TE9DQUxfU0VUVElOR1MuQ09NTVVOSVRZX0NPTkZJRy5jb21tdW5pdHlDaGFubmVsID09IHRydWUpXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0d3JhcHBlci5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiK0xPQ0FMX1NFVFRJTkdTLkNPTU1VTklUWV9DT05GSUcuY29tbXVuaXR5SWQpO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0aWYoTE9DQUxfU0VUVElOR1MuQ09NTVVOSVRZX0NPTkZJRy5wcm9maWxlQ2hhbm5lbCAhPSB1bmRlZmluZWQgJiZcclxuXHRcdFx0XHRcdExPQ0FMX1NFVFRJTkdTLkNPTU1VTklUWV9DT05GSUcucHJvZmlsZUNoYW5uZWwgPT0gdHJ1ZSAmJiBzZXRJZCAhPSBQUk9GSUxFX1NFVF9JRClcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHR3cmFwcGVyLmNoYW5uZWxzLnB1c2goXCJwcm9maWxlX1wiK3Byb2ZpbGVJZCk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHR3cmFwcGVyWydtZXRhLWRhdGEnXS5wcm9maWxlSWQgPSBwcm9maWxlSWQ7XHJcblx0XHRcdFx0d3JhcHBlclsnbWV0YS1kYXRhJ10uc2V0SWQgPSBzZXRJZDtcclxuXHRcdFx0XHR3cmFwcGVyWydtZXRhLWRhdGEnXS5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XHJcblx0XHRcdFx0d3JhcHBlclsnbWV0YS1kYXRhJ10uY29tbXVuaXR5SWQgPSBMT0NBTF9TRVRUSU5HUy5DT01NVU5JVFlfQ09ORklHLmNvbW11bml0eUlkO1xyXG5cclxuXHRcdFx0XHR3cmFwcGVyLnVwZGF0ZWQgPSBtb21lbnQoKS5mb3JtYXQoKTtcclxuXHRcdFx0XHR3cmFwcGVyLm1vZGVsLnBlbmRpbmcudXNlciA9IHtcIm5hbWVcIjogTE9DQUxfU0VUVElOR1MuU0VTU0lPTi5maXJzdE5hbWUgKyBcIiBcIiArIExPQ0FMX1NFVFRJTkdTLlNFU1NJT04ubGFzdE5hbWUsXCJ1c2VySWRcIjogTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQsIFwidXNlcm5hbWVcIjogTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VybmFtZX07XHJcblx0XHRcdFx0d3JhcHBlci5hdXRob3IgPSB7XCJuYW1lXCI6IExPQ0FMX1NFVFRJTkdTLlNFU1NJT04uZmlyc3ROYW1lICsgXCIgXCIgKyBMT0NBTF9TRVRUSU5HUy5TRVNTSU9OLmxhc3ROYW1lLFwidXNlcklkXCI6IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkLCBcInVzZXJuYW1lXCI6IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcm5hbWV9O1xyXG5cdFx0XHRcdHdyYXBwZXIuY29udHJpYnV0b3JzLnB1c2goe1wibmFtZVwiOiBMT0NBTF9TRVRUSU5HUy5TRVNTSU9OLmZpcnN0TmFtZSArIFwiIFwiICsgTE9DQUxfU0VUVElOR1MuU0VTU0lPTi5sYXN0TmFtZSxcInVzZXJJZFwiOiBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZCwgXCJ1c2VybmFtZVwiOiBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJuYW1lfSk7XHJcblx0XHRcdFx0d3JhcHBlci5jYXRlZ29yeS50ZXJtID0gc2V0SWQ7XHJcblx0XHRcdFx0d3JhcHBlci5zb3VyY2UgPSBcInJlbW90ZVwiO1xyXG5cdFx0XHRcdHdyYXBwZXIuY3JlYXRlZCA9IG1vbWVudCgpLmZvcm1hdCgpO1xyXG5cdFx0XHRcdHdyYXBwZXIubW9kZWwucGVuZGluZy5zdGF0dXMgPSBFTlRSWV9TVEFUVVNfSU5JVElBTElTRUQ7XHJcblx0XHRcdFx0d3JhcHBlci5tb2RlbC5wZW5kaW5nLnNlcSA9IDE7XHJcblx0XHRcdFx0d3JhcHBlci5tb2RlbC5wZW5kaW5nLnZhbGlkRGF0ZSA9IHZhbGlkRGF0ZTtcclxuXHJcblx0XHRcdFx0c2VydmljZS5nZXRHUFMoKS5kb25lKGZ1bmN0aW9uKGdwc0RhdGEpe1xyXG5cclxuXHRcdFx0IFx0XHR3cmFwcGVyLmdwcyA9IGdwc0RhdGE7XHJcblx0XHRcdCBcdFx0ZGZkLnJlc29sdmUod3JhcHBlcik7XHJcblxyXG5cdFx0XHQgXHR9KS5mYWlsKGZ1bmN0aW9uKGVycil7XHJcblx0XHRcdCBcdFx0XHJcblx0XHRcdCBcdFx0d3JhcHBlci5ncHMgPSB7fTtcclxuXHRcdFx0IFx0XHRkZmQucmVzb2x2ZSh3cmFwcGVyKTtcclxuXHRcdFx0IFx0fSk7XHJcblxyXG5cclxuXHQgICAgICAgIH0pXHJcblx0ICAgICAgICAuZmFpbChmdW5jdGlvbihlKXtkZmQucmVqZWN0KGUpO30pO1xyXG5cdCAgICB9KVxyXG5cdCAgICAuZmFpbChmdW5jdGlvbihlKXtkZmQucmVqZWN0KGUpO30pO1xyXG5cdCAgIFxyXG4gICAgICBcdHJldHVybiBkZmQucHJvbWlzZSgpO1xyXG4gICAgIFxyXG5cclxuICAgIH0sXHJcbiAgICBhcHByb3ZlZFdyYXBwZXI6IGZ1bmN0aW9uKHNldElkLCBwcm9maWxlSWQsIGRvY3VtZW50SWQpe1xyXG5cclxuICAgIFx0dmFyIGRmZCA9IG5ldyAkLkRlZmVycmVkKCk7XHJcbiAgICBcdC8vdmFyIHZlcnNpb24gPSBldmFsKCdhcHAuU0NPUEUuQVBQX0NPTkZJRy5pbmRpY2F0b3IuJytzZXRJZCsnLnZlcnNpb24nKTtcclxuICAgIFx0dmFyIHZlcnNpb24gPSAgSlNPTi54cGF0aChcIi9pbmRpY2F0b3JzW3NldElkIGVxICdcIitzZXRJZCtcIiddL3ZlcnNpb25cIixhcHAuU0NPUEUuQVBQX0NPTkZJRyx7fSk7XHJcbiAgICAgICAgdmFyIGVudHJ5SWQgPSBzZXRJZCArICdfJyt2ZXJzaW9uKydfQVBQUk9WRUQnO1xyXG4gICAgICAgIGRhby5nZXQoc2V0SWQrICdfJyt2ZXJzaW9uK1wiX2NvbmZpZ1wiKVxyXG4gICAgICAgIC5kb25lKGZ1bmN0aW9uKHNldENvbmZpZyl7XHJcblxyXG5cdCAgICAgICAgZGFvLmdldChlbnRyeUlkKVxyXG5cdCAgICAgICAgLmRvbmUoZnVuY3Rpb24od3JhcHBlcil7XHJcblx0ICAgICAgICBcdFxyXG5cdCAgICAgICAgXHR3cmFwcGVyLl9pZCA9IGRvY3VtZW50SWQ7XHJcblx0ICAgICAgICBcdGRlbGV0ZSB3cmFwcGVyLl9yZXY7XHJcblx0ICAgICAgICBcdHdyYXBwZXIudHlwZSA9IFwiaW5kaWNhdG9yXCI7XHJcblx0ICAgICAgICBcdGlmKHNldENvbmZpZy5tb2RlcmF0aW9uICE9IHVuZGVmaW5lZCAmJiBzZXRDb25maWcubW9kZXJhdGlvbi5yZXF1aXJlZCA9PSB0cnVlKVxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdHdyYXBwZXIuY29udHJvbC5kcmFmdCA9IHRydWU7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHdyYXBwZXIudGl0bGUgPSBkb2N1bWVudElkKydfQVBQUk9WRUQnO1xyXG5cclxuXHRcdFx0XHR3cmFwcGVyW1wiY2hhbm5lbHNcIl0gPSBbXTtcclxuXHRcdFx0XHRpZihMT0NBTF9TRVRUSU5HUy5DT01NVU5JVFlfQ09ORklHLmNvbW11bml0eUNoYW5uZWwgIT0gdW5kZWZpbmVkICYmXHJcblx0XHRcdFx0XHRMT0NBTF9TRVRUSU5HUy5DT01NVU5JVFlfQ09ORklHLmNvbW11bml0eUNoYW5uZWwgPT0gdHJ1ZSlcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHR3cmFwcGVyLmNoYW5uZWxzLnB1c2goXCJjb21tdW5pdHlfXCIrTE9DQUxfU0VUVElOR1MuQ09NTVVOSVRZX0NPTkZJRy5jb21tdW5pdHlJZCk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRpZihMT0NBTF9TRVRUSU5HUy5DT01NVU5JVFlfQ09ORklHLnByb2ZpbGVDaGFubmVsICE9IHVuZGVmaW5lZCAmJlxyXG5cdFx0XHRcdFx0TE9DQUxfU0VUVElOR1MuQ09NTVVOSVRZX0NPTkZJRy5wcm9maWxlQ2hhbm5lbCA9PSB0cnVlICYmIHNldElkICE9IFBST0ZJTEVfU0VUX0lEKVxyXG5cdFx0XHRcdHtcclxuXHRcdFx0XHRcdHdyYXBwZXIuY2hhbm5lbHMucHVzaChcInByb2ZpbGVfXCIrcHJvZmlsZUlkKTtcclxuXHRcdFx0XHR9XHJcblxyXG5cdFx0XHRcdHdyYXBwZXJbJ21ldGEtZGF0YSddLnByb2ZpbGVJZCA9IHByb2ZpbGVJZDtcclxuXHRcdFx0XHR3cmFwcGVyWydtZXRhLWRhdGEnXS5zZXRJZCA9IHNldElkO1xyXG5cdFx0XHRcdHdyYXBwZXJbJ21ldGEtZGF0YSddLmFwcGxpY2F0aW9uSWQgPSBhcHAuU0NPUEUuYXBwbGljYXRpb25JZDtcclxuXHRcdFx0XHR3cmFwcGVyWydtZXRhLWRhdGEnXS5jb21tdW5pdHlJZCA9IExPQ0FMX1NFVFRJTkdTLkNPTU1VTklUWV9DT05GSUcuY29tbXVuaXR5SWQ7XHJcblxyXG5cdFx0XHRcdHdyYXBwZXIudXBkYXRlZCA9IG1vbWVudCgpLmZvcm1hdCgpO1xyXG5cdFx0XHRcdC8vd3JhcHBlci5tb2RlbC53b3Jrc3BhY2UudXNlciA9IHtcIm5hbWVcIjogTE9DQUxfU0VUVElOR1MuU0VTU0lPTi5maXJzdE5hbWUgKyBcIiBcIiArIExPQ0FMX1NFVFRJTkdTLlNFU1NJT04ubGFzdE5hbWUsXCJ1c2VySWRcIjogTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQsIFwidXNlcm5hbWVcIjogTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VybmFtZX07XHJcblx0XHRcdFx0d3JhcHBlci5hdXRob3IgPSB7XCJuYW1lXCI6IExPQ0FMX1NFVFRJTkdTLlNFU1NJT04uZmlyc3ROYW1lICsgXCIgXCIgKyBMT0NBTF9TRVRUSU5HUy5TRVNTSU9OLmxhc3ROYW1lLFwidXNlcklkXCI6IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkLCBcInVzZXJuYW1lXCI6IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcm5hbWV9O1xyXG5cdFx0XHRcdHdyYXBwZXIuY29udHJpYnV0b3JzLnB1c2goe1wibmFtZVwiOiBMT0NBTF9TRVRUSU5HUy5TRVNTSU9OLmZpcnN0TmFtZSArIFwiIFwiICsgTE9DQUxfU0VUVElOR1MuU0VTU0lPTi5sYXN0TmFtZSxcInVzZXJJZFwiOiBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZCwgXCJ1c2VybmFtZVwiOiBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJuYW1lfSk7XHJcblx0XHRcdFx0d3JhcHBlci5jYXRlZ29yeS50ZXJtID0gc2V0SWQ7XHJcblx0XHRcdFx0d3JhcHBlci5zb3VyY2UgPSBcInJlbW90ZVwiO1xyXG5cdFx0XHRcdHdyYXBwZXIuY3JlYXRlZCA9IG1vbWVudCgpLmZvcm1hdCgpO1xyXG5cdFx0XHRcdFxyXG5cclxuXHRcdFx0XHRcclxuXHRcdFx0XHRzZXJ2aWNlLmdldEdQUygpLmRvbmUoZnVuY3Rpb24oZ3BzRGF0YSl7XHJcblxyXG5cdFx0XHQgXHRcdHdyYXBwZXIuZ3BzID0gZ3BzRGF0YTtcclxuXHRcdFx0IFx0XHRkZmQucmVzb2x2ZSh3cmFwcGVyKTtcclxuXHJcblx0XHRcdCBcdH0pLmZhaWwoZnVuY3Rpb24oZXJyKXtcclxuXHRcdFx0IFx0XHRcclxuXHRcdFx0IFx0XHR3cmFwcGVyLmdwcyA9IHt9O1xyXG5cdFx0XHQgXHRcdGRmZC5yZWplY3QoZXJyKTtcclxuXHRcdFx0IFx0fSk7XHJcblxyXG5cclxuXHQgICAgICAgIH0pXHJcblx0ICAgICAgICAuZmFpbChmdW5jdGlvbihlKXtkZmQucmVqZWN0KGUpO30pO1xyXG5cdCAgICB9KVxyXG5cdCAgICAuZmFpbChmdW5jdGlvbihlKXtkZmQucmVqZWN0KGUpO30pO1xyXG5cdCAgIFxyXG4gICAgICBcdHJldHVybiBkZmQucHJvbWlzZSgpO1xyXG4gICAgIFxyXG5cclxuICAgIH0sXHJcblx0cmVqZWN0ZWRXcmFwcGVyOiBmdW5jdGlvbihzZXRJZCwgcHJvZmlsZUlkLCBkb2N1bWVudElkKXtcclxuXHJcbiAgICBcdHZhciBkZmQgPSBuZXcgJC5EZWZlcnJlZCgpO1xyXG4gICAgXHQvL3ZhciB2ZXJzaW9uID0gZXZhbCgnYXBwLlNDT1BFLkFQUF9DT05GSUcuaW5kaWNhdG9yLicrc2V0SWQrJy52ZXJzaW9uJyk7XHJcbiAgICBcdHZhciB2ZXJzaW9uID0gIEpTT04ueHBhdGgoXCIvaW5kaWNhdG9yc1tzZXRJZCBlcSAnXCIrc2V0SWQrXCInXS92ZXJzaW9uXCIsYXBwLlNDT1BFLkFQUF9DT05GSUcse30pO1xyXG4gICAgICAgIHZhciBlbnRyeUlkID0gc2V0SWQgKyAnXycrdmVyc2lvbisnX1JFSkVDVEVEJztcclxuICAgICAgICBkYW8uZ2V0KHNldElkKyAnXycrdmVyc2lvbitcIl9jb25maWdcIilcclxuICAgICAgICAuZG9uZShmdW5jdGlvbihzZXRDb25maWcpe1xyXG5cclxuXHQgICAgICAgIGRhby5nZXQoZW50cnlJZClcclxuXHQgICAgICAgIC5kb25lKGZ1bmN0aW9uKHdyYXBwZXIpe1xyXG5cdCAgICAgICAgXHRcclxuXHQgICAgICAgIFx0d3JhcHBlci5faWQgPSBkb2N1bWVudElkO1xyXG5cdCAgICAgICAgXHRkZWxldGUgd3JhcHBlci5fcmV2O1xyXG5cdCAgICAgICAgXHR3cmFwcGVyLnR5cGUgPSBcImluZGljYXRvclwiO1xyXG5cdCAgICAgICAgXHRpZihzZXRDb25maWcubW9kZXJhdGlvbiAhPSB1bmRlZmluZWQgJiYgc2V0Q29uZmlnLm1vZGVyYXRpb24ucmVxdWlyZWQgPT0gdHJ1ZSlcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHR3cmFwcGVyLmNvbnRyb2wuZHJhZnQgPSB0cnVlO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHR3cmFwcGVyLnRpdGxlID0gZG9jdW1lbnRJZCsnX1JFSkVDVEVEJztcclxuXHJcblx0XHRcdFx0d3JhcHBlcltcImNoYW5uZWxzXCJdID0gW107XHJcblx0XHRcdFx0aWYoTE9DQUxfU0VUVElOR1MuQ09NTVVOSVRZX0NPTkZJRy5jb21tdW5pdHlDaGFubmVsICE9IHVuZGVmaW5lZCAmJlxyXG5cdFx0XHRcdFx0TE9DQUxfU0VUVElOR1MuQ09NTVVOSVRZX0NPTkZJRy5jb21tdW5pdHlDaGFubmVsID09IHRydWUpXHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0d3JhcHBlci5jaGFubmVscy5wdXNoKFwiY29tbXVuaXR5X1wiK0xPQ0FMX1NFVFRJTkdTLkNPTU1VTklUWV9DT05GSUcuY29tbXVuaXR5SWQpO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0aWYoTE9DQUxfU0VUVElOR1MuQ09NTVVOSVRZX0NPTkZJRy5wcm9maWxlQ2hhbm5lbCAhPSB1bmRlZmluZWQgJiZcclxuXHRcdFx0XHRcdExPQ0FMX1NFVFRJTkdTLkNPTU1VTklUWV9DT05GSUcucHJvZmlsZUNoYW5uZWwgPT0gdHJ1ZSAmJiBzZXRJZCAhPSBQUk9GSUxFX1NFVF9JRClcclxuXHRcdFx0XHR7XHJcblx0XHRcdFx0XHR3cmFwcGVyLmNoYW5uZWxzLnB1c2goXCJwcm9maWxlX1wiK3Byb2ZpbGVJZCk7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHR3cmFwcGVyWydtZXRhLWRhdGEnXS5wcm9maWxlSWQgPSBwcm9maWxlSWQ7XHJcblx0XHRcdFx0d3JhcHBlclsnbWV0YS1kYXRhJ10uc2V0SWQgPSBzZXRJZDtcclxuXHRcdFx0XHR3cmFwcGVyWydtZXRhLWRhdGEnXS5hcHBsaWNhdGlvbklkID0gYXBwLlNDT1BFLmFwcGxpY2F0aW9uSWQ7XHJcblx0XHRcdFx0d3JhcHBlclsnbWV0YS1kYXRhJ10uY29tbXVuaXR5SWQgPSBMT0NBTF9TRVRUSU5HUy5DT01NVU5JVFlfQ09ORklHLmNvbW11bml0eUlkO1xyXG5cclxuXHRcdFx0XHR3cmFwcGVyLnVwZGF0ZWQgPSBtb21lbnQoKS5mb3JtYXQoKTtcclxuXHRcdFx0XHQvL3dyYXBwZXIubW9kZWwud29ya3NwYWNlLnVzZXIgPSB7XCJuYW1lXCI6IExPQ0FMX1NFVFRJTkdTLlNFU1NJT04uZmlyc3ROYW1lICsgXCIgXCIgKyBMT0NBTF9TRVRUSU5HUy5TRVNTSU9OLmxhc3ROYW1lLFwidXNlcklkXCI6IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcklkLCBcInVzZXJuYW1lXCI6IExPQ0FMX1NFVFRJTkdTLlNVQlNDUklQVElPTlMudXNlcm5hbWV9O1xyXG5cdFx0XHRcdHdyYXBwZXIuYXV0aG9yID0ge1wibmFtZVwiOiBMT0NBTF9TRVRUSU5HUy5TRVNTSU9OLmZpcnN0TmFtZSArIFwiIFwiICsgTE9DQUxfU0VUVElOR1MuU0VTU0lPTi5sYXN0TmFtZSxcInVzZXJJZFwiOiBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJJZCwgXCJ1c2VybmFtZVwiOiBMT0NBTF9TRVRUSU5HUy5TVUJTQ1JJUFRJT05TLnVzZXJuYW1lfTtcclxuXHRcdFx0XHR3cmFwcGVyLmNvbnRyaWJ1dG9ycy5wdXNoKHtcIm5hbWVcIjogTE9DQUxfU0VUVElOR1MuU0VTU0lPTi5maXJzdE5hbWUgKyBcIiBcIiArIExPQ0FMX1NFVFRJTkdTLlNFU1NJT04ubGFzdE5hbWUsXCJ1c2VySWRcIjogTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VySWQsIFwidXNlcm5hbWVcIjogTE9DQUxfU0VUVElOR1MuU1VCU0NSSVBUSU9OUy51c2VybmFtZX0pO1xyXG5cdFx0XHRcdHdyYXBwZXIuY2F0ZWdvcnkudGVybSA9IHNldElkO1xyXG5cdFx0XHRcdHdyYXBwZXIuc291cmNlID0gXCJyZW1vdGVcIjtcclxuXHRcdFx0XHR3cmFwcGVyLmNyZWF0ZWQgPSBtb21lbnQoKS5mb3JtYXQoKTtcclxuXHRcdFx0XHRcclxuXHJcblx0XHRcdFx0XHJcblxyXG5cdFx0XHRcdHNlcnZpY2UuZ2V0R1BTKCkuZG9uZShmdW5jdGlvbihncHNEYXRhKXtcclxuXHJcblx0XHRcdCBcdFx0d3JhcHBlci5ncHMgPSBncHNEYXRhO1xyXG5cdFx0XHQgXHRcdGRmZC5yZXNvbHZlKHdyYXBwZXIpO1xyXG5cclxuXHRcdFx0IFx0fSkuZmFpbChmdW5jdGlvbihlcnIpe1xyXG5cdFx0XHQgXHRcdFxyXG5cdFx0XHQgXHRcdHdyYXBwZXIuZ3BzID0ge307XHJcblx0XHRcdCBcdFx0ZGZkLnJlamVjdChlcnIpO1xyXG5cdFx0XHQgXHR9KTtcclxuXHJcblxyXG5cdCAgICAgICAgfSlcclxuXHQgICAgICAgIC5mYWlsKGZ1bmN0aW9uKGUpe2RmZC5yZWplY3QoZSk7fSk7XHJcblx0ICAgIH0pXHJcblx0ICAgIC5mYWlsKGZ1bmN0aW9uKGUpe2RmZC5yZWplY3QoZSk7fSk7XHJcblx0ICAgXHJcbiAgICAgIFx0cmV0dXJuIGRmZC5wcm9taXNlKCk7XHJcbiAgICAgXHJcblxyXG4gICAgfSxcclxuXHJcbiAgICBzYXZlRW50cmllczogZnVuY3Rpb24oc2V0SWQsIHByb2ZpbGVJZCwgZG9jdW1lbnRJZCwgdmFsaWREYXRlKXtcclxuICAgIFx0XHRcclxuICAgIFx0XHR2YXIgZGVmID0gbmV3ICQuRGVmZXJyZWQoKTtcclxuICAgICAgICAgICAgdmFyIG1haW5Nb2RlbCA9IGxpYnJhcnkuZW50cnlXcmFwcGVyKHNldElkLCBwcm9maWxlSWQsIGRvY3VtZW50SWQsIHZhbGlkRGF0ZSkuZG9uZShcclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uKG1haW5Eb2Mpe1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGRvYyBjcmVhdGVkXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGFwcHJvdmVNb2RlbCA9IGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVmID0gbmV3ICQuRGVmZXJyZWQoKTtcclxuICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFwcHJvdmVfZG9jX2lkID0gZG9jdW1lbnRJZCsnOmFwcHJvdmVkJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgbGlicmFyeS5hcHByb3ZlZFdyYXBwZXIoc2V0SWQsIHByb2ZpbGVJZCwgYXBwcm92ZV9kb2NfaWQpLmRvbmUoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihkYXRhKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvL2FwcHJvdmUgbW9kZWwgY3JlYXRlZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApLmZhaWwoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihlcnIpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWY7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHZhciByZWplY3RlZE1vZGVsID0gZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkZWYgPSBuZXcgJC5EZWZlcnJlZCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVqZWN0ZWRfZG9jX2lkID0gZG9jdW1lbnRJZCsnOnJlamVjdGVkJ1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVqZWN0ZWRNb2RlbCA9IGxpYnJhcnkucmVqZWN0ZWRXcmFwcGVyKHNldElkLCBwcm9maWxlSWQsIHJlamVjdGVkX2RvY19pZCkuZG9uZShcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGRhdGEpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vcmVqZWN0ZWQgbW9kZWwgY3JlYXRlZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZXNvbHZlKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICApLmZhaWwoXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihlcnIpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZi5yZWplY3QoZXJyKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgKTsgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWY7XHJcbiAgICAgICAgICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGdldFJlc3BvbnNlID0gZnVuY3Rpb24oc3RhdHVzLCBuYW1lLCBtZXNzYWdlLCBlcnJvciwgbW9kZWwpe1xyXG5cdFx0XHRcdFx0ICAgIHZhciByZXNwb25zZSA9IHtcclxuXHRcdFx0XHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiBzdGF0dXMsXHJcblx0XHRcdFx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IG5hbWUsXHJcblx0XHRcdFx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXHJcblx0XHRcdFx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvcixcclxuXHRcdFx0XHQgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWw6IG1vZGVsXHJcblx0XHRcdFx0XHQgICAgICAgICAgICAgICAgfVxyXG5cdFx0XHRcdFx0ICAgIHJldHVybiAgcmVzcG9uc2VcclxuXHRcdFx0XHQgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICBhcHByb3ZlTW9kZWwoKS5kb25lKFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbihyZXNwb25zZUZyb21BcHByb3ZlKXtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZWplY3RlZE1vZGVsKCkuZG9uZShmdW5jdGlvbihyZXNwb25zZUZyb21yZWplY3Qpe1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdHZhciBtYWluUmVzID0gZ2V0UmVzcG9uc2UoQ1JFQVRFRF9DT0RFLCBDUkVBVEVEX05BTUUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdNb2RlbCBjcmVhdGVkJywgZmFsc2UsIG1haW5Eb2MpO1xyXG5cclxuXHQgICAgICAgICAgICAgICAgICAgICAgICBcdHZhciBhcHByb3ZlUmVzID0gZ2V0UmVzcG9uc2UoQ1JFQVRFRF9DT0RFLCBDUkVBVEVEX05BTUUsXHJcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ0FwcHJvdmVkIGNyZWF0ZWQnLCBmYWxzZSwgcmVzcG9uc2VGcm9tQXBwcm92ZSk7XHJcblxyXG5cdFx0XHRcdFx0XHRcdFx0dmFyIHJlamVjdGVkUmVzID0gZ2V0UmVzcG9uc2UoQ1JFQVRFRF9DT0RFLCBDUkVBVEVEX05BTUUsXHJcblx0ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1JlamVjdGVkIGNyZWF0ZWQnLCBmYWxzZSwgcmVzcG9uc2VGcm9tcmVqZWN0KTtcclxuXHJcblx0ICAgICAgICAgICAgICAgICAgICAgICAgXHR2YXIgcmVzcG9uc2VBcnJheSA9IFttYWluUmVzLCBhcHByb3ZlUmVzLCByZWplY3RlZFJlc107XHJcblx0ICAgICAgICAgICAgICAgICAgICBcclxuXHQgICAgICAgICAgICAgICAgICAgXHRcdFx0ZGVmLnJlc29sdmUocmVzcG9uc2VBcnJheSk7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KS5mYWlsKGZ1bmN0aW9uKGVycm9yRnJvbVJlamVjdCl7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXHR2YXIgbWFpblJlcyA9IGdldFJlc3BvbnNlKENSRUFURURfQ09ERSwgQ1JFQVRFRF9OQU1FLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnTW9kZWwgY3JlYXRlZCcsIGZhbHNlLCBtYWluRG9jKTtcclxuXHJcblx0ICAgICAgICAgICAgICAgICAgICAgICAgXHR2YXIgYXBwcm92ZVJlcyA9IGdldFJlc3BvbnNlKENSRUFURURfQ09ERSwgQ1JFQVRFRF9OQU1FLFxyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdBcHByb3ZlZCBjcmVhdGVkJywgZmFsc2UsIHJlc3BvbnNlRnJvbUFwcHJvdmUpO1xyXG5cclxuXHRcdFx0XHRcdFx0XHRcdHZhciByZWplY3RlZFJlcyA9IGdldFJlc3BvbnNlKGVyci5zdGF0dXMsIGVyci5uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnUmVqZWN0ZWQgb2JqZWN0IG5vdCBjcmVhdGVkIHdpdGggZXJyb3IgbWVzc2FnZSAnK2Vyci5tZXNzYWdlLCB0cnVlLCBudWxsKTtcclxuXHJcblx0ICAgICAgICAgICAgICAgICAgICAgICAgXHR2YXIgcmVzcG9uc2VBcnJheSA9IFttYWluUmVzLCBhcHByb3ZlUmVzLCByZWplY3RlZFJlc107XHJcblx0ICAgICAgICAgICAgICAgICAgICBcclxuXHQgICAgICAgICAgICAgICAgICAgXHRcdFx0ZGVmLnJlamVjdChyZXNwb25zZUFycmF5KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSkuZmFpbChcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKGVycm9yRnJvbUFwcHJvdmUpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1haW5SZXMgPSBnZXRSZXNwb25zZShDUkVBVEVEX0NPREUsIENSRUFURURfTkFNRSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ01vZGVsIGNyZWF0ZWQnLCBmYWxzZSwgbWFpbkRvYyk7XHJcblxyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIFx0dmFyIGFwcHJvdmVSZXMgPSAgZ2V0UmVzcG9uc2UoZXJyLnN0YXR1cywgZXJyLm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdBcHByb3ZlZCBvYmplY3Qgbm90IGNyZWF0ZWQgJytlcnIubWVzc2FnZSwgdHJ1ZSwgbnVsbClcclxuXHJcblx0XHRcdFx0XHRcdFx0XHR2YXIgcmVqZWN0ZWRSZXMgPSBnZXRSZXNwb25zZShlcnIuc3RhdHVzLCBlcnIubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ1JlamVjdGVkIG9iamVjdCBjcmVhdGlvbiBza2lwcGVkIGR1ZSB0byBhcHByb3ZlIGNyZWF0aW9uIGZhaWx1cmUnKyBlcnIubWVzc2FnZSwgdHJ1ZSwgbnVsbCk7XHJcblxyXG5cdCAgICAgICAgICAgICAgICAgICAgICAgIFx0dmFyIHJlc3BvbnNlQXJyYXkgPSBbbWFpblJlcywgYXBwcm92ZVJlcywgcmVqZWN0ZWRSZXNdO1xyXG5cdCAgICAgICAgICAgICAgICAgICAgXHJcblx0ICAgICAgICAgICAgICAgICAgIFx0XHRcdGRlZi5yZWplY3QocmVzcG9uc2VBcnJheSk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICB9KS5mYWlsKGZ1bmN0aW9uKGVycil7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgdmFyIG1haW5SZXMgPSBnZXRSZXNwb25zZShlcnIuc3RhdHVzLCBlcnIubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAnTW9kZWwgb2JqZWN0IG5vdCBjcmVhdGVkICcrZXJyLm1lc3NhZ2UsIHRydWUsIG51bGwpO1xyXG5cclxuICAgICAgICAgICAgXHR2YXIgYXBwcm92ZVJlcyA9ICBnZXRSZXNwb25zZShlcnIuc3RhdHVzLCBlcnIubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICAnQXBwcm92ZWQgb2JqZWN0IG5vdCBjcmVhdGVkIHNraXBwZWQgZHVlIHRvIG1vZGVsIGNyZWF0aW9uIGZhaWx1cmUgJytlcnIubWVzc2FnZSwgdHJ1ZSwgbnVsbClcclxuXHJcblx0XHRcdFx0dmFyIHJlamVjdGVkUmVzID0gZ2V0UmVzcG9uc2UoZXJyLnN0YXR1cywgZXJyLm5hbWUsXHJcbiAgICAgICAgICAgICAgICAgICAgJ1JlamVjdGVkIG9iamVjdCBjcmVhdGlvbiBza2lwcGVkIGR1ZSB0byBtb2RlbCBjcmVhdGlvbiBmYWlsdXJlJysgZXJyLm1lc3NhZ2UsIHRydWUsIG51bGwpO1xyXG5cclxuICAgICAgICAgICAgXHR2YXIgcmVzcG9uc2VBcnJheSA9IFttYWluUmVzLCBhcHByb3ZlUmVzLCByZWplY3RlZFJlc107XHJcbiAgICAgICAgXHJcbiAgICAgICBcdFx0XHRkZWYucmVqZWN0KHJlc3BvbnNlQXJyYXkpO1xyXG5cclxuICAgICAgICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgICAgICAgcmV0dXJuIGRlZjtcclxuICAgICBcclxuXHJcbiAgICB9LFxyXG5cclxuICAgIGNyZWF0ZVByb2ZpbGVJbnN0YW5jZTogZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgIC8vQ3JlYXRlIGluc3RhbmNlIG9mIHN0YW5kYXJkIHByb2ZpbGUgdHlwZSBpbmRpY2F0b3JcclxuICAgICAgLy9DcmVhdGUgcm9sZXMgZmlsZSBhbmQgZ2l2ZSByb2xlcyB0byBjdXJyZW50IHVzZXJcclxuICAgICAgLy9DcmVhdGUgaW5kaWNhdG9yIHJlZ2lzdHJ5IGZpbGVcclxuXHJcbiAgICB9XHJcblxyXG5cclxuICB9O1xyXG5cclxufSkoKTtcclxuXHJcbiJdfQ==
